<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sampling of Geometries · TrixiParticles.jl</title><meta name="title" content="Sampling of Geometries · TrixiParticles.jl"/><meta property="og:title" content="Sampling of Geometries · TrixiParticles.jl"/><meta property="twitter:title" content="Sampling of Geometries · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.js"></script><link href="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li class="is-active"><a class="tocitem" href>Sampling of Geometries</a><ul class="internal"><li><a class="tocitem" href="#hierarchical_winding"><span>Hierarchical Winding</span></a></li><li class="toplevel"><a class="tocitem" href="#Particle-Packing"><span>Particle Packing</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../general/semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../../general/initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../../general/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../general/density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../../general/smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../../general/neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../../general/util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-11-3-1" type="checkbox"/><label class="tocitem" for="menuitem-11-3-1"><span class="docs-label">Fluid Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../systems/fluid/">Overview</a></li><li><a class="tocitem" href="../../systems/weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../../systems/entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li></ul></li><li><a class="tocitem" href="../../systems/dem/">Discrete Element Method (Solid)</a></li><li><a class="tocitem" href="../../systems/total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../../systems/boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li><li><a class="tocitem" href="../../reference-pointneighbors/">PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Preprocessing</a></li><li class="is-active"><a href>Sampling of Geometries</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sampling of Geometries</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/preprocessing/preprocessing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sampling-of-Geometries"><a class="docs-heading-anchor" href="#Sampling-of-Geometries">Sampling of Geometries</a><a id="Sampling-of-Geometries-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-of-Geometries" title="Permalink"></a></h1><p>Generating the initial configuration of a simulation requires filling volumes (3D) or surfaces (2D) of complex geometries with particles. The algorithm to sample a complex geometry should be robust and fast, since for large problems (large numbers of particles) or complex geometries (many geometry faces), generating the initial configuration is not trivial and can be very expensive in terms of computational cost. We therefore use a <a href="https://en.wikipedia.org/wiki/Winding_number">winding number</a> approach for an inside-outside segmentation of an object. The winding number <span>$w(\mathbf{p})$</span> is a signed integer-valued function of a point <span>$\mathbf{p}$</span> and is defined as</p><p class="math-container">\[w(\mathbf{p}) = \frac{1}{2 \pi} \sum^n_{i=1} \Theta_i.\]</p><p>Here, <span>$\Theta_i$</span> is the <em>signed</em> angle between <span>$\mathbf{c}_i - \mathbf{p}$</span> and <span>$\mathbf{c}_{i+1} - \mathbf{p}$</span> where <span>$\mathbf{c}_i$</span> and <span>$\mathbf{c}_{i+1}$</span> are two consecutive vertices on a curve. In 3D, we refer to the solid angle of an <em>oriented</em> triangle with respect to <span>$\mathbf{p}$</span>.</p><p>We provide the following methods to calculate <span>$w(\mathbf{p})$</span>:</p><ul><li><a href="../../references/#Hormann2001">Hormann et al. (2001)</a> evaluate the winding number combined with an even-odd rule, but only for 2D polygons (see <a href="#TrixiParticles.WindingNumberHormann">WindingNumberHormann</a>).</li><li>Naive winding: <a href="../../references/#Jacobson2013">Jacobson et al. (2013)</a> generalized the winding number so that the algorithm can be applied for both 2D and 3D geometries (see <a href="#TrixiParticles.WindingNumberJacobson">WindingNumberJacobson</a>).</li><li>Hierarchical winding: <a href="../../references/#Jacobson2013">Jacobson et al. (2013)</a> also introduced a fast hierarchical evaluation of the winding number. For further information see the description below.</li></ul><h2 id="hierarchical_winding"><a class="docs-heading-anchor" href="#hierarchical_winding">Hierarchical Winding</a><a id="hierarchical_winding-1"></a><a class="docs-heading-anchor-permalink" href="#hierarchical_winding" title="Permalink"></a></h2><p>According to <a href="../../references/#Jacobson2013">Jacobson et al. (2013)</a> the winding number with respect to a polygon (2D) or triangle mesh (3D) is the sum of the winding numbers with respect to each edge (2D) or face (3D). We can show this with the following example in which we determine the winding number for each edge of a triangle separately and sum them up:</p><pre><code class="language-julia hljs">using TrixiParticles
using Plots

triangle = [125.0 375.0 250.0 125.0;
            175.0 175.0 350.0 175.0]

# Delete all edges but one
edge1 = deleteat!(TrixiParticles.Polygon(triangle), [2, 3])
edge2 = deleteat!(TrixiParticles.Polygon(triangle), [1, 3])
edge3 = deleteat!(TrixiParticles.Polygon(triangle), [1, 2])

algorithm = WindingNumberJacobson()

grid = hcat(([x, y] for x in 1:500, y in 1:500)...)

_, w1 = algorithm(edge1, grid; store_winding_number=true)
_, w2 = algorithm(edge2, grid; store_winding_number=true)
_, w3 = algorithm(edge3, grid; store_winding_number=true)

w = w1 + w2 + w3

heatmap(1:500, 1:500, reshape(w1, 500, 500)&#39;, color=:coolwarm, showaxis=false,
        tickfontsize=12, size=(570, 500), margin=6 * Plots.mm)
heatmap(1:500, 1:500, reshape(w2, 500, 500)&#39;, color=:coolwarm, showaxis=false,
        tickfontsize=12, size=(570, 500), margin=6 * Plots.mm)
heatmap(1:500, 1:500, reshape(w3, 500, 500)&#39;, color=:coolwarm, showaxis=false,
        tickfontsize=12, size=(570, 500), margin=6 * Plots.mm)
heatmap(1:500, 1:500, reshape(w, 500, 500)&#39;, color=:coolwarm, showaxis=false,
        tickfontsize=12, size=(570, 500), margin=6 * Plots.mm, clims=(-1, 1))
</code></pre><figure>
  <img src="https://github.com/user-attachments/assets/bf491b2d-740e-4136-8a7b-e321f26f86fd" alt="triangle"/>
</figure><p>This summation property has some interesting consequences that we can utilize for an efficient computation of the winding number. Let <span>$\mathcal{S}$</span> be an open surface and <span>$\bar{\mathcal{S}}$</span> an arbitrary closing surface, such that</p><p class="math-container">\[\partial \bar{\mathcal{S}} = \partial \mathcal{S}\]</p><p>and <span>$\mathcal{B} = \bar{\mathcal{S}} \cup \mathcal{S}$</span> is some closed oriented surface. For any query point <span>$\mathbf{p}$</span> outside of <span>$\mathcal{B}$</span>, we know that</p><p class="math-container">\[w_{\mathcal{S}}(\mathbf{p}) + w_{\bar{\mathcal{S}}}(\mathbf{p}) = w_{\mathcal{B}}(\mathbf{p}) = 0.\]</p><p>This means</p><p class="math-container">\[w_{\mathcal{S}}(\mathbf{p}) = - w_{\bar{\mathcal{S}}}(\mathbf{p}),\]</p><p>regardless of how <span>$\bar{\mathcal{S}}$</span> is constructed (as long as <span>$\mathbf{p}$</span> is outside of <span>$\mathcal{B}$</span>).</p><p>We can use this property in the discrete case to efficiently compute the winding number of a query point by partitioning the polygon or mesh in a &quot;small&quot; part (as in consisting of a small number of edges/faces) and a &quot;large&quot; part. For the small part we just compute the winding number, and for the large part we construct a small closing and compute its winding number. The partitioning is based on a hierarchical construction of bounding boxes.</p><h3 id="Bounding-volume-hierarchy"><a class="docs-heading-anchor" href="#Bounding-volume-hierarchy">Bounding volume hierarchy</a><a id="Bounding-volume-hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Bounding-volume-hierarchy" title="Permalink"></a></h3><p>To efficiently find a &quot;small part&quot; and a &quot;large part&quot; as mentioned above, we construct a hierarchy of bounding boxes by starting with the whole domain and recursively splitting it in two equally sized boxes. The resulting hierarchy is a binary tree.</p><p>The algorithm by Jacobsen et al. (Algorithm 2, p. 5) traverses this binary tree recursively until we find the leaf in which the query point is located. The recursion stops with the following criteria:</p><ul><li>if the bounding box <span>$T$</span> is a leaf then <span>$T.\mathcal{S} = \mathcal{S} \cap T$</span>, the part of <span>$\mathcal{S}$</span> that lies inside <span>$T$</span>, is the &quot;small part&quot; mentioned above, so evaluate the winding number naively as <span>$w(\mathbf{p}, T.\mathcal{S})$</span>.</li><li>else if <span>$\mathbf{p}$</span> is outside <span>$T$</span> then <span>$T.\mathcal{S}$</span> is the &quot;large part&quot;, so evaluate the winding number naively as <span>$-w(\mathbf{p}, T.\bar{\mathcal{S}})$</span>, where <span>$T.\bar{\mathcal{S}}$</span> is the closing surface of <span>$T.\mathcal{S}$</span>.</li></ul><h4 id="Continuous-example"><a class="docs-heading-anchor" href="#Continuous-example">Continuous example</a><a id="Continuous-example-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-example" title="Permalink"></a></h4><p>Now consider the following continuous (not discretized to a polygon) 2D example. We compute the winding number of the point <span>$\mathbf{p}$</span> with respect to <span>$\mathcal{S}$</span> using the depicted hierarchy of bounding boxes.</p><figure>
  <img src="https://github.com/user-attachments/assets/0ca2f475-6dd5-43f9-8b0c-87a0612ecdf4" alt="continuous closing"/>
</figure><p>(1):</p><ul><li>Recurse left: <span>$w_{\text{left}} = \text{\texttt{hierarchical\_winding}} (\mathbf{p}, T.\text{left})$</span></li><li>Recurse right: <span>$w_{\text{right}} = \text{\texttt{hierarchical\_winding}} (\mathbf{p},T.\text{right})$</span></li></ul><p>(2):</p><ul><li>Query point <span>$\mathbf{p}$</span> is outside bounding box <span>$T$</span>, so don&#39;t recurse deeper.</li><li>Compute <span>$w_{\mathcal{S}}(\mathbf{p}) = - w_{\bar{\mathcal{S}}}(\mathbf{p})$</span> with the closure <span>$T.\bar{\mathcal{S}}$</span>, which is generally much smaller (fewer edges in the discrete version) than <span>$T.\mathcal{S}$</span>:</li></ul><p class="math-container">\[w_{\text{left}} = -\text{\texttt{naive\_winding}} (\mathbf{p}, T.\bar{\mathcal{S}})\]</p><p>(3):</p><ul><li>Bounding box <span>$T$</span> is a leaf. Use open surface <span>$T.\mathcal{S}$</span>:</li></ul><p class="math-container">\[w_{\text{right}} = \text{\texttt{naive\_winding}} (\mathbf{p}, T.\mathcal{S})\]</p><p>The reconstructed surface will then look as in the following image.</p><figure>
  <img src="https://github.com/user-attachments/assets/920bb4f1-1336-4e77-b06d-d5b46ca0d8d5" alt="reconstructed surface"/>
</figure><p>We finally sum up the winding numbers</p><p class="math-container">\[w = w_{\text{left}} + w_{\text{right} } = -w_{T_{\text{left}}.\bar{\mathcal{S}}} + w_{T_{\text{right}}.\mathcal{S}}\]</p><h4 id="Discrete-example"><a class="docs-heading-anchor" href="#Discrete-example">Discrete example</a><a id="Discrete-example-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-example" title="Permalink"></a></h4><p>We will now go through the discrete version of the example above.</p><figure>
  <img src="https://github.com/user-attachments/assets/a9b59cc3-5421-40af-b0b0-f4c18a5a7078" alt="discrete geometry"/>
</figure><p>To construct the hierarchy for the discrete piecewise-linear example in (1), we have to do the following.</p><p>(2): Each edge is distributed to the child whose box contains the edge&#39;s barycenter (red dots in (2)). Splitting stops when the number of a box&#39;s edges slips below a threshold (usually <span>$\approx 100$</span> faces in 3D, here: 6 edges).</p><p>(3): For the closure, <a href="../../references/#Jacobson2013">Jacobson et al. (2013)</a> define <em>exterior vertices</em> (<em>exterior edges</em> in 3D) as boundary vertices of such a segmentation (red dots in (3)). To find them, we traverse around each edge (face in 3D) in order, and increment or decrement for each vertex (edge) a specific counter.</p><pre><code class="language-julia hljs">v1 = edge_vertices_ids[edge][1]
v2 = edge_vertices_ids[edge][2]

vertex_count[v1] += 1
vertex_count[v2] -= 1</code></pre><p>In 2D, a vertex is declared as exterior if <code>vertex_count(vertex) != 0</code>, so there is not the same amount of edges in this box going into versus out of the vertex. To construct the closing surface, the exterior vertices are then connected to one arbitrary exterior vertex using appropriately oriented line segments:</p><pre><code class="language-julia hljs">edge = vertex_count[v] &gt; 0 ? (closing_vertex, v) : (v, closing_vertex)</code></pre><p>The resulting closed surface <span>$T.S \cup T.\bar{S}$</span> then has the same number of edges going into and out of each vertex.</p><h4 id="Incorrect-evaluation"><a class="docs-heading-anchor" href="#Incorrect-evaluation">Incorrect evaluation</a><a id="Incorrect-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Incorrect-evaluation" title="Permalink"></a></h4><p>If we follow the algorithm, we know that recursion stops if</p><ul><li>the bounding box <span>$T$</span> is a leaf or</li><li>the query point <span>$\mathbf{p}$</span> is outside the box.</li></ul><figure>
  <img src="https://github.com/user-attachments/assets/7bae164a-8d5b-4761-9d54-9abf99fca94a" alt="incorrect evaluation"/>
</figure><p>(1): The query point <span>$\mathbf{p}$</span> is outside the box, so we calculate the winding number with the (red) closure of the box.</p><p>(2): The query point <span>$\mathbf{p}$</span> is inside the box, so we use the (blue) edges distributed to the box.</p><p>(3): In this case, it leads to an incorrect evaluation of the winding number. The query point is clearly inside the box, but not inside the reconstructed surface. This is because the property <span>$w_{\mathcal{S}}(\mathbf{p}) = - w_{\bar{\mathcal{S}}}(\mathbf{p})$</span> only holds when <span>$\mathbf{p}$</span> is outside of <span>$\mathcal{B}$</span>, which is not the case here.</p><h4 id="Correct-evaluation"><a class="docs-heading-anchor" href="#Correct-evaluation">Correct evaluation</a><a id="Correct-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Correct-evaluation" title="Permalink"></a></h4><p><a href="../../references/#Jacobson2013">Jacobson et al. (2013)</a> don&#39;t mention this problem or provide a solution to it. We contacted the authors and found that they know about this problem and solve it by resizing the bounding box to fully include the closing surface of the neighboring box, since it doesn&#39;t matter if the boxes overlap.</p><figure>
  <img src="https://github.com/user-attachments/assets/097f01f4-1f37-48e4-968a-4c0970548b24" alt="correct evaluation resizing"/>
</figure><p>To avoid resizing, we take a different approach and calculate the closure of the bounding box differently:</p><ul><li>Exclude intersecting edges in the calculation of the exterior vertices.</li><li>This way, all exterior vertices are inside the bounding box, and so will be the closing surface.</li><li>The intersecting edges are later added with flipped orientation, so that the closing is actually a closing of the exterior plus intersecting edges.</li></ul><figure>
  <img src="https://github.com/user-attachments/assets/a8ff9a7e-e6d6-44d1-9a29-7debddf2803d" alt="correct evaluation intersecting" width=60%/>
</figure><p>The evaluation then looks as follows.</p><figure>
  <img src="https://github.com/user-attachments/assets/9bb2d2ad-14e8-4bd0-a9bd-3c824932affd" alt="correct evaluation intersecting 2"/>
</figure><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.WindingNumberHormann" href="#TrixiParticles.WindingNumberHormann"><code>TrixiParticles.WindingNumberHormann</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WindingNumberHormann()</code></pre><p>Algorithm for inside-outside segmentation of a complex geometry proposed by <a href="../../references/#Hormann2001">Hormann (2001)</a>. It is only supported for 2D geometries. <code>WindingNumberHormann</code> might handle edge cases a bit better, since the winding number is an integer value.</p><div class="admonition is-warning"><header class="admonition-header">Experimental Implementation</header><div class="admonition-body"><p>This is an experimental feature and may change in any future releases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e23c6ddc7f399160d3e9f0adbc1efe567e70da4f/src/preprocessing/point_in_poly/winding_number_hormann.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.WindingNumberJacobson" href="#TrixiParticles.WindingNumberJacobson"><code>TrixiParticles.WindingNumberJacobson</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WindingNumberJacobson(; geometry=nothing, winding_number_factor=sqrt(eps()),
                      hierarchical_winding=false)</code></pre><p>Algorithm for inside-outside segmentation of a complex geometry proposed by [<a href="../../references/#Jacobson2013">2</a>].</p><p><strong>Keywords</strong></p><ul><li><code>geometry</code>: Complex geometry returned by <a href="#TrixiParticles.load_geometry-Tuple{Any}"><code>load_geometry</code></a> and is only required when using             <code>hierarchical_winding=true</code>.</li><li><code>hierarchical_winding</code>: If set to <code>true</code>, an optimized hierarchical approach will be used,                         which gives a significant speedup. For further information see <a href="#hierarchical_winding">Hierarchical Winding</a>.</li><li><code>winding_number_factor</code>: For leaky geometries, a factor of <code>0.4</code> will give a better inside-outside segmentation.</li></ul><div class="admonition is-warning"><header class="admonition-header">Experimental Implementation</header><div class="admonition-body"><p>This is an experimental feature and may change in any future releases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e23c6ddc7f399160d3e9f0adbc1efe567e70da4f/src/preprocessing/point_in_poly/winding_number_jacobson.jl#L52-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.load_geometry-Tuple{Any}" href="#TrixiParticles.load_geometry-Tuple{Any}"><code>TrixiParticles.load_geometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_geometry(filename; element_type=Float64)</code></pre><p>Load file and return corresponding type for <a href="../../general/initial_condition/#TrixiParticles.ComplexShape-Tuple{Any}"><code>ComplexShape</code></a>. Supported file formats are <code>.stl</code> and <code>.asc</code>.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: Name of the file to be loaded.</li></ul><p><strong>Keywords</strong></p><ul><li><code>element_type</code>: Element type (default is <code>Float64</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e23c6ddc7f399160d3e9f0adbc1efe567e70da4f/src/preprocessing/geometries/io.jl#L1-L12">source</a></section></article><h1 id="Particle-Packing"><a class="docs-heading-anchor" href="#Particle-Packing">Particle Packing</a><a id="Particle-Packing-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Packing" title="Permalink"></a></h1><p>TODO</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SignedDistanceField" href="#TrixiParticles.SignedDistanceField"><code>TrixiParticles.SignedDistanceField</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SignedDistanceField(geometry, particle_spacing;
                    points=nothing,
                    max_signed_distance=4 * particle_spacing,
                    use_for_boundary_packing=false)</code></pre><p>Generate particles along a surface of a complex geometry storing the signed distances and normals to this surface.</p><p><strong>Arguments</strong></p><ul><li><code>geometry</code>: Geometry returned by <a href="#TrixiParticles.load_geometry-Tuple{Any}"><code>load_geometry</code></a>.</li><li><code>particle_spacing</code>: Spacing between the particles.</li></ul><p><strong>Keywords</strong></p><ul><li><code>max_signed_distance</code>:      Maximum signed distance to be stored. That is, only particles with a                             distance of <code>abs(max_signed_distance)</code> to the surface of the shape                             will be sampled.</li><li><code>points</code>:                   Points on which the signed distance is computed.                             When set to <code>nothing</code> (default), the bounding box of the shape will be                             sampled with a uniform grid of points.</li><li><code>use_for_boundary_packing</code>: Set to <code>true</code> if [<code>SignedDistanceField</code>] is used to pack                             a boundary <a href="#TrixiParticles.ParticlePackingSystem"><code>ParticlePackingSystem</code></a>.                             Use the default of <code>false</code> when packing without a boundary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e23c6ddc7f399160d3e9f0adbc1efe567e70da4f/src/preprocessing/particle_packing/signed_distance.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ParticlePackingSystem" href="#TrixiParticles.ParticlePackingSystem"><code>TrixiParticles.ParticlePackingSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParticlePackingSystem(shape::InitialCondition;
                      signed_distance_field::SignedDistanceField,
                      smoothing_kernel=SchoenbergCubicSplineKernel{ndims(shape)}(),
                      smoothing_length=1.2 * shape.particle_spacing,
                      is_boundary=false, boundary_compress_factor=1.0,
                      neighborhood_search=GridNeighborhoodSearch{ndims(shape)}(),
                      background_pressure, tlsph=true)</code></pre><p>System to generate body-fitted particles for complex shapes. For more information on the methods, see description below.</p><p><strong>Arguments</strong></p><ul><li><code>shape</code>: <a href="../../general/initial_condition/#TrixiParticles.InitialCondition"><code>InitialCondition</code></a> to be packed.</li></ul><p><strong>Keywords</strong></p><ul><li><code>background_pressure</code>:   Constant background pressure to physically pack the particles.                          A large <code>background_pressure</code> can cause high accelerations                          which requires a properly adjusted time step.</li><li><code>tlsph</code>:                 With the <a href="../../systems/total_lagrangian_sph/#TrixiParticles.TotalLagrangianSPHSystem"><code>TotalLagrangianSPHSystem</code></a>, particles need to be placed                          on the boundary of the shape and not half a particle spacing away,                          as for fluids. When <code>tlsph=true</code>, particles will be placed                          on the boundary of the shape.</li><li><code>is_boundary</code>:           When <code>shape</code> is inside the geometry that was used to create                          <code>signed_distance_field, set</code>is<em>boundary=false<code>.                          Otherwise (</code>shape<code>is the sampled boundary), set</code>is</em>boundary=true<code>.                          The thickness of the boundary is specified by creating</code>signed<em>distance</em>field<code>with:                             -</code>use<em>for</em>boundary<em>packing=true<code>-</code>max</em>signed<em>distance=boundary</em>thickness<code>See [</code>SignedDistanceField`](@ref).</li><li><code>signed_distance_field</code>: To constrain particles onto the surface, the information about                          the signed distance from a particle to a face is required.                          The precalculated signed distances will be interpolated                          to each particle during the packing procedure.</li><li><code>smoothing_kernel</code>:      Smoothing kernel to be used for this system.                          See <a href="../../general/smoothing_kernels/#smoothing_kernel">Smoothing Kernels</a>.</li><li><code>smoothing_length</code>:      Smoothing length to be used for this system.                          See <a href="../../general/smoothing_kernels/#smoothing_kernel">Smoothing Kernels</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e23c6ddc7f399160d3e9f0adbc1efe567e70da4f/src/preprocessing/particle_packing/system.jl#L1-L40">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../visualization/">« Visualization</a><a class="docs-footer-nextpage" href="../../gpu/">GPU Support »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 8 April 2025 08:18">Tuesday 8 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
