<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initial Condition and Setups · TrixiParticles.jl</title><meta name="title" content="Initial Condition and Setups · TrixiParticles.jl"/><meta property="og:title" content="Initial Condition and Setups · TrixiParticles.jl"/><meta property="twitter:title" content="Initial Condition and Setups · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.js"></script><link href="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li><a class="tocitem" href="../../preprocessing/preprocessing/">Sampling of Geometries</a></li></ul></li><li><a class="tocitem" href="../../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox" checked/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../semidiscretization/">Semidiscretization</a></li><li class="is-active"><a class="tocitem" href>Initial Condition and Setups</a><ul class="internal"><li><a class="tocitem" href="#Setups"><span>Setups</span></a></li></ul></li><li><a class="tocitem" href="../interpolation/">Interpolation</a></li><li><a class="tocitem" href="../density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-11-3-1" type="checkbox"/><label class="tocitem" for="menuitem-11-3-1"><span class="docs-label">Fluid Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../systems/fluid/">Overview</a></li><li><a class="tocitem" href="../../systems/weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../../systems/entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li></ul></li><li><a class="tocitem" href="../../systems/dem/">Discrete Element Method (Solid)</a></li><li><a class="tocitem" href="../../systems/total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../../systems/boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li><li><a class="tocitem" href="../../reference-pointneighbors/">PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li><a class="is-disabled">General</a></li><li class="is-active"><a href>Initial Condition and Setups</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initial Condition and Setups</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/general/initial_condition.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="initial_condition"><a class="docs-heading-anchor" href="#initial_condition">Initial Condition</a><a id="initial_condition-1"></a><a class="docs-heading-anchor-permalink" href="#initial_condition" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.InitialCondition" href="#TrixiParticles.InitialCondition"><code>TrixiParticles.InitialCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InitialCondition(; coordinates, density, velocity=zeros(size(coordinates, 1)),
                 mass=nothing, pressure=0.0, particle_spacing=-1.0)</code></pre><p>Struct to hold the initial configuration of the particles.</p><p>The following setups return <code>InitialCondition</code>s for commonly used setups:</p><ul><li><a href="#TrixiParticles.RectangularShape-Tuple{Any, Any, Any}"><code>RectangularShape</code></a></li><li><a href="#TrixiParticles.SphereShape-NTuple{4, Any}"><code>SphereShape</code></a></li><li><a href="#TrixiParticles.RectangularTank"><code>RectangularTank</code></a></li><li><a href="#TrixiParticles.ComplexShape-Tuple{Any}"><code>ComplexShape</code></a></li><li><a href="#TrixiParticles.extrude_geometry-Tuple{Any}"><code>extrude_geometry</code></a></li></ul><p><code>InitialCondition</code>s support the set operations <code>union</code>, <code>setdiff</code> and <code>intersect</code> in order to build more complex geometries. <code>InitialCondition</code>s also support the set operations <code>setdiff</code> and <code>intersect</code> together with <code>TrixiParticles.TriangleMesh</code> and <code>TrixiParticles.Polygon</code> returned by <a href="../../preprocessing/preprocessing/#TrixiParticles.load_geometry-Tuple{Any}"><code>load_geometry</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>coordinates</code>: An array where the <span>$i$</span>-th column holds the coordinates of particle <span>$i$</span>.</li><li><code>density</code>:     Either a vector holding the density of each particle,                or a function mapping each particle&#39;s coordinates to its density,                or a scalar for a constant density over all particles.</li></ul><p><strong>Keywords</strong></p><ul><li><code>velocity</code>:   Either an array where the <span>$i$</span>-th column holds the velocity of particle <span>$i$</span>,               or a function mapping each particle&#39;s coordinates to its velocity,               or, for a constant fluid velocity, a vector holding this velocity.               Velocity is constant zero by default.</li><li><code>mass</code>:       Either <code>nothing</code> (default) to automatically compute particle mass from particle               density and spacing, or a vector holding the mass of each particle,               or a function mapping each particle&#39;s coordinates to its mass,               or a scalar for a constant mass over all particles.</li><li><code>pressure</code>:   Either a vector holding the pressure of each particle,               or a function mapping each particle&#39;s coordinates to its pressure,               or a scalar for a constant pressure over all particles. This is optional and               only needed when using the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a>.</li><li><code>particle_spacing</code>: The spacing between the particles. This is a scalar, as the spacing                     is assumed to be uniform. This is only needed when using                     set operations on the <code>InitialCondition</code> or for automatic mass calculation.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Rectangle filled with particles
initial_condition = RectangularShape(0.1, (3, 4), (-1.0, 1.0), density=1.0)

# Two spheres in one initial condition
initial_condition = union(SphereShape(0.15, 0.5, (-1.0, 1.0), 1.0),
                          SphereShape(0.15, 0.2, (0.0, 1.0), 1.0))

# Rectangle with a spherical hole
shape1 = RectangularShape(0.1, (16, 13), (-0.8, 0.0), density=1.0)
shape2 = SphereShape(0.1, 0.35, (0.0, 0.6), 1.0, sphere_type=RoundSphere())
initial_condition = setdiff(shape1, shape2)

# Intersect of a rectangle with a sphere. Note that this keeps the particles of the
# rectangle that are in the intersect, while `intersect(shape2, shape1)` would consist of
# the particles of the sphere that are in the intersect.
shape1 = RectangularShape(0.1, (16, 13), (-0.8, 0.0), density=1.0)
shape2 = SphereShape(0.1, 0.35, (0.0, 0.6), 1.0, sphere_type=RoundSphere())
initial_condition = intersect(shape1, shape2)

# Set operations with geometries loaded from files
shape = RectangularShape(0.05, (20, 20), (0.0, 0.0), density=1.0)
file =  pkgdir(TrixiParticles, &quot;examples&quot;, &quot;preprocessing&quot;, &quot;data&quot;, &quot;circle.asc&quot;)
geometry = load_geometry(file)

initial_condition_1 = intersect(shape, geometry)
initial_condition_2 = setdiff(shape, geometry)

# Build `InitialCondition` manually
coordinates = [0.0 1.0 1.0
               0.0 0.0 1.0]
velocity = zero(coordinates)
mass = ones(3)
density = 1000 * ones(3)
initial_condition = InitialCondition(; coordinates, velocity, mass, density)

# With functions
initial_condition = InitialCondition(; coordinates, velocity=x -&gt; 2x, mass=1.0, density=1000.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/general/initial_condition.jl#L1-L91">source</a></section></article><h2 id="Setups"><a class="docs-heading-anchor" href="#Setups">Setups</a><a id="Setups-1"></a><a class="docs-heading-anchor-permalink" href="#Setups" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ComplexShape-Tuple{Any}" href="#TrixiParticles.ComplexShape-Tuple{Any}"><code>TrixiParticles.ComplexShape</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ComplexShape(geometry::Union{TriangleMesh, Polygon}; particle_spacing, density,
             pressure=0.0, mass=nothing, velocity=zeros(ndims(geometry)),
             point_in_geometry_algorithm=WindingNumberJacobson(; geometry,
                                                               hierarchical_winding=false,
                                                               winding_number_factor=sqrt(eps())),
             grid_offset::Real=0.0, max_nparticles=10^7,
             pad_initial_particle_grid=2particle_spacing)</code></pre><p>Sample a complex geometry with particles. Returns an <a href="#TrixiParticles.InitialCondition"><code>InitialCondition</code></a>. Note that an initial particle grid is generated inside the bounding box of the geometry. A <code>point_in_geometry_algorithm</code> checks if particles are inside the geometry or not. For more information about the method see <a href="../../preprocessing/preprocessing/#TrixiParticles.WindingNumberJacobson"><code>WindingNumberJacobson</code></a> or <a href="../../preprocessing/preprocessing/#TrixiParticles.WindingNumberHormann"><code>WindingNumberHormann</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>geometry</code>: Geometry returned by <a href="../../preprocessing/preprocessing/#TrixiParticles.load_geometry-Tuple{Any}"><code>load_geometry</code></a>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>particle_spacing</code>:   Spacing between the particles.</li><li><code>density</code>:            Either a function mapping each particle&#39;s coordinates to its density,                       or a scalar for a constant density over all particles.</li><li><code>velocity</code>:           Either a function mapping each particle&#39;s coordinates to its velocity,                       or, for a constant fluid velocity, a vector holding this velocity.                       Velocity is constant zero by default.</li><li><code>mass</code>:               Either <code>nothing</code> (default) to automatically compute particle mass from particle                       density and spacing, or a function mapping each particle&#39;s coordinates to its mass,                       or a scalar for a constant mass over all particles.</li><li><code>pressure</code>:           Scalar to set the pressure of all particles to this value.                       This is only used by the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a> and                       will be overwritten when using an initial pressure function in the system.</li><li><code>point_in_geometry_algorithm</code>: Algorithm for sampling the complex geometry with particles.                                It basically checks whether a particle is inside an object or not.                                For more information see <a href="../../preprocessing/preprocessing/#TrixiParticles.WindingNumberJacobson"><code>WindingNumberJacobson</code></a> or <a href="../../preprocessing/preprocessing/#TrixiParticles.WindingNumberHormann"><code>WindingNumberHormann</code></a></li><li><code>grid_offset</code>: Offset of the initial particle grid of the bounding box of the <code>geometry</code>.</li><li><code>max_nparticles</code>: Maximum number of particles in the initial particle grid.                   This is only used to avoid accidentally choosing a <code>particle_spacing</code>                   that is too small for the scale of the geometry.</li><li><code>pad_initial_particle_grid</code>: Padding of the initial particle grid.</li></ul><div class="admonition is-warning" id="Experimental-Implementation-4c84b787f3b86233"><header class="admonition-header">Experimental Implementation<a class="admonition-anchor" href="#Experimental-Implementation-4c84b787f3b86233" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature and may change in any future releases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/complex_shape.jl#L1-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.sample_boundary-Tuple{Any}" href="#TrixiParticles.sample_boundary-Tuple{Any}"><code>TrixiParticles.sample_boundary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_boundary(signed_distance_field::SignedDistanceField;
                boundary_thickness::Real, tlsph=true)</code></pre><p>Sample boundary particles of a complex geometry by using the <a href="../../preprocessing/preprocessing/#TrixiParticles.SignedDistanceField"><code>SignedDistanceField</code></a> of the geometry.</p><p><strong>Arguments</strong></p><ul><li><code>signed_distance_field</code>: The signed distance field of a geometry (see <a href="../../preprocessing/preprocessing/#TrixiParticles.SignedDistanceField"><code>SignedDistanceField</code></a>).</li></ul><p><strong>Keywords</strong></p><ul><li><code>boundary_thickness</code>: Thickness of the boundary</li><li><code>tlsph</code>             : When <code>tlsph=true</code>, boundary particles will be placed                       one particle spacing from the surface of the geometry.                       Otherwise when <code>tlsph=true</code> (simulating fluid particles),                       boundary particles will be placed half particle spacing away from the surface.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">geometry = load_geometry(file)

signed_distance_field = SignedDistanceField(geometry, particle_spacing;
                                            use_for_boundary_packing=true,
                                            max_signed_distance=boundary_thickness)

boundary_sampled = sample_boundary(signed_distance_field; boundary_density=1.0,
                                   boundary_thickness)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/complex_shape.jl#L80-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.extrude_geometry-Tuple{Any}" href="#TrixiParticles.extrude_geometry-Tuple{Any}"><code>TrixiParticles.extrude_geometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extrude_geometry(geometry; particle_spacing, direction, n_extrude::Integer,
                 velocity=zeros(length(direction)),
                 mass=nothing, density=nothing, pressure=0.0)</code></pre><p>Extrude either a line, a plane or a shape along a specific direction. Returns an <a href="#TrixiParticles.InitialCondition"><code>InitialCondition</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>geometry</code>:           Either particle coordinates or an <a href="#TrixiParticles.InitialCondition"><code>InitialCondition</code></a>                       defining a 2D shape to extrude to a 3D volume, or two 2D points                       <span>$(A, B)$</span> defining the interval <span>$[A, B]$</span> to extrude to a plane                       in 2D, or three 3D points <span>$(A, B, C)$</span> defining the parallelogram                       spanned by the vectors <span>$\widehat{AB}$</span> and <span>$\widehat {AC}$</span> to extrude                       to a parallelepiped.</li></ul><p><strong>Keywords</strong></p><ul><li><code>particle_spacing</code>:   Spacing between the particles. Can be omitted when <code>geometry</code> is an                       <code>InitialCondition</code> (unless <code>geometry.particle_spacing == -1</code>).</li><li><code>direction</code>:          A vector that specifies the direction in which to extrude.</li><li><code>n_extrude</code>:          Number of layers of particles created in the direction of extrusion.</li><li><code>velocity</code>:           Either a function mapping each particle&#39;s coordinates to its velocity,                       or, for a constant fluid velocity, a vector holding this velocity.                       Velocity is constant zero by default.</li><li><code>mass</code>:               Either <code>nothing</code> (default) to automatically compute particle mass from particle                       density and spacing, or a function mapping each particle&#39;s coordinates to its mass,                       or a scalar for a constant mass over all particles.</li><li><code>density</code>:            Either a function mapping each particle&#39;s coordinates to its density,                       or a scalar for a constant density over all particles.</li><li><code>pressure</code>:           Scalar to set the pressure of all particles to this value.                       This is only used by the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a> and                       will be overwritten when using an initial pressure function in the system.</li><li><code>tlsph</code>:              With the <a href="../../systems/total_lagrangian_sph/#TrixiParticles.TotalLagrangianSPHSystem"><code>TotalLagrangianSPHSystem</code></a>, particles need to be placed                       on the boundary of the shape and not one particle radius away, as for fluids.                       When <code>tlsph=true</code>, particles will be placed on the boundary of the shape.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Extrude a line in 2D to a plane in 2D
p1 = [0.0, 0.0]
p2 = [1.0, 1.0]

direction = [-1.0, 1.0]

shape = extrude_geometry((p1, p2); direction, particle_spacing=0.1, n_extrude=4, density=1000.0)

# Extrude a parallelogram in 3D to a parallelepiped in 3D
p1 = [0.0, 0.0, 0.0]
p2 = [0.5, 1.0, 0.0]
p3 = [1.0, 0.2, 0.0]

direction = [0.0, 0.0, 1.0]

shape = extrude_geometry((p1, p2, p3); direction, particle_spacing=0.1, n_extrude=4, density=1000.0)

# Extrude a 2D shape (here: a disc) to a 3D shape (here: a cylinder)
shape = SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0, n_layers=3,
                    sphere_type=RoundSphere(end_angle=pi))

direction = [0.0, 0.0, 1.0]

shape = extrude_geometry(shape; direction, particle_spacing=0.1, n_extrude=4, density=1000.0)</code></pre><div class="admonition is-warning" id="Experimental-Implementation-4c84b787f3b86233"><header class="admonition-header">Experimental Implementation<a class="admonition-anchor" href="#Experimental-Implementation-4c84b787f3b86233" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature and may change in any future releases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/extrude_geometry.jl#L1-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.RectangularShape-Tuple{Any, Any, Any}" href="#TrixiParticles.RectangularShape-Tuple{Any, Any, Any}"><code>TrixiParticles.RectangularShape</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RectangularShape(particle_spacing, n_particles_per_dimension, min_coordinates;
                 velocity=zeros(length(n_particles_per_dimension)),
                 mass=nothing, density=nothing, pressure=0.0,
                 acceleration=nothing, state_equation=nothing,
                 tlsph=false, loop_order=nothing)</code></pre><p>Rectangular shape filled with particles. Returns an <a href="#TrixiParticles.InitialCondition"><code>InitialCondition</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>particle_spacing</code>:           Spacing between the particles.</li><li><code>n_particles_per_dimension</code>:  Tuple containing the number of particles in x, y and z                               (only 3D) direction, respectively.</li><li><code>min_coordinates</code>:            Coordinates of the corner in negative coordinate directions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>velocity</code>:       Either a function mapping each particle&#39;s coordinates to its velocity,                   or, for a constant fluid velocity, a vector holding this velocity.                   Velocity is constant zero by default.</li><li><code>mass</code>:           Either <code>nothing</code> (default) to automatically compute particle mass from particle                   density and spacing, or a function mapping each particle&#39;s coordinates to its mass,                   or a scalar for a constant mass over all particles.</li><li><code>density</code>:        Either a function mapping each particle&#39;s coordinates to its density,                   or a scalar for a constant density over all particles.                   Obligatory when not using a state equation. Cannot be used together with                   <code>state_equation</code>.</li><li><code>pressure</code>:       Scalar to set the pressure of all particles to this value.                   This is only used by the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a> and                   will be overwritten when using an initial pressure function in the system.                   Cannot be used together with hydrostatic pressure gradient.</li><li><code>acceleration</code>:   In order to initialize particles with a hydrostatic pressure gradient,                   an acceleration vector can be passed. Note that only accelerations                   in one coordinate direction and no diagonal accelerations are supported.                   This will only change the pressure of the particles. When using the                   <a href="../../systems/weakly_compressible_sph/#TrixiParticles.WeaklyCompressibleSPHSystem"><code>WeaklyCompressibleSPHSystem</code></a>, pass a <code>state_equation</code> as well                   to initialize the particles with the corresponding density and mass.                   When using the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a>, the pressure                   will be overwritten when using an initial pressure function in the system.                   This cannot be used together with the <code>pressure</code> keyword argument.</li><li><code>state_equation</code>: When calculating a hydrostatic pressure gradient by setting <code>acceleration</code>,                   the <code>state_equation</code> will be used to set the corresponding density.                   Cannot be used together with <code>density</code>.</li><li><code>tlsph</code>:          With the <a href="../../systems/total_lagrangian_sph/#TrixiParticles.TotalLagrangianSPHSystem"><code>TotalLagrangianSPHSystem</code></a>, particles need to be placed                   on the boundary of the shape and not one particle radius away, as for fluids.                   When <code>tlsph=true</code>, particles will be placed on the boundary of the shape.</li><li><code>coordinates_perturbation</code>: Add a small random displacement to the particle positions,                             where the amplitude is <code>coordinates_perturbation * particle_spacing</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># 2D
rectangular = RectangularShape(particle_spacing, (5, 4), (1.0, 2.0), density=1000.0)

# 2D with hydrostatic pressure gradient.
# `state_equation` has to be the same as for the WCSPH system.
state_equation = StateEquationCole(sound_speed=20.0, exponent=7, reference_density=1000.0)
rectangular = RectangularShape(particle_spacing, (5, 4), (1.0, 2.0),
                               acceleration=(0.0, -9.81), state_equation=state_equation)

# 3D
rectangular = RectangularShape(particle_spacing, (5, 4, 7), (1.0, 2.0, 3.0), density=1000.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/rectangular_shape.jl#L1-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.RectangularTank" href="#TrixiParticles.RectangularTank"><code>TrixiParticles.RectangularTank</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RectangularTank(particle_spacing, fluid_size, tank_size, fluid_density;
                velocity=zeros(length(fluid_size)), fluid_mass=nothing,
                pressure=0.0,
                acceleration=nothing, state_equation=nothing,
                boundary_density=fluid_density,
                n_layers=1, spacing_ratio=1.0,
                min_coordinates=zeros(length(fluid_size)),
                faces=Tuple(trues(2 * length(fluid_size))))</code></pre><p>Rectangular tank filled with a fluid to set up dam-break-style simulations.</p><p><strong>Arguments</strong></p><ul><li><code>particle_spacing</code>:   Spacing between the fluid particles.</li><li><code>fluid_size</code>:         The dimensions of the fluid as <code>(x, y)</code> (or <code>(x, y, z)</code> in 3D).</li><li><code>tank_size</code>:          The dimensions of the tank as <code>(x, y)</code> (or <code>(x, y, z)</code> in 3D).</li><li><code>fluid_density</code>:      The rest density of the fluid. Will only be used as default for                       <code>boundary_density</code> when using a state equation.</li></ul><p><strong>Keywords</strong></p><ul><li><code>velocity</code>:       Either a function mapping each particle&#39;s coordinates to its velocity,                   or, for a constant fluid velocity, a vector holding this velocity.                   Velocity is constant zero by default.</li><li><code>fluid_mass</code>:     Either <code>nothing</code> (default) to automatically compute particle mass from particle                   density and spacing, or a function mapping each particle&#39;s coordinates to its mass,                   or a scalar for a constant mass over all particles.</li><li><code>pressure</code>:       Scalar to set the pressure of all particles to this value.                   This is only used by the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a> and                   will be overwritten when using an initial pressure function in the system.                   Cannot be used together with hydrostatic pressure gradient.</li><li><code>acceleration</code>:   In order to initialize particles with a hydrostatic pressure gradient,                   an acceleration vector can be passed. Note that only accelerations                   in one coordinate direction and no diagonal accelerations are supported.                   This will only change the pressure of the particles. When using the                   <a href="../../systems/weakly_compressible_sph/#TrixiParticles.WeaklyCompressibleSPHSystem"><code>WeaklyCompressibleSPHSystem</code></a>, pass a <code>state_equation</code> as well                   to initialize the particles with the corresponding density and mass.                   When using the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a>, the pressure                   will be overwritten when using an initial pressure function in the system.                   This cannot be used together with the <code>pressure</code> keyword argument.</li><li><code>state_equation</code>: When calculating a hydrostatic pressure gradient by setting <code>acceleration</code>,                   the <code>state_equation</code> will be used to set the corresponding density.                   Cannot be used together with <code>density</code>.</li><li><code>boundary_density</code>:   Density of each boundary particle (by default set to the fluid density)</li><li><code>n_layers</code>:           Number of boundary layers.</li><li><code>spacing_ratio</code>:      Ratio of <code>particle_spacing</code> to boundary particle spacing.                       A value of 2 means that the boundary particle spacing will be                       half the fluid particle spacing.</li><li><code>min_coordinates</code>:    Coordinates of the corner in negative coordinate directions.</li><li><code>faces</code>:              By default all faces are generated. Set faces by passing a                       bit-array of length 4 (2D) or 6 (3D) to generate the faces in the                       normal direction: -x,+x,-y,+y,-z,+z.</li></ul><p><strong>Fields</strong></p><ul><li><code>fluid::InitialCondition</code>:    <a href="#TrixiParticles.InitialCondition"><code>InitialCondition</code></a> for the fluid.</li><li><code>boundary::InitialCondition</code>: <a href="#TrixiParticles.InitialCondition"><code>InitialCondition</code></a> for the boundary.</li><li><code>fluid_size::Tuple</code>:          Tuple containing the size of the fluid in each dimension after rounding.</li><li><code>tank_size::Tuple</code>:           Tuple containing the size of the tank in each dimension after rounding.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># 2D
setup = RectangularTank(particle_spacing, (water_width, water_height),
                        (container_width, container_height), fluid_density,
                        n_layers=2, spacing_ratio=3)

# 2D with hydrostatic pressure gradient.
# `state_equation` has to be the same as for the WCSPH system.
state_equation = StateEquationCole(sound_speed=10.0, exponent=1, reference_density=1000.0)
setup = RectangularTank(particle_spacing, (water_width, water_height),
                        (container_width, container_height), fluid_density,
                        acceleration=(0.0, -9.81), state_equation=state_equation)

# 3D
setup = RectangularTank(particle_spacing, (water_width, water_height, water_depth),
                        (container_width, container_height, container_depth), fluid_density,
                        n_layers=2)</code></pre><p>See also: <a href="#TrixiParticles.reset_wall!-Tuple{Any, Any, Any}"><code>reset_wall!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/rectangular_tank.jl#L1-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.reset_wall!-Tuple{Any, Any, Any}" href="#TrixiParticles.reset_wall!-Tuple{Any, Any, Any}"><code>TrixiParticles.reset_wall!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset_wall!(rectangular_tank::RectangularTank, reset_faces, positions)</code></pre><p>The selected walls of the tank will be placed at the new positions.</p><p><strong>Arguments</strong></p><ul><li><code>reset_faces</code>: Boolean tuple of 4 (in 2D) or 6 (in 3D) dimensions, similar to <code>faces</code> in <a href="#TrixiParticles.RectangularTank"><code>RectangularTank</code></a>.</li><li><code>positions</code>: Tuple of new positions</li></ul><div class="admonition is-warning" id="Warning-fb91d84d2f88151e"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-fb91d84d2f88151e" title="Permalink"></a></header><div class="admonition-body"><p>There are overlapping particles when adjacent walls are moved inwards simultaneously.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/rectangular_tank.jl#L720-L731">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.RoundSphere" href="#TrixiParticles.RoundSphere"><code>TrixiParticles.RoundSphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RoundSphere(; start_angle=0.0, end_angle=2π)</code></pre><p>Construct a sphere (or sphere segment) by nesting perfectly round concentric spheres. The resulting ball will be perfectly round, but will not have a regular inner structure.</p><p><strong>Keywords</strong></p><ul><li><code>start_angle</code>: The starting angle of the sphere segment in radians. It determines the                beginning point of the segment. The default is set to <code>0.0</code> representing                the positive x-axis.</li><li><code>end_angle</code>: The ending angle of the sphere segment in radians. It defines the termination              point of the segment. The default is set to <code>2pi</code>, completing a full sphere.</li></ul><div class="admonition is-info" id="Usage-bcc2ad0167b58b26"><header class="admonition-header">Usage<a class="admonition-anchor" href="#Usage-bcc2ad0167b58b26" title="Permalink"></a></header><div class="admonition-body"><p>See <a href="#TrixiParticles.SphereShape-NTuple{4, Any}"><code>SphereShape</code></a> on how to use this.</p></div></div><div class="admonition is-warning" id="Warning-21b4d65e14d02903"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-21b4d65e14d02903" title="Permalink"></a></header><div class="admonition-body"><p>The sphere segment is intended for 2D geometries and hollow spheres. If used for filled spheres or in a 3D context, results may not be accurate.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/sphere_shape.jl#L137-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.VoxelSphere" href="#TrixiParticles.VoxelSphere"><code>TrixiParticles.VoxelSphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VoxelSphere()</code></pre><p>Construct a sphere of voxels (where particles are placed in the voxel center) with a regular inner structure but corners on the surface. Essentially, a grid of particles is generated and all particles outside the sphere are removed. The resulting sphere will have a perfect inner structure, but is not perfectly round, as it will have corners (like a sphere in Minecraft).</p><div class="admonition is-info" id="Usage-bcc2ad0167b58b26"><header class="admonition-header">Usage<a class="admonition-anchor" href="#Usage-bcc2ad0167b58b26" title="Permalink"></a></header><div class="admonition-body"><p>See <a href="#TrixiParticles.SphereShape-NTuple{4, Any}"><code>SphereShape</code></a> on how to use this.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/sphere_shape.jl#L123-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SphereShape-NTuple{4, Any}" href="#TrixiParticles.SphereShape-NTuple{4, Any}"><code>TrixiParticles.SphereShape</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SphereShape(particle_spacing, radius, center_position, density;
            sphere_type=VoxelSphere(), n_layers=-1, layer_outwards=false,
            cutout_min=(0.0, 0.0), cutout_max=(0.0, 0.0), tlsph=false,
            velocity=zeros(length(center_position)), mass=nothing, pressure=0.0)</code></pre><p>Generate a sphere that is either completely filled (by default) or hollow (by passing <code>n_layers</code>).</p><p>With the sphere type <a href="#TrixiParticles.VoxelSphere"><code>VoxelSphere</code></a>, a sphere of voxels (where particles are placed in the voxel center) with a regular inner structure but corners on the surface is created. Essentially, a grid of particles is generated and all particles outside the sphere are removed. With the sphere type <a href="#TrixiParticles.RoundSphere"><code>RoundSphere</code></a>, a perfectly round sphere with an imperfect inner structure is created.</p><p>A cuboid can be cut out of the sphere by specifying the two corners in negative and positive coordinate directions as <code>cutout_min</code> and <code>cutout_max</code>.</p><p><strong>Arguments</strong></p><ul><li><code>particle_spacing</code>:   Spacing between the particles.</li><li><code>radius</code>:             Radius of the sphere.</li><li><code>center_position</code>:    The coordinates of the center of the sphere.</li><li><code>density</code>:            Either a function mapping each particle&#39;s coordinates to its density,                       or a scalar for a constant density over all particles.</li></ul><p><strong>Keywords</strong></p><ul><li><code>sphere_type</code>:    Either <a href="#TrixiParticles.VoxelSphere"><code>VoxelSphere</code></a> or <a href="#TrixiParticles.RoundSphere"><code>RoundSphere</code></a> (see                   explanation above).</li><li><code>n_layers</code>:       Set to an integer greater than zero to generate a hollow sphere,                   where the shell consists of <code>n_layers</code> layers.</li><li><code>layer_outwards</code>: When set to <code>false</code> (by default), <code>radius</code> is the outer radius                   of the sphere. When set to <code>true</code>, <code>radius</code> is the inner radius                   of the sphere. This is only used when <code>n_layers &gt; 0</code>.</li><li><code>cutout_min</code>:     Corner in negative coordinate directions of a cuboid that is to be                   cut out of the sphere.</li><li><code>cutout_max</code>:     Corner in positive coordinate directions of a cuboid that is to be                   cut out of the sphere.</li><li><code>tlsph</code>:          With the <a href="../../systems/total_lagrangian_sph/#TrixiParticles.TotalLagrangianSPHSystem"><code>TotalLagrangianSPHSystem</code></a>, particles need to be placed                   on the boundary of the shape and not one particle radius away, as for fluids.                   When <code>tlsph=true</code>, particles will be placed on the boundary of the shape.</li><li><code>velocity</code>:   Either a function mapping each particle&#39;s coordinates to its velocity,               or, for a constant fluid velocity, a vector holding this velocity.               Velocity is constant zero by default.</li><li><code>mass</code>:       Either <code>nothing</code> (default) to automatically compute particle mass from particle               density and spacing, or a function mapping each particle&#39;s coordinates to its mass,               or a scalar for a constant mass over all particles.</li><li><code>pressure</code>:   Either a function mapping each particle&#39;s coordinates to its pressure,               or a scalar for a constant pressure over all particles. This is optional and               only needed when using the <a href="../../systems/entropically_damped_sph/#TrixiParticles.EntropicallyDampedSPHSystem"><code>EntropicallyDampedSPHSystem</code></a>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Filled circle with radius 0.5, center in (0.2, 0.4) and a particle spacing of 0.1
SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0)

# Same as before, but perfectly round
SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0, sphere_type=RoundSphere())

# Hollow circle with ~3 layers, outer radius 0.5, center in (0.2, 0.4) and a particle
# spacing of 0.1.
SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0, n_layers=3)

# Same as before, but perfectly round
SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0, n_layers=3, sphere_type=RoundSphere())

# Hollow circle with 3 layers, inner radius 0.5, center in (0.2, 0.4) and a particle spacing
# of 0.1.
SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0, n_layers=3, layer_outwards=true)

# Filled circle with radius 0.1, center in (0.0, 0.0), particle spacing 0.1, but the
# rectangle [0, 1] x [-0.2, 0.2] is cut out.
SphereShape(0.1, 1.0, (0.0, 0.0), 1000.0, cutout_min=(0.0, -0.2), cutout_max=(1.0, 0.2))

# Filled 3D sphere with radius 0.5, center in (0.2, 0.4, 0.3) and a particle spacing of 0.1
SphereShape(0.1, 0.5, (0.2, 0.4, 0.3), 1000.0)

# Same as before, but perfectly round
SphereShape(0.1, 0.5, (0.2, 0.4, 0.3), 1000.0, sphere_type=RoundSphere())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/785ade6a5eefb581087a193256c01237ace92854/src/setups/sphere_shape.jl#L1-L89">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../semidiscretization/">« Semidiscretization</a><a class="docs-footer-nextpage" href="../interpolation/">Interpolation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Monday 16 June 2025 17:03">Monday 16 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
