<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Weakly Compressible SPH (Fluid) · TrixiParticles.jl</title><meta name="title" content="Weakly Compressible SPH (Fluid) · TrixiParticles.jl"/><meta property="og:title" content="Weakly Compressible SPH (Fluid) · TrixiParticles.jl"/><meta property="twitter:title" content="Weakly Compressible SPH (Fluid) · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li><a class="tocitem" href="../../preprocessing/preprocessing/">Sampling of Geometries</a></li></ul></li><li><a class="tocitem" href="../../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../general/semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../../general/initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../../general/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../general/density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../../general/smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../../general/neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../../general/util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox" checked/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../dem/">Discrete Element Method (Solid)</a></li><li class="is-active"><a class="tocitem" href>Weakly Compressible SPH (Fluid)</a><ul class="internal"><li><a class="tocitem" href="#equation_of_state"><span>Equation of State</span></a></li><li><a class="tocitem" href="#viscosity_wcsph"><span>Viscosity</span></a></li><li><a class="tocitem" href="#density_diffusion"><span>Density Diffusion</span></a></li><li><a class="tocitem" href="#corrections"><span>Corrections</span></a></li><li><a class="tocitem" href="#surface_tension"><span>Surface Tension</span></a></li></ul></li><li><a class="tocitem" href="../entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li><li><a class="tocitem" href="../total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li><li><a class="tocitem" href="../../reference-pointneighbors/">PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li><a class="is-disabled">Systems</a></li><li class="is-active"><a href>Weakly Compressible SPH (Fluid)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Weakly Compressible SPH (Fluid)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/systems/weakly_compressible_sph.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="wcsph"><a class="docs-heading-anchor" href="#wcsph">Weakly Compressible SPH</a><a id="wcsph-1"></a><a class="docs-heading-anchor-permalink" href="#wcsph" title="Permalink"></a></h1><p>Weakly compressible SPH as introduced by <a href="../../references/#Monaghan1994">Monaghan (1994)</a>. This formulation relies on a stiff <a href="#equation_of_state">equation of state</a> that generates large pressure changes for small density variations.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.WeaklyCompressibleSPHSystem" href="#TrixiParticles.WeaklyCompressibleSPHSystem"><code>TrixiParticles.WeaklyCompressibleSPHSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WeaklyCompressibleSPHSystem(initial_condition,
                            density_calculator, state_equation,
                            smoothing_kernel, smoothing_length;
                            viscosity=nothing, density_diffusion=nothing,
                            acceleration=ntuple(_ -&gt; 0.0, NDIMS),
                            buffer_size=nothing,
                            correction=nothing, source_terms=nothing)</code></pre><p>System for particles of a fluid. The weakly compressible SPH (WCSPH) scheme is used, wherein a stiff equation of state generates large pressure changes for small density variations. See <a href="#wcsph">Weakly Compressible SPH</a> for more details on the method.</p><p><strong>Arguments</strong></p><ul><li><code>initial_condition</code>:  <a href="../../general/initial_condition/#TrixiParticles.InitialCondition"><code>InitialCondition</code></a> representing the system&#39;s particles.</li><li><code>density_calculator</code>: Density calculator for the system.                       See <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a> and <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a>.</li><li><code>state_equation</code>:     Equation of state for the system. See <a href="#TrixiParticles.StateEquationCole"><code>StateEquationCole</code></a>.</li><li><code>smoothing_kernel</code>:   Smoothing kernel to be used for this system.                       See <a href="../../general/smoothing_kernels/#smoothing_kernel">Smoothing Kernels</a>.</li><li><code>smoothing_length</code>:   Smoothing length to be used for this system.                       See <a href="../../general/smoothing_kernels/#smoothing_kernel">Smoothing Kernels</a>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>viscosity</code>:      Viscosity model for this system (default: no viscosity).                   See <a href="#TrixiParticles.ArtificialViscosityMonaghan"><code>ArtificialViscosityMonaghan</code></a> or <a href="#TrixiParticles.ViscosityAdami"><code>ViscosityAdami</code></a>.</li><li><code>density_diffusion</code>: Density diffusion terms for this system. See <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a>.</li><li><code>acceleration</code>:   Acceleration vector for the system. (default: zero vector)</li><li><code>buffer_size</code>:    Number of buffer particles.                   This is needed when simulating with <a href="../boundary/#TrixiParticles.OpenBoundarySPHSystem"><code>OpenBoundarySPHSystem</code></a>.</li><li><code>correction</code>:     Correction method used for this system. (default: no correction, see <a href="#corrections">Corrections</a>)</li><li><code>source_terms</code>:   Additional source terms for this system. Has to be either <code>nothing</code>                   (by default), or a function of <code>(coords, velocity, density, pressure, t)</code>                   (which are the quantities of a single particle), returning a <code>Tuple</code>                   or <code>SVector</code> that is to be added to the acceleration of that particle.                   See, for example, <a href="../../general/semidiscretization/#TrixiParticles.SourceTermDamping"><code>SourceTermDamping</code></a>.                   Note that these source terms will not be used in the calculation of the                   boundary pressure when using a boundary with                   <a href="../boundary/#TrixiParticles.BoundaryModelDummyParticles"><code>BoundaryModelDummyParticles</code></a> and <a href="../boundary/#TrixiParticles.AdamiPressureExtrapolation"><code>AdamiPressureExtrapolation</code></a>.                   The keyword argument <code>acceleration</code> should be used instead for                   gravity-like source terms.</li><li><code>surface_tension</code>:   Surface tension model used for this SPH system. (default: no surface tension)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/system.jl#L1-L46">source</a></section></article><h2 id="equation_of_state"><a class="docs-heading-anchor" href="#equation_of_state">Equation of State</a><a id="equation_of_state-1"></a><a class="docs-heading-anchor-permalink" href="#equation_of_state" title="Permalink"></a></h2><p>The equation of state is used to relate fluid density to pressure and thus allow an explicit simulation of the <a href="#TrixiParticles.WeaklyCompressibleSPHSystem">WCSPH system</a>. The equation in the following formulation was introduced by <a href="../../references/#Cole1948">Cole (1948)</a> (pp. 39 and 43). The pressure <span>$p$</span> is calculated as</p><p class="math-container">\[    p = B \left(\left(\frac{\rho}{\rho_0}\right)^\gamma - 1\right) + p_{\text{background}},\]</p><p>where <span>$\rho$</span> denotes the density, <span>$\rho_0$</span> the reference density, and <span>$p_{\text{background}}$</span> the background pressure, which is set to zero when applied to free-surface flows (<a href="../../references/#Adami2012">Adami et al., 2012</a>).</p><p>The bulk modulus, <span>$B =  \frac{\rho_0 c^2}{\gamma}$</span>, is calculated from the artificial speed of sound <span>$c$</span> and the isentropic exponent <span>$\gamma$</span>.</p><p>An ideal gas equation of state with a linear relationship between pressure and density can be obtained by choosing <code>exponent=1</code>, i.e.</p><p class="math-container">\[    p = B \left( \frac{\rho}{\rho_0} -1 \right) = c^2(\rho - \rho_0).\]</p><p>For higher Reynolds numbers, <code>exponent=7</code> is recommended, whereas at lower Reynolds numbers <code>exponent=1</code> yields more accurate pressure estimates since pressure and density are proportional (see <a href="../../references/#Morris1997">Morris, 1997</a>).</p><p>When using <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> (or <a href="../../callbacks/#TrixiParticles.DensityReinitializationCallback"><code>DensityReinitializationCallback</code></a>) and free surfaces, initializing particles with equal spacing will cause underestimated density and therefore strong attractive forces between particles at the free surface. Setting <code>clip_negative_pressure=true</code> can avoid this.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.StateEquationCole" href="#TrixiParticles.StateEquationCole"><code>TrixiParticles.StateEquationCole</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StateEquationCole(; sound_speed, reference_density, exponent,
                  background_pressure=0.0, clip_negative_pressure=false)</code></pre><p>Equation of state to describe the relationship between pressure and density of water up to high pressures.</p><p><strong>Keywords</strong></p><ul><li><code>sound_speed</code>:             Artificial speed of sound.</li><li><code>reference_density</code>:       Reference density of the fluid.</li><li><code>exponent</code>:                A value of <code>7</code> is usually used for most simulations.</li><li><code>background_pressure=0.0</code>: Background pressure.</li><li><code>clip_negative_pressure=false</code>: Negative pressure values are clipped to 0, which prevents spurious surface tension with <code>SummationDensity</code> but allows unphysical rarefaction of the fluid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/state_equations.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.StateEquationIdealGas" href="#TrixiParticles.StateEquationIdealGas"><code>TrixiParticles.StateEquationIdealGas</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StateEquationIdealGas( ;sound_speed, reference_density, gamma, background_pressure=0.0,
                       clip_negative_pressure=false)</code></pre><p>Equation of state to describe the relationship between pressure and density of a gas using the Ideal Gas Law.</p><p><strong>Keywords</strong></p><ul><li><code>sound_speed</code>                 : Artificial speed of sound.</li><li><code>reference_density</code>           : Reference density of the fluid.</li><li><code>gamma</code>                       : Heat-capacity ratio</li><li><code>background_pressure=0.0</code>     : Background pressure.</li><li><code>clip_negative_pressure=false</code>: Negative pressure values are clipped to 0, which prevents spurious surface tension with <code>SummationDensity</code> but allows unphysical rarefaction of the fluid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/state_equations.jl#L54-L67">source</a></section></article><h2 id="viscosity_wcsph"><a class="docs-heading-anchor" href="#viscosity_wcsph">Viscosity</a><a id="viscosity_wcsph-1"></a><a class="docs-heading-anchor-permalink" href="#viscosity_wcsph" title="Permalink"></a></h2><p>TODO: Explain viscosity.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ArtificialViscosityMonaghan" href="#TrixiParticles.ArtificialViscosityMonaghan"><code>TrixiParticles.ArtificialViscosityMonaghan</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ArtificialViscosityMonaghan(; alpha, beta=0.0, epsilon=0.01)</code></pre><p>Artificial viscosity by Monaghan ([<a href="../../references/#Monaghan1992">16</a>], [<a href="../../references/#Monaghan1989">17</a>]), given by</p><p class="math-container">\[\Pi_{ab} =
\begin{cases}
    -(\alpha c \mu_{ab} + \beta \mu_{ab}^2) / \bar{\rho}_{ab} &amp; \text{if } v_{ab} \cdot r_{ab} &lt; 0, \\
    0 &amp; \text{otherwise}
\end{cases}\]</p><p>with</p><p class="math-container">\[\mu_{ab} = \frac{h v_{ab} \cdot r_{ab}}{\Vert r_{ab} \Vert^2 + \epsilon h^2},\]</p><p>where <span>$\alpha, \beta, \epsilon$</span> are parameters, <span>$c$</span> is the speed of sound, <span>$h$</span> is the smoothing length, <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>, <span>$v_{ab} = v_a - v_b$</span> is the difference of their velocities, and <span>$\bar{\rho}_{ab}$</span> is the arithmetic mean of their densities.</p><p>Note that <span>$\alpha$</span> needs to adjusted for different resolutions to maintain a specific Reynolds Number. To do so, <a href="../../references/#Monaghan2005">Monaghan (2005)</a> defined an equivalent effective physical kinematic viscosity <span>$\nu$</span> by</p><p class="math-container">\[    \nu = \frac{\alpha h c }{2d + 4},\]</p><p>where <span>$d$</span> is the dimension.</p><p><strong>Keywords</strong></p><ul><li><code>alpha</code>: A value of <code>0.02</code> is usually used for most simulations. For a relation with the          kinematic viscosity, see description above.</li><li><code>beta=0.0</code>: A value of <code>0.0</code> works well for most fluid simulations and simulations             with shocks of moderate strength. In simulations where the Mach number can be             very high, eg. astrophysical calculation, good results can be obtained by             choosing a value of <code>beta=2.0</code> and <code>alpha=1.0</code>.</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/viscosity.jl#L32-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityAdami" href="#TrixiParticles.ViscosityAdami"><code>TrixiParticles.ViscosityAdami</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityAdami(; nu, epsilon=0.01)</code></pre><p>Viscosity by <a href="../../references/#Adami2012">Adami (2012)</a>. The viscous interaction is calculated with the shear force for incompressible flows given by</p><p class="math-container">\[f_{ab} = \sum_w \bar{\eta}_{ab} \left( V_a^2 + V_b^2 \right) \frac{v_{ab}}{||r_{ab}||^2+\epsilon h_{ab}^2}  \nabla W_{ab} \cdot r_{ab},\]</p><p>where <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>, <span>$v_{ab} = v_a - v_b$</span> is the difference of their velocities, <span>$h$</span> is the smoothing length and <span>$V$</span> is the particle volume. The parameter <span>$\epsilon$</span> prevents singularities (see <a href="../../references/#Ramachandran2019">Ramachandran (2019)</a>). The inter-particle-averaged shear stress  is</p><p class="math-container">\[    \bar{\eta}_{ab} =\frac{2 \eta_a \eta_b}{\eta_a + \eta_b},\]</p><p>where <span>$\eta_a = \rho_a \nu_a$</span> with <span>$\nu$</span> as the kinematic viscosity.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>: Kinematic viscosity</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/viscosity.jl#L181-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityMorris" href="#TrixiParticles.ViscosityMorris"><code>TrixiParticles.ViscosityMorris</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityMorris(; nu, epsilon=0.01)</code></pre><p>Viscosity by <a href="../../references/#Morris1997">Morris (1997)</a> also used by <a href="../../references/#Fourtakas2019">Fourtakas (2019)</a>.</p><p>To the force <span>$f_{ab}$</span> between two particles <span>$a$</span> and <span>$b$</span> due to pressure gradients, an additional force term <span>$\tilde{f}_{ab}$</span> is added with</p><p class="math-container">\[\tilde{f}_{ab} = m_a m_b \frac{(\mu_a + \mu_b) r_{ab} \cdot \nabla W_{ab}}{\rho_a \rho_b (\Vert r_{ab} \Vert^2 + \epsilon h^2)} v_{ab},\]</p><p>where <span>$\mu_a = \rho_a \nu$</span> and <span>$\mu_b = \rho_b \nu$</span> denote the dynamic viscosity of particle <span>$a$</span> and <span>$b$</span> respectively, and <span>$\nu$</span> is the kinematic viscosity.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>: Kinematic viscosity</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/viscosity.jl#L78-L94">source</a></section></article><h2 id="density_diffusion"><a class="docs-heading-anchor" href="#density_diffusion">Density Diffusion</a><a id="density_diffusion-1"></a><a class="docs-heading-anchor-permalink" href="#density_diffusion" title="Permalink"></a></h2><p>Density diffusion can be used with <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a> to remove the noise in the pressure field. It is highly recommended to use density diffusion when using WCSPH.</p><h3 id="Formulation"><a class="docs-heading-anchor" href="#Formulation">Formulation</a><a id="Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Formulation" title="Permalink"></a></h3><p>All density diffusion terms extend the continuity equation (see <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a>) by an additional term</p><p class="math-container">\[\frac{\mathrm{d}\rho_a}{\mathrm{d}t} = \sum_{b} m_b v_{ab} \cdot \nabla_{r_a} W(\Vert r_{ab} \Vert, h)
    + \delta h c \sum_{b} V_b \psi_{ab} \cdot \nabla_{r_a} W(\Vert r_{ab} \Vert, h),\]</p><p>where <span>$V_b = m_b / \rho_b$</span> is the volume of particle <span>$b$</span> and <span>$\psi_{ab}$</span> depends on the density diffusion method (see <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> for available terms). Also, <span>$\rho_a$</span> denotes the density of particle <span>$a$</span> and <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates, <span>$v_{ab} = v_a - v_b$</span> of the velocities of particles <span>$a$</span> and <span>$b$</span>.</p><h3 id="Numerical-Results"><a class="docs-heading-anchor" href="#Numerical-Results">Numerical Results</a><a id="Numerical-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Results" title="Permalink"></a></h3><p>All density diffusion terms remove numerical noise in the pressure field and produce more accurate results than weakly commpressible SPH without density diffusion. This can be demonstrated with dam break examples in 2D and 3D. Here, <span>$δ = 0.1$</span> has been used for all terms. Note that, due to added stability, the adaptive time integration method that was used here can choose higher time steps in the simulations with density diffusion. For the cheap <a href="#TrixiParticles.DensityDiffusionMolteniColagrossi"><code>DensityDiffusionMolteniColagrossi</code></a>, this results in reduced runtime.</p><figure>
  <img src="https://github.com/trixi-framework/TrixiParticles.jl/assets/44124897/01289e3b-98ce-4b2d-8151-cd20782d5823" alt="density_diffusion_2d"/>
  <figcaption>Dam break in 2D with different density diffusion terms</figcaption>
</figure><figure>
  <img src="https://github.com/trixi-framework/TrixiParticles.jl/assets/44124897/63a05b2a-6c37-468e-b895-15ab142a4eba" alt="density_diffusion_3d"/>
  <figcaption>Dam break in 3D with different density diffusion terms</figcaption>
</figure><p>The simpler terms <a href="#TrixiParticles.DensityDiffusionMolteniColagrossi"><code>DensityDiffusionMolteniColagrossi</code></a> and <a href="#TrixiParticles.DensityDiffusionFerrari"><code>DensityDiffusionFerrari</code></a> do not solve the hydrostatic problem and lead to incorrect solutions in long-running steady-state hydrostatic simulations with free surfaces <a href="../../references/#Antuono2012">(Antuono et al., 2012)</a>. This can be seen when running the simple rectangular tank example until <span>$t = 40$</span> (again using <span>$δ = 0.1$</span>):</p><figure>
  <img src="https://github.com/trixi-framework/TrixiParticles.jl/assets/44124897/440debc9-6051-4a3b-aa9c-02a6b32fccf3" alt="density_diffusion_tank"/>
  <figcaption>Tank in rest under gravity in 3D with different density diffusion terms</figcaption>
</figure><p><a href="#TrixiParticles.DensityDiffusionAntuono"><code>DensityDiffusionAntuono</code></a> adds a correction term to solve this problem, but this term is very expensive and adds about 40–50% of computational cost.</p><h3 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.DensityDiffusion" href="#TrixiParticles.DensityDiffusion"><code>TrixiParticles.DensityDiffusion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DensityDiffusion</code></pre><p>An abstract supertype of all density diffusion formulations.</p><p>Currently, the following formulations are available:</p><table><tr><th style="text-align: left">Formulation</th><th style="text-align: left">Suitable for Steady-State Simulations</th><th style="text-align: left">Low Computational Cost</th></tr><tr><td style="text-align: left"><a href="#TrixiParticles.DensityDiffusionMolteniColagrossi"><code>DensityDiffusionMolteniColagrossi</code></a></td><td style="text-align: left">❌</td><td style="text-align: left">✅</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.DensityDiffusionFerrari"><code>DensityDiffusionFerrari</code></a></td><td style="text-align: left">❌</td><td style="text-align: left">✅</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.DensityDiffusionAntuono"><code>DensityDiffusionAntuono</code></a></td><td style="text-align: left">✅</td><td style="text-align: left">❌</td></tr></table><p>See <a href="#density_diffusion">Density Diffusion</a> for a comparison and more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/density_diffusion.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.DensityDiffusionAntuono" href="#TrixiParticles.DensityDiffusionAntuono"><code>TrixiParticles.DensityDiffusionAntuono</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DensityDiffusionAntuono(initial_condition; delta)</code></pre><p>The commonly used density diffusion terms by <a href="../../references/#Antuono2010">Antuono (2010)</a>, also referred to as δ-SPH. The density diffusion term by <a href="../../references/#Molteni2009">Molteni (2009)</a> is extended by a second term, which is nicely written down by <a href="../../references/#Antuono2012">Antuono (2012)</a>.</p><p>The term <span>$\psi_{ab}$</span> in the continuity equation in <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> is defined by</p><p class="math-container">\[\psi_{ab} = 2\left(\rho_a - \rho_b - \frac{1}{2}\big(\nabla\rho^L_a + \nabla\rho^L_b\big) \cdot r_{ab}\right)
    \frac{r_{ab}}{\Vert r_{ab} \Vert^2},\]</p><p>where <span>$\rho_a$</span> and <span>$\rho_b$</span> denote the densities of particles <span>$a$</span> and <span>$b$</span> respectively and <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>. The symbol <span>$\nabla\rho^L_a$</span> denotes the renormalized density gradient defined as</p><p class="math-container">\[\nabla\rho^L_a = -\sum_b (\rho_a - \rho_b) V_b L_a \nabla_{r_a} W(\Vert r_{ab} \Vert, h)\]</p><p>with</p><p class="math-container">\[L_a := \left( -\sum_{b} V_b r_{ab} \otimes \nabla_{r_a} W(\Vert r_{ab} \Vert, h) \right)^{-1} \in \R^{d \times d},\]</p><p>where <span>$d$</span> is the number of dimensions.</p><p>See <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> for an overview and comparison of implemented density diffusion terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/density_diffusion.jl#L83-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.DensityDiffusionFerrari" href="#TrixiParticles.DensityDiffusionFerrari"><code>TrixiParticles.DensityDiffusionFerrari</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DensityDiffusionFerrari()</code></pre><p>A density diffusion term by <a href="../../references/#Ferrari2009">Ferrari (2009)</a>.</p><p>The term <span>$\psi_{ab}$</span> in the continuity equation in <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> is defined by</p><p class="math-container">\[\psi_{ab} = \frac{\rho_a - \rho_b}{2h} \frac{r_{ab}}{\Vert r_{ab} \Vert},\]</p><p>where <span>$\rho_a$</span> and <span>$\rho_b$</span> denote the densities of particles <span>$a$</span> and <span>$b$</span> respectively, <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span> and <span>$h$</span> is the smoothing length.</p><p>See <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> for an overview and comparison of implemented density diffusion terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/density_diffusion.jl#L52-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.DensityDiffusionMolteniColagrossi" href="#TrixiParticles.DensityDiffusionMolteniColagrossi"><code>TrixiParticles.DensityDiffusionMolteniColagrossi</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DensityDiffusionMolteniColagrossi(; delta)</code></pre><p>The commonly used density diffusion term by <a href="../../references/#Molteni2009">Molteni (2009)</a>.</p><p>The term <span>$\psi_{ab}$</span> in the continuity equation in <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> is defined by</p><p class="math-container">\[\psi_{ab} = 2(\rho_a - \rho_b) \frac{r_{ab}}{\Vert r_{ab} \Vert^2},\]</p><p>where <span>$\rho_a$</span> and <span>$\rho_b$</span> denote the densities of particles <span>$a$</span> and <span>$b$</span> respectively and <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>.</p><p>See <a href="#TrixiParticles.DensityDiffusion"><code>DensityDiffusion</code></a> for an overview and comparison of implemented density diffusion terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/weakly_compressible_sph/density_diffusion.jl#L23-L38">source</a></section></article><h2 id="corrections"><a class="docs-heading-anchor" href="#corrections">Corrections</a><a id="corrections-1"></a><a class="docs-heading-anchor-permalink" href="#corrections" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.AkinciFreeSurfaceCorrection" href="#TrixiParticles.AkinciFreeSurfaceCorrection"><code>TrixiParticles.AkinciFreeSurfaceCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AkinciFreeSurfaceCorrection(rho0)</code></pre><p>Free surface correction according to <a href="../../references/#Akinci2013">Akinci et al. (2013)</a>. At a free surface, the mean density is typically lower than the reference density, resulting in reduced surface tension and viscosity forces. The free surface correction adjusts the viscosity, pressure, and surface tension forces near free surfaces to counter this effect. It&#39;s important to note that this correlation is unphysical and serves as an approximation. The computation time added by this method is about 2–3%.</p><p>Mathematically the idea is quite simple. If we have an SPH particle in the middle of a volume at rest, its density will be identical to the rest density <span>$\rho_0$</span>. If we now consider an SPH particle at a free surface at rest, it will have neighbors missing in the direction normal to the surface, which will result in a lower density. If we calculate the correction factor</p><p class="math-container">\[k = \rho_0/\rho_\text{mean},\]</p><p>this value will be about ~1.5 for particles at the free surface and can then be used to increase the pressure and viscosity accordingly.</p><p><strong>Arguments</strong></p><ul><li><code>rho0</code>: Rest density.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/general/corrections.jl#L2-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BlendedGradientCorrection" href="#TrixiParticles.BlendedGradientCorrection"><code>TrixiParticles.BlendedGradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BlendedGradientCorrection()</code></pre><p>Calculate a blended gradient to reduce the stability issues of the <a href="#TrixiParticles.GradientCorrection"><code>GradientCorrection</code></a> as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>.</p><p>This calculates the following,</p><p class="math-container">\[\tilde\nabla A_i = (1-\lambda) \nabla A_i + \lambda L_i \nabla A_i\]</p><p>with <span>$0 \leq \lambda \leq 1$</span> being the blending factor.</p><p><strong>Arguments</strong></p><ul><li><code>blending_factor</code>: Blending factor between corrected and regular SPH gradient.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/general/corrections.jl#L278-L292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.GradientCorrection" href="#TrixiParticles.GradientCorrection"><code>TrixiParticles.GradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GradientCorrection()</code></pre><p>Compute the corrected gradient of particle interactions based on their relative positions (see <a href="../../references/#Bonet1999">Bonet, 1999</a>).</p><p><strong>Mathematical Details</strong></p><p>Given the standard SPH representation, the gradient of a field <span>$A$</span> at particle <span>$a$</span> is given by</p><p class="math-container">\[\nabla A_a = \sum_b m_b \frac{A_b - A_a}{\rho_b} \nabla_{r_a} W(\Vert r_a - r_b \Vert, h),\]</p><p>where <span>$m_b$</span> is the mass of particle <span>$b$</span> and <span>$\rho_b$</span> is the density of particle <span>$b$</span>.</p><p>The gradient correction, as commonly proposed, involves multiplying this gradient with a correction matrix <span>$L$</span>:</p><p class="math-container">\[\tilde{\nabla} A_a = \bm{L}_a \nabla A_a\]</p><p>The correction matrix  <span>$\bm{L}_a$</span> is computed based on the provided particle configuration, aiming to make the corrected gradient more accurate, especially near domain boundaries.</p><p>To satisfy</p><p class="math-container">\[\sum_b V_b r_{ba} \otimes \tilde{\nabla}W_b(r_a) = \left( \sum_b V_b r_{ba} \otimes \nabla W_b(r_a) \right) \bm{L}_a^T = \bm{I}\]</p><p>the correction matrix <span>$\bm{L}_a$</span> is evaluated explicitly as</p><p class="math-container">\[\bm{L}_a = \left( \sum_b V_b \nabla W_b(r_{a}) \otimes r_{ba} \right)^{-1}.\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>Stability issues arise, especially when particles separate into small clusters.</li><li>Doubles the computational effort.</li><li>Better stability with smoother smoothing Kernels with larger support, e.g. <a href="../../general/smoothing_kernels/#TrixiParticles.SchoenbergQuinticSplineKernel"><code>SchoenbergQuinticSplineKernel</code></a> or <a href="../../general/smoothing_kernels/#TrixiParticles.WendlandC6Kernel"><code>WendlandC6Kernel</code></a>.</li><li>Set <code>dt_max =&lt; 1e-3</code> for stability.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/general/corrections.jl#L236-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.KernelCorrection" href="#TrixiParticles.KernelCorrection"><code>TrixiParticles.KernelCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KernelCorrection()</code></pre><p>Kernel correction, as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>, uses Shepard interpolation to obtain a 0-th order accurate result, which was first proposed by Li et al. This can be further extended to obtain a kernel corrected gradient as shown by <a href="../../references/#Basa2008">Basa et al. (2008)</a>.</p><p>The kernel correction coefficient is determined by</p><p class="math-container">\[c(x) = \sum_{b=1} V_b W_b(x)\]</p><p>The gradient of corrected kernel is determined by</p><p class="math-container">\[\nabla \tilde{W}_{b}(r) =\frac{\nabla W_{b}(r) - W_b(r) \gamma(r)}{\sum_{b=1} V_b W_b(r)} , \quad  \text{where} \quad
\gamma(r) = \frac{\sum_{b=1} V_b \nabla W_b(r)}{\sum_{b=1} V_b W_b(r)}.\]</p><p>This correction can be applied with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> and <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a>, which leads to an improvement, especially at free surfaces.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>This only works when the boundary model uses <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> (yet).</li><li>It is also referred to as &quot;0th order correction&quot;.</li><li>In 2D, we can expect an increase of about 10–15% in computation time.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/general/corrections.jl#L71-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.MixedKernelGradientCorrection" href="#TrixiParticles.MixedKernelGradientCorrection"><code>TrixiParticles.MixedKernelGradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MixedKernelGradientCorrection()</code></pre><p>Combines <a href="#TrixiParticles.GradientCorrection"><code>GradientCorrection</code></a> and <a href="#TrixiParticles.KernelCorrection"><code>KernelCorrection</code></a>, which results in a 1st-order-accurate SPH method (see <a href="../../references/#Bonet1999">Bonet, 1999</a>).</p><p><strong>Notes:</strong></p><ul><li>Stability issues, especially when particles separate into small clusters.</li><li>Doubles the computational effort.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/general/corrections.jl#L98-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ShepardKernelCorrection" href="#TrixiParticles.ShepardKernelCorrection"><code>TrixiParticles.ShepardKernelCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShepardKernelCorrection()</code></pre><p>Kernel correction, as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>, uses Shepard interpolation to obtain a 0-th order accurate result, which was first proposed by <a href="../../references/#Li1996">Li et al. (1996)</a>.</p><p>The kernel correction coefficient is determined by</p><p class="math-container">\[c(x) = \sum_{b=1} V_b W_b(x),\]</p><p>where <span>$V_b = m_b / \rho_b$</span> is the volume of particle <span>$b$</span>.</p><p>This correction is applied with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> to correct the density and leads to an improvement, especially at free surfaces.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>It is also referred to as &quot;0th order correction&quot;.</li><li>In 2D, we can expect an increase of about 5–6% in computation time.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/general/corrections.jl#L50-L68">source</a></section></article><h2 id="surface_tension"><a class="docs-heading-anchor" href="#surface_tension">Surface Tension</a><a id="surface_tension-1"></a><a class="docs-heading-anchor-permalink" href="#surface_tension" title="Permalink"></a></h2><h3 id="Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model"><a class="docs-heading-anchor" href="#Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model">Akinci-based intra-particle force surface tension and wall adhesion model</a><a id="Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model-1"></a><a class="docs-heading-anchor-permalink" href="#Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model" title="Permalink"></a></h3><p>The work by Akinci proposes three forces:</p><ul><li>a cohesion force</li><li>a surface area minimization force</li><li>a wall adhesion force</li></ul><p>The classical model is composed of the curvature minimization and cohesion force.</p><h4 id="Cohesion-force"><a class="docs-heading-anchor" href="#Cohesion-force">Cohesion force</a><a id="Cohesion-force-1"></a><a class="docs-heading-anchor-permalink" href="#Cohesion-force" title="Permalink"></a></h4><p>The model calculates the cohesion force based on the distance between particles and the support radius <span>$h_c$</span>. This force is determined using two distinct regimes within the support radius:</p><ul><li>For particles closer than half the support radius, a repulsive force is calculated to prevent particle clustering too tightly, enhancing the simulation&#39;s stability and realism.</li><li>Beyond half the support radius and within the full support radius, an attractive force is computed, simulating the effects of surface tension that draw particles together.</li></ul><p>The cohesion force, <span>$F_{\text{cohesion}}$</span>, for a pair of particles is given by:</p><p class="math-container">\[F_{\text{cohesion}} = -\sigma m_b C(r) \frac{r}{\Vert r \Vert},\]</p><p>where:</p><ul><li><span>$\sigma$</span> represents the surface tension coefficient, adjusting the overall strength of the cohesion effect.</li><li><span>$C$</span> is a scalar function of the distance between particles.</li></ul><p>The cohesion kernel <span>$C$</span> is defined as</p><p class="math-container">\[C(r)=\frac{32}{\pi h_c^9}
\begin{cases}
(h_c-r)^3 r^3, &amp; \text{if } 2r &gt; h_c \\
2(h_c-r)^3 r^3 - \frac{h^6}{64}, &amp; \text{if } r &gt; 0 \text{ and } 2r \leq h_c \\
0, &amp; \text{otherwise}
\end{cases}\]</p><h4 id="Surface-area-minimization-force"><a class="docs-heading-anchor" href="#Surface-area-minimization-force">Surface area minimization force</a><a id="Surface-area-minimization-force-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-area-minimization-force" title="Permalink"></a></h4><p>To model the minimization of the surface area and curvature of the fluid, a curvature force is used, which is calculated as</p><p class="math-container">\[F_{\text{curvature}} = -\sigma (n_a - n_b)\]</p><h4 id="Wall-adhesion-force"><a class="docs-heading-anchor" href="#Wall-adhesion-force">Wall adhesion force</a><a id="Wall-adhesion-force-1"></a><a class="docs-heading-anchor-permalink" href="#Wall-adhesion-force" title="Permalink"></a></h4><p>The wall adhesion model proposed by Akinci et al. is based on a kernel function which is 0 from 0.0 to 0.5 support radiia with a maximum at 0.75. With the force calculated with an adhesion coefficient <span>$\beta$</span> as</p><p class="math-container">\[F_{\text{adhesion}} = -\beta m_b A(r) \frac{r}{\Vert r \Vert},\]</p><p>with <span>$A$</span> being the adhesion kernel defined as</p><p class="math-container">\[A(r)= \frac{0.007}{h_c^{3.25}}
\begin{cases}
\sqrt[4]{- \frac{4r^2}{h_c} + 6r - 2h_c}, &amp; \text{if } 2r &gt; h_c \text{ and } r \leq h_c \\
0, &amp; \text{otherwise.}
\end{cases}\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.CohesionForceAkinci" href="#TrixiParticles.CohesionForceAkinci"><code>TrixiParticles.CohesionForceAkinci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CohesionForceAkinci(surface_tension_coefficient=1.0)</code></pre><p>This model only implements the cohesion force of the [<a href="../../references/#Akinci2013">25</a>] surface tension model.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: Modifies the intensity of the surface tension-induced force,  enabling the tuning of the fluid&#39;s surface tension properties within the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/surface_tension.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SurfaceTensionAkinci" href="#TrixiParticles.SurfaceTensionAkinci"><code>TrixiParticles.SurfaceTensionAkinci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceTensionAkinci(surface_tension_coefficient=1.0)</code></pre><p>Implements a model for surface tension and adhesion effects drawing upon the principles outlined by [<a href="../../references/#Akinci2013">25</a>]. This model is instrumental in capturing the nuanced behaviors of fluid surfaces, such as droplet formation and the dynamics of merging or separation, by utilizing intra-particle forces.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: A parameter to adjust the magnitude of  surface tension forces, facilitating the fine-tuning of how surface tension phenomena  are represented in the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/e5a8834b2b585cc007a4622735286b75bcb22992/src/schemes/fluid/surface_tension.jl#L20-L32">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dem/">« Discrete Element Method (Solid)</a><a class="docs-footer-nextpage" href="../entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 2 January 2025 12:31">Thursday 2 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
