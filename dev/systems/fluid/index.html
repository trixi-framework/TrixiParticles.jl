<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · TrixiParticles.jl</title><meta name="title" content="Overview · TrixiParticles.jl"/><meta property="og:title" content="Overview · TrixiParticles.jl"/><meta property="twitter:title" content="Overview · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.js"></script><link href="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li><a class="tocitem" href="../../preprocessing/preprocessing/">Sampling of Geometries</a></li></ul></li><li><a class="tocitem" href="../../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../general/semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../../general/initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../../general/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../general/density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../../general/smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../../general/neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../../general/util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox" checked/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-11-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-11-3-1"><span class="docs-label">Fluid Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#viscosity_sph"><span>Viscosity</span></a></li><li><a class="tocitem" href="#corrections"><span>Corrections</span></a></li><li><a class="tocitem" href="#surface_normal"><span>Surface Normals</span></a></li><li><a class="tocitem" href="#surface_tension"><span>Surface Tension</span></a></li></ul></li><li><a class="tocitem" href="../weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li></ul></li><li><a class="tocitem" href="../dem/">Discrete Element Method (Solid)</a></li><li><a class="tocitem" href="../total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li><li><a class="tocitem" href="../../reference-pointneighbors/">PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li><a class="is-disabled">Systems</a></li><li><a class="is-disabled">Fluid Models</a></li><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/systems/fluid.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="fluid_models"><a class="docs-heading-anchor" href="#fluid_models">Fluid Models</a><a id="fluid_models-1"></a><a class="docs-heading-anchor-permalink" href="#fluid_models" title="Permalink"></a></h1><p>Currently available fluid methods are the <a href="../weakly_compressible_sph/#wcsph">weakly compressible SPH method</a> and the <a href="../entropically_damped_sph/#edac">entropically damped artificial compressibility for SPH</a>. This page lists models and techniques that apply to both of these methods.</p><h2 id="viscosity_sph"><a class="docs-heading-anchor" href="#viscosity_sph">Viscosity</a><a id="viscosity_sph-1"></a><a class="docs-heading-anchor-permalink" href="#viscosity_sph" title="Permalink"></a></h2><p>Viscosity is a critical physical property governing momentum diffusion within a fluid. In the context of SPH, viscosity determines how rapidly velocity gradients are smoothed out, influencing key flow characteristics such as boundary layer formation, vorticity diffusion, and dissipation of kinetic energy. It also helps determine whether a flow is laminar or turbulent under a given set of conditions.</p><p>Implementing viscosity correctly in SPH is essential for producing physically accurate results, and different methods exist to capture both numerical stabilization and true viscous effects.</p><h3 id="Artificial-(numerical)-viscosity"><a class="docs-heading-anchor" href="#Artificial-(numerical)-viscosity">Artificial (numerical) viscosity</a><a id="Artificial-(numerical)-viscosity-1"></a><a class="docs-heading-anchor-permalink" href="#Artificial-(numerical)-viscosity" title="Permalink"></a></h3><p>Artificial (numerical) viscosity is a technique used to stabilize simulations of inviscid flows, which would otherwise show unphysical particle movement due to numerical instability. To achieve this, a dissipative term is added to the momentum equations in a way that it does not significantly alter the physical behavior of the flow. This approach is especially useful in simulations such as high-speed flows with strong shocks or astrophysical scenarios, where other approaches are insufficient to stabilize the simulation.</p><h3 id="Physical-(real)-viscosity"><a class="docs-heading-anchor" href="#Physical-(real)-viscosity">Physical (real) viscosity</a><a id="Physical-(real)-viscosity-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-(real)-viscosity" title="Permalink"></a></h3><p>Physical viscosity is essential for accurately modeling the true viscous stresses within a fluid. It ensures that simulations align with a target Reynolds number or adhere to experimentally measured fluid properties. This is achieved by incorporating forces that replicate the viscous stress term found in the Navier–Stokes equations. As a result, the method is particularly effective for simulating low-speed, incompressible, or weakly compressible flows, where it is crucial to capture the actual behavior of the fluid.</p><h3 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h3><h4 id="ArtificialViscosityMonaghan"><a class="docs-heading-anchor" href="#ArtificialViscosityMonaghan">ArtificialViscosityMonaghan</a><a id="ArtificialViscosityMonaghan-1"></a><a class="docs-heading-anchor-permalink" href="#ArtificialViscosityMonaghan" title="Permalink"></a></h4><p><code>ArtificialViscosityMonaghan</code> by Monaghan ([<a href="../../references/#Monaghan1992">11</a>], [<a href="../../references/#Monaghan1989">12</a>]) should be mainly used for inviscid flows (Euler), artificial stabilization or shock-capturing, for which Monaghan [<a href="../../references/#Monaghan1989">12</a>] originally designed this term to provide smoothing across shocks, intentionally overestimating the physical viscosity. The implementation includes a dissipation term that becomes more significant as particles approach one another. This helps suppress tensile instabilities, which can lead to particle clumping and effectively smooths out high-frequency pressure fluctuations. This increase in dissipation is triggered by the relative motion between particles: as particles come closer and compress the local flow, the artificial viscosity term becomes stronger to damp out rapid changes and prevent unphysical clustering. This ensures that while the simulation remains stable in challenging flow regimes with large density or pressure variations, the physical behavior is not overly altered. Several extensions have been proposed to limit the dissipation effect for example by Balsara ([<a href="../../references/#Balsara1995">13</a>]) or Morris ([<a href="../../references/#Morris1997">14</a>]).</p><h5 id="Mathematical-Formulation"><a class="docs-heading-anchor" href="#Mathematical-Formulation">Mathematical Formulation</a><a id="Mathematical-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Formulation" title="Permalink"></a></h5><p>The force exerted by particle <code>b</code> on particle <code>a</code> due to artificial viscosity is given by:</p><p class="math-container">\[F_{ab}^{\text{AV}} = - m_a m_b \Pi_{ab} \nabla W_{ab}\]</p><p>where:</p><ul><li><span>$\Pi_{ab}$</span> is the artificial viscosity term defined as:<p class="math-container">\[\Pi_{ab} =
\begin{cases}
    -\frac{\alpha c \mu_{ab} + \beta \mu_{ab}^2}{\bar{\rho}_{ab}} &amp; \text{if } \mathbf{v}_{ab} \cdot \mathbf{r}_{ab} &lt; 0, \\
    0 &amp; \text{otherwise}
\end{cases}\]</p></li><li><span>$\alpha$</span> and <span>$\beta$</span> are viscosity parameters,</li><li><span>$c$</span> is the local speed of sound,</li><li><span>$\bar{\rho}_{ab}$</span> is the arithmetic mean of the densities of particles <span>$a$</span> and <span>$b$</span>.</li></ul><p>The term <span>$\mu_{ab}$</span> is defined as:</p><p class="math-container">\[\mu_{ab} = \frac{h \, v_{ab} \cdot r_{ab}}{\Vert r_{ab} \Vert^2 + \epsilon h^2},\]</p><p>with:</p><ul><li><span>$h$</span> being the smoothing length,</li><li><span>$\epsilon$</span> a small parameter to prevent singularities,</li><li><span>$r_{ab} = r_a - r_b$</span> representing the difference of the coordinate vectors,</li><li><span>$v_{ab} = v_a - v_b$</span> representing the relative velocity between particles.</li></ul><h5 id="Resolution-Dependency-and-Effective-Viscosity"><a class="docs-heading-anchor" href="#Resolution-Dependency-and-Effective-Viscosity">Resolution Dependency and Effective Viscosity</a><a id="Resolution-Dependency-and-Effective-Viscosity-1"></a><a class="docs-heading-anchor-permalink" href="#Resolution-Dependency-and-Effective-Viscosity" title="Permalink"></a></h5><p>To ensure that the simulation maintains a consistent Reynolds number when the resolution changes, the parameter <span>$\alpha$</span> must be adjusted accordingly. Monaghan (2005) introduced an effective physical kinematic viscosity <span>$\nu$</span> defined as:</p><p class="math-container">\[\nu = \frac{\alpha h c}{2d + 4},\]</p><p>where <strong><span>$d$</span></strong> is the number of spatial dimensions. This relation allows the calibration of <span>$\alpha$</span> to achieve the desired viscous behavior as the resolution or simulation conditions vary.</p><h4 id="ViscosityMorris"><a class="docs-heading-anchor" href="#ViscosityMorris">ViscosityMorris</a><a id="ViscosityMorris-1"></a><a class="docs-heading-anchor-permalink" href="#ViscosityMorris" title="Permalink"></a></h4><p><code>ViscosityMorris</code> is ideal for moderate to low Mach number flows where accurately modeling physical viscous behavior is essential. Developed by <a href="../../references/#Morris1997">Morris (1997)</a> and later applied by <a href="../../references/#Fourtakas2019">Fourtakas (2019)</a>, this method directly simulates the viscous stresses found in fluids rather than relying on artificial viscosity. By approximating momentum diffusion based on local fluid properties, the method captures the actual viscous forces without excessive damping. This results in a more realistic representation of flow dynamics in weakly compressible scenarios.</p><h5 id="Mathematical-Formulation-2"><a class="docs-heading-anchor" href="#Mathematical-Formulation-2">Mathematical Formulation</a><a class="docs-heading-anchor-permalink" href="#Mathematical-Formulation-2" title="Permalink"></a></h5><p>An additional force term <span>$\tilde{f}_{ab}$</span> is introduced to the pressure gradient force <span>$f_{ab}$</span> between particles <span>$a$</span> and <span>$b$</span>:</p><p class="math-container">\[\tilde{f}_{ab} = m_a m_b \frac{(\mu_a + \mu_b)\, r_{ab} \cdot \nabla W_{ab}}{\rho_a \rho_b (\Vert r_{ab} \Vert^2 + \epsilon h^2)}\, v_{ab},\]</p><p>where:</p><ul><li><span>$\mu_a = \rho_a \nu$</span> and <span>$\mu_b = \rho_b \nu$</span> represent the dynamic viscosities of particles <span>$a$</span>and <span>$b$</span> (with <span>$\nu$</span> being the kinematic viscosity),</li><li><span>$r_{ab} = r_a - r_b$</span> represents the difference of the coordinate vectors,</li><li><span>$v_{ab} = v_a - v_b$</span> represents the relative velocity between particles.</li><li><span>$h$</span> is the smoothing length,</li><li><span>$\nabla W_{ab}$</span> is the gradient of the smoothing kernel,</li><li><span>$\epsilon$</span> is a small parameter to prevent singularities.</li></ul><h4 id="ViscosityAdami"><a class="docs-heading-anchor" href="#ViscosityAdami">ViscosityAdami</a><a id="ViscosityAdami-1"></a><a class="docs-heading-anchor-permalink" href="#ViscosityAdami" title="Permalink"></a></h4><p><code>ViscosityAdami</code>, introduced by <a href="../../references/#Adami2012">Adami (2012)</a>, is optimized for incompressible or weakly compressible flows where precise modeling of shear stress is critical. It enhances boundary layer representation by better resolving shear gradients, increasing dissipation in regions with steep velocity differences (e.g., near solid boundaries) while minimizing compressibility effects. This results in accurate laminar flow simulations and accurate physical shear stresses.</p><h5 id="Mathematical-Formulation-3"><a class="docs-heading-anchor" href="#Mathematical-Formulation-3">Mathematical Formulation</a><a class="docs-heading-anchor-permalink" href="#Mathematical-Formulation-3" title="Permalink"></a></h5><p>The viscous interaction is modeled through a shear force for incompressible flows:</p><p class="math-container">\[f_{ab} = \sum_w \bar{\eta}_{ab} \left( V_a^2 + V_b^2 \right) \frac{v_{ab}}{||r_{ab}||^2 + \epsilon h_{ab}^2} \, (\nabla W_{ab} \cdot r_{ab}),\]</p><p>where:</p><ul><li><span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinate vectors,</li><li><span>$v_{ab} = v_a - v_b$</span> is their relative velocity,</li><li><span>$V_a = m_a / \rho_a$</span> and <span>$V_b = m_b / \rho_b$</span> are the particle volumes,</li><li><span>$h_{ab}$</span> is the smoothing length,</li><li><span>$\nabla W_{ab}$</span> is the gradient of the smoothing kernel,</li><li><span>$\epsilon$</span> is a small parameter that prevents singularities (see <a href="../../references/#Ramachandran2019">Ramachandran (2019)</a>).</li></ul><p>The inter-particle-averaged shear stress is defined as:</p><p class="math-container">\[\bar{\eta}_{ab} = \frac{2 \eta_a \eta_b}{\eta_a + \eta_b},\]</p><p>with the dynamic viscosity of each particle given by <span>$\eta_a = \rho_a \nu_a$</span>, where <span>$\nu_a$</span> is the kinematic viscosity.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ArtificialViscosityMonaghan" href="#TrixiParticles.ArtificialViscosityMonaghan"><code>TrixiParticles.ArtificialViscosityMonaghan</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ArtificialViscosityMonaghan(; alpha, beta=0.0, epsilon=0.01)</code></pre><p>Artificial viscosity by Monaghan ([<a href="../../references/#Monaghan1992">11</a>], [<a href="../../references/#Monaghan1989">12</a>]).</p><p>See <a href="#viscosity_sph"><code>Viscosity</code></a> for an overview and comparison of implemented viscosity models.</p><p><strong>Keywords</strong></p><ul><li><code>alpha</code>: A value of <code>0.02</code> is usually used for most simulations. For a relation with the          kinematic viscosity, see description above.</li><li><code>beta=0.0</code>: A value of <code>0.0</code> works well for most fluid simulations and simulations             with shocks of moderate strength. In simulations where the Mach number can be             very high, eg. astrophysical calculation, good results can be obtained by             choosing a value of <code>beta=2.0</code> and <code>alpha=1.0</code>.</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/viscosity.jl#L32-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityAdami" href="#TrixiParticles.ViscosityAdami"><code>TrixiParticles.ViscosityAdami</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityAdami(; nu, epsilon=0.01)</code></pre><p>Viscosity by <a href="../../references/#Adami2012">Adami (2012)</a>.</p><p>See <a href="#viscosity_sph"><code>Viscosity</code></a> for an overview and comparison of implemented viscosity models.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>: Kinematic viscosity</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/viscosity.jl#L159-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityAdamiSGS" href="#TrixiParticles.ViscosityAdamiSGS"><code>TrixiParticles.ViscosityAdamiSGS</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityAdamiSGS(; nu, C_S=0.1, epsilon=0.01)</code></pre><p>Viscosity model that extends the standard <a href="#ViscosityAdami">Adami formulation</a> by incorporating a subgrid-scale (SGS) eddy viscosity via a Smagorinsky-type <a href="../../references/#Smagorinsky1963">Smagorinsky (1963)</a> closure. The effective kinematic viscosity is defined as</p><p class="math-container">\[\nu_{\text{eff}} = \nu_{\text{std}} + \nu_{\text{SGS}},\]</p><p>with</p><p class="math-container">\[\nu_{\text{SGS}} = (C_S h)^2 |S|,\]</p><p>and an approximation for the strain rate magnitude given by</p><p class="math-container">\[|S| \approx \frac{\|v_{ab}\|}{\|r_{ab}\| + \epsilon},\]</p><p>where:</p><ul><li><span>$C_S$</span> is the Smagorinsky constant (typically 0.1 to 0.2),</li><li><span>$h$</span> is the local smoothing length.</li></ul><p>The effective dynamic viscosities are then computed as</p><p class="math-container">\[\eta_{a,\text{eff}} = \rho_a\, \nu_{\text{eff}},\]</p><p>and averaged as</p><p class="math-container">\[\bar{\eta}_{ab} = \frac{2 \eta_{a,\text{eff}} \eta_{b,\text{eff}}}{\eta_{a,\text{eff}}+\eta_{b,\text{eff}}}.\]</p><p>This model is appropriate for turbulent flows where unresolved scales contribute additional dissipation.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>:      Standard kinematic viscosity.</li><li><code>C_S</code>:     Smagorinsky constant.</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/viscosity.jl#L240-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityMorris" href="#TrixiParticles.ViscosityMorris"><code>TrixiParticles.ViscosityMorris</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityMorris(; nu, epsilon=0.01)</code></pre><p>Viscosity by <a href="../../references/#Morris1997">Morris (1997)</a> also used by <a href="../../references/#Fourtakas2019">Fourtakas (2019)</a>.</p><p>See <a href="#viscosity_sph"><code>Viscosity</code></a> for an overview and comparison of implemented viscosity models.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>: Kinematic viscosity</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/viscosity.jl#L58-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityMorrisSGS" href="#TrixiParticles.ViscosityMorrisSGS"><code>TrixiParticles.ViscosityMorrisSGS</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityMorrisSGS(; nu, C_S=0.1, epsilon=0.001)</code></pre><p>Subgrid-scale (SGS) viscosity model based on the formulation by <a href="../../references/#Morris1997">Morris (1997)</a>, by incorporating a subgrid-scale (SGS) eddy viscosity via a Smagorinsky-type <a href="../../references/#Smagorinsky1963">Smagorinsky (1963)</a> closure. The effective kinematic viscosity is defined as</p><p class="math-container">\[\nu_{\text{eff}} = \nu_{\text{std}} + \nu_{\text{SGS}},\]</p><p>with</p><p class="math-container">\[\nu_{\text{SGS}} = (C_S h)^2 |S|,\]</p><p>and an approximation for the strain rate magnitude given by</p><p class="math-container">\[|S| \approx \frac{\|v_{ab}\|}{\|r_{ab}\| + \epsilon},\]</p><p>where:</p><ul><li><span>$C_S$</span> is the Smagorinsky constant (typically 0.1 to 0.2),</li><li><span>$h$</span> is the local smoothing length.</li></ul><p>The effective dynamic viscosities are then computed as</p><p class="math-container">\[\eta_{a,\text{eff}} = \rho_a\, \nu_{\text{eff}},\]</p><p>and averaged as</p><p class="math-container">\[\bar{\eta}_{ab} = \frac{2 \eta_{a,\text{eff}} \eta_{b,\text{eff}}}{\eta_{a,\text{eff}}+\eta_{b,\text{eff}}}.\]</p><p>This model is appropriate for turbulent flows where unresolved scales contribute additional dissipation.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>:      Standard kinematic viscosity.</li><li><code>C_S</code>:     Smagorinsky constant.</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/viscosity.jl#L352-L394">source</a></section></article><h2 id="corrections"><a class="docs-heading-anchor" href="#corrections">Corrections</a><a id="corrections-1"></a><a class="docs-heading-anchor-permalink" href="#corrections" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.AkinciFreeSurfaceCorrection" href="#TrixiParticles.AkinciFreeSurfaceCorrection"><code>TrixiParticles.AkinciFreeSurfaceCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AkinciFreeSurfaceCorrection(rho0)</code></pre><p>Free surface correction according to <a href="../../references/#Akinci2013">Akinci et al. (2013)</a>. At a free surface, the mean density is typically lower than the reference density, resulting in reduced surface tension and viscosity forces. The free surface correction adjusts the viscosity, pressure, and surface tension forces near free surfaces to counter this effect. It&#39;s important to note that this correlation is unphysical and serves as an approximation. The computation time added by this method is about 2–3%.</p><p>Mathematically the idea is quite simple. If we have an SPH particle in the middle of a volume at rest, its density will be identical to the rest density <span>$\rho_0$</span>. If we now consider an SPH particle at a free surface at rest, it will have neighbors missing in the direction normal to the surface, which will result in a lower density. If we calculate the correction factor</p><p class="math-container">\[k = \rho_0/\rho_\text{mean},\]</p><p>this value will be about ~1.5 for particles at the free surface and can then be used to increase the pressure and viscosity accordingly.</p><p><strong>Arguments</strong></p><ul><li><code>rho0</code>: Rest density.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/general/corrections.jl#L2-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BlendedGradientCorrection" href="#TrixiParticles.BlendedGradientCorrection"><code>TrixiParticles.BlendedGradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BlendedGradientCorrection()</code></pre><p>Calculate a blended gradient to reduce the stability issues of the <a href="#TrixiParticles.GradientCorrection"><code>GradientCorrection</code></a> as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>.</p><p>This calculates the following,</p><p class="math-container">\[\tilde\nabla A_i = (1-\lambda) \nabla A_i + \lambda L_i \nabla A_i\]</p><p>with <span>$0 \leq \lambda \leq 1$</span> being the blending factor.</p><p><strong>Arguments</strong></p><ul><li><code>blending_factor</code>: Blending factor between corrected and regular SPH gradient.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/general/corrections.jl#L276-L290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.GradientCorrection" href="#TrixiParticles.GradientCorrection"><code>TrixiParticles.GradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GradientCorrection()</code></pre><p>Compute the corrected gradient of particle interactions based on their relative positions (see <a href="../../references/#Bonet1999">Bonet, 1999</a>).</p><p><strong>Mathematical Details</strong></p><p>Given the standard SPH representation, the gradient of a field <span>$A$</span> at particle <span>$a$</span> is given by</p><p class="math-container">\[\nabla A_a = \sum_b m_b \frac{A_b - A_a}{\rho_b} \nabla_{r_a} W(\Vert r_a - r_b \Vert, h),\]</p><p>where <span>$m_b$</span> is the mass of particle <span>$b$</span> and <span>$\rho_b$</span> is the density of particle <span>$b$</span>.</p><p>The gradient correction, as commonly proposed, involves multiplying this gradient with a correction matrix <span>$L$</span>:</p><p class="math-container">\[\tilde{\nabla} A_a = \bm{L}_a \nabla A_a\]</p><p>The correction matrix  <span>$\bm{L}_a$</span> is computed based on the provided particle configuration, aiming to make the corrected gradient more accurate, especially near domain boundaries.</p><p>To satisfy</p><p class="math-container">\[\sum_b V_b r_{ba} \otimes \tilde{\nabla}W_b(r_a) = \left( \sum_b V_b r_{ba} \otimes \nabla W_b(r_a) \right) \bm{L}_a^T = \bm{I}\]</p><p>the correction matrix <span>$\bm{L}_a$</span> is evaluated explicitly as</p><p class="math-container">\[\bm{L}_a = \left( \sum_b V_b \nabla W_b(r_{a}) \otimes r_{ba} \right)^{-1}.\]</p><div class="admonition is-info" id="Note-140ac60a5b80288e"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-140ac60a5b80288e" title="Permalink"></a></header><div class="admonition-body"><ul><li>Stability issues arise, especially when particles separate into small clusters.</li><li>Doubles the computational effort.</li><li>Better stability with smoother smoothing Kernels with larger support, e.g. <a href="../../general/smoothing_kernels/#TrixiParticles.SchoenbergQuinticSplineKernel"><code>SchoenbergQuinticSplineKernel</code></a> or <a href="../../general/smoothing_kernels/#TrixiParticles.WendlandC6Kernel"><code>WendlandC6Kernel</code></a>.</li><li>Set <code>dt_max =&lt; 1e-3</code> for stability.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/general/corrections.jl#L234-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.KernelCorrection" href="#TrixiParticles.KernelCorrection"><code>TrixiParticles.KernelCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KernelCorrection()</code></pre><p>Kernel correction, as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>, uses Shepard interpolation to obtain a 0-th order accurate result, which was first proposed by Li et al. This can be further extended to obtain a kernel corrected gradient as shown by <a href="../../references/#Basa2008">Basa et al. (2008)</a>.</p><p>The kernel correction coefficient is determined by</p><p class="math-container">\[c(x) = \sum_{b=1} V_b W_b(x)\]</p><p>The gradient of corrected kernel is determined by</p><p class="math-container">\[\nabla \tilde{W}_{b}(r) =\frac{\nabla W_{b}(r) - W_b(r) \gamma(r)}{\sum_{b=1} V_b W_b(r)} , \quad  \text{where} \quad
\gamma(r) = \frac{\sum_{b=1} V_b \nabla W_b(r)}{\sum_{b=1} V_b W_b(r)}.\]</p><p>This correction can be applied with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> and <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a>, which leads to an improvement, especially at free surfaces.</p><div class="admonition is-info" id="Note-839f621a983cfbd6"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-839f621a983cfbd6" title="Permalink"></a></header><div class="admonition-body"><ul><li>This only works when the boundary model uses <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> (yet).</li><li>It is also referred to as &quot;0th order correction&quot;.</li><li>In 2D, we can expect an increase of about 10–15% in computation time.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/general/corrections.jl#L71-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.MixedKernelGradientCorrection" href="#TrixiParticles.MixedKernelGradientCorrection"><code>TrixiParticles.MixedKernelGradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MixedKernelGradientCorrection()</code></pre><p>Combines <a href="#TrixiParticles.GradientCorrection"><code>GradientCorrection</code></a> and <a href="#TrixiParticles.KernelCorrection"><code>KernelCorrection</code></a>, which results in a 1st-order-accurate SPH method (see <a href="../../references/#Bonet1999">Bonet, 1999</a>).</p><p><strong>Notes:</strong></p><ul><li>Stability issues, especially when particles separate into small clusters.</li><li>Doubles the computational effort.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/general/corrections.jl#L98-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ShepardKernelCorrection" href="#TrixiParticles.ShepardKernelCorrection"><code>TrixiParticles.ShepardKernelCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShepardKernelCorrection()</code></pre><p>Kernel correction, as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>, uses Shepard interpolation to obtain a 0-th order accurate result, which was first proposed by <a href="../../references/#Li1996">Li et al. (1996)</a>.</p><p>The kernel correction coefficient is determined by</p><p class="math-container">\[c(x) = \sum_{b=1} V_b W_b(x),\]</p><p>where <span>$V_b = m_b / \rho_b$</span> is the volume of particle <span>$b$</span>.</p><p>This correction is applied with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> to correct the density and leads to an improvement, especially at free surfaces.</p><div class="admonition is-info" id="Note-d4706b112115485e"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d4706b112115485e" title="Permalink"></a></header><div class="admonition-body"><ul><li>It is also referred to as &quot;0th order correction&quot;.</li><li>In 2D, we can expect an increase of about 5–6% in computation time.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/general/corrections.jl#L50-L68">source</a></section></article><hr/><h2 id="surface_normal"><a class="docs-heading-anchor" href="#surface_normal">Surface Normals</a><a id="surface_normal-1"></a><a class="docs-heading-anchor-permalink" href="#surface_normal" title="Permalink"></a></h2><h3 id="Overview-of-surface-normal-calculation-in-SPH"><a class="docs-heading-anchor" href="#Overview-of-surface-normal-calculation-in-SPH">Overview of surface normal calculation in SPH</a><a id="Overview-of-surface-normal-calculation-in-SPH-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-surface-normal-calculation-in-SPH" title="Permalink"></a></h3><p>Surface normals are essential for modeling surface tension as they provide the directionality of forces acting at the fluid interface. They are calculated based on the particle properties and their spatial distribution.</p><h4 id="Color-field-and-gradient-based-surface-normals"><a class="docs-heading-anchor" href="#Color-field-and-gradient-based-surface-normals">Color field and gradient-based surface normals</a><a id="Color-field-and-gradient-based-surface-normals-1"></a><a class="docs-heading-anchor-permalink" href="#Color-field-and-gradient-based-surface-normals" title="Permalink"></a></h4><p>The surface normal at a particle is derived from the color field, a scalar field assigned to particles to distinguish between different fluid phases or between fluid and air. The color field gradients point towards the interface, and the normalized gradient defines the surface normal direction.</p><p>The simplest SPH formulation for a surface normal, <span>$n_a$</span> is given as</p><p class="math-container">\[n_a = \sum_b m_b \frac{c_b}{\rho_b} \nabla_a W_{ab},\]</p><p>where:</p><ul><li><span>$c_b$</span> is the color field value for particle <span>$b$</span>,</li><li><span>$m_b$</span> is the mass of particle <span>$b$</span>,</li><li><span>$\rho_b$</span> is the density of particle <span>$b$</span>,</li><li><span>$\nabla_a W_{ab}$</span> is the gradient of the smoothing kernel <span>$W_{ab}$</span> with respect to particle <span>$a$</span>.</li></ul><h4 id="Normalization-of-surface-normals"><a class="docs-heading-anchor" href="#Normalization-of-surface-normals">Normalization of surface normals</a><a id="Normalization-of-surface-normals-1"></a><a class="docs-heading-anchor-permalink" href="#Normalization-of-surface-normals" title="Permalink"></a></h4><p>The calculated normals are normalized to unit vectors:</p><p class="math-container">\[\hat{n}_a = \frac{n_a}{\Vert n_a \Vert}.\]</p><p>Normalization ensures that the magnitude of the normals does not bias the curvature calculations or the resulting surface tension forces.</p><h4 id="Handling-noise-and-errors-in-normal-calculation"><a class="docs-heading-anchor" href="#Handling-noise-and-errors-in-normal-calculation">Handling noise and errors in normal calculation</a><a id="Handling-noise-and-errors-in-normal-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-noise-and-errors-in-normal-calculation" title="Permalink"></a></h4><p>In regions distant from the interface, the calculated normals may be small or inaccurate due to the smoothing kernel&#39;s support radius. To mitigate this:</p><ol><li>Normals below a threshold are excluded from further calculations.</li><li>Curvature calculations use a corrected formulation to reduce errors near interface fringes.</li></ol><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ColorfieldSurfaceNormal" href="#TrixiParticles.ColorfieldSurfaceNormal"><code>TrixiParticles.ColorfieldSurfaceNormal</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ColorfieldSurfaceNormal(; boundary_contact_threshold=0.1, interface_threshold=0.01,
                          ideal_density_threshold=0.0)</code></pre><p>Color field based computation of the interface normals.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>boundary_contact_threshold=0.1</code>: If this threshold is reached the fluid is assumed to be in contact with the boundary.</li><li><code>interface_threshold=0.01</code>:       Threshold for normals to be removed as being invalid.</li><li><code>ideal_density_threshold=0.0</code>:    Assume particles are inside if they are above this threshold, which is relative to the <code>ideal_neighbor_count</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/surface_normal_sph.jl#L1-L11">source</a></section></article><hr/><h2 id="surface_tension"><a class="docs-heading-anchor" href="#surface_tension">Surface Tension</a><a id="surface_tension-1"></a><a class="docs-heading-anchor-permalink" href="#surface_tension" title="Permalink"></a></h2><p>Surface tension is a key phenomenon in fluid dynamics, influencing the behavior of droplets, bubbles, and fluid interfaces. In SPH, surface tension is modeled as forces arising due to surface curvature and relative particle movement, ensuring realistic simulation of capillary effects, droplet coalescence, and fragmentation.</p><p>The surface tension coefficient <span>$\sigma$</span> is a physical parameter that quantifies the energy required to increase the surface area of a fluid by a unit amount. A higher value of <span>$\sigma$</span> indicates that the fluid resists changes to its surface area more strongly, causing droplets or bubbles to assume shapes (often spherical) that minimize their surface. In practice, <span>$\sigma$</span> can be measured experimentally through techniques such as the pendant drop method, the Wilhelmy plate method, or the du Noüy ring method, each of which relates a measurable force or change in shape to the fluid’s surface tension. For pure substances, tabulated reference values of <span>$\sigma$</span> at given temperatures are commonly used, while for mixtures or complex fluids, direct experimental measurements or values can be estimated from empirical equation (see <a href="../../references/#Poling2001">Poling</a> or <a href="../../references/#Lange2005">Lange</a>). In the following table some values are shown for reference. The values marked with a &#39;~&#39; are complex mixtures that are estimated by an empirical equation (see <a href="../../references/#Poling2001">Poling</a>).</p><table><tr><th style="text-align: right"><strong>Fluid</strong></th><th style="text-align: right"><strong>Surface Tension (<span>$\sigma$</span>) [N/m at 20°C]</strong></th></tr><tr><td style="text-align: right"><strong>Gasoline</strong></td><td style="text-align: right">~0.022   <a href="../../references/#Poling2001">Poling</a></td></tr><tr><td style="text-align: right"><strong>Ethanol</strong></td><td style="text-align: right">0.022386 <a href="../../references/#Lange2005">Lange</a></td></tr><tr><td style="text-align: right"><strong>Acetone</strong></td><td style="text-align: right">0.02402  <a href="../../references/#Lange2005">Lange</a></td></tr><tr><td style="text-align: right"><strong>Mineral Oil</strong></td><td style="text-align: right">~0.030   <a href="../../references/#Poling2001">Poling</a></td></tr><tr><td style="text-align: right"><strong>Olive Oil</strong></td><td style="text-align: right">0.03303  <a href="../../references/#Hui1992">Hui</a>, <a href="../../references/#MeloEspinosa2014">MeloEspinosa</a></td></tr><tr><td style="text-align: right"><strong>Glycerol</strong></td><td style="text-align: right">0.06314  <a href="../../references/#Lange2005">Lange</a></td></tr><tr><td style="text-align: right"><strong>Water</strong></td><td style="text-align: right">0.07288  <a href="../../references/#Lange2005">Lange</a></td></tr><tr><td style="text-align: right"><strong>Mercury</strong></td><td style="text-align: right">0.486502 <a href="../../references/#Lange2005">Lange</a></td></tr></table><h3 id="akinci_ipf"><a class="docs-heading-anchor" href="#akinci_ipf">Akinci-based intra-particle force surface tension and wall adhesion model</a><a id="akinci_ipf-1"></a><a class="docs-heading-anchor-permalink" href="#akinci_ipf" title="Permalink"></a></h3><p>The <a href="../../references/#Akinci2013">Akinci</a> model divides surface tension into distinct force components:</p><h4 id="Cohesion-force"><a class="docs-heading-anchor" href="#Cohesion-force">Cohesion force</a><a id="Cohesion-force-1"></a><a class="docs-heading-anchor-permalink" href="#Cohesion-force" title="Permalink"></a></h4><p>The cohesion force captures the attraction between particles at the fluid interface, creating the effect of surface tension. It is defined by the distance between particles and the support radius <span>$h_c$</span>, using a kernel-based formulation.</p><p><strong>Key features:</strong></p><ul><li>Particles within half the support radius experience a repulsive force to prevent clustering.</li><li>Particles beyond half the radius but within the support radius experience an attractive force to simulate cohesion.</li></ul><p>Mathematically:</p><p class="math-container">\[F_{\text{cohesion}} = -\sigma m_b C(r) \frac{r}{\Vert r \Vert},\]</p><p>where <span>$C(r)$</span>, the cohesion kernel, is defined as:</p><p class="math-container">\[C(r)=\frac{32}{\pi h_c^9}
\begin{cases}
(h_c-r)^3 r^3, &amp; \text{if } 2r &gt; h_c, \\
2(h_c-r)^3 r^3 - \frac{h^6}{64}, &amp; \text{if } r &gt; 0 \text{ and } 2r \leq h_c, \\
0, &amp; \text{otherwise.}
\end{cases}\]</p><h4 id="Surface-area-minimization-force"><a class="docs-heading-anchor" href="#Surface-area-minimization-force">Surface area minimization force</a><a id="Surface-area-minimization-force-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-area-minimization-force" title="Permalink"></a></h4><p>The surface area minimization force models the curvature reduction effects, aligning particle motion to reduce the interface&#39;s total area. It acts based on the difference in surface normals:</p><p class="math-container">\[F_{\text{curvature}} = -\sigma (n_a - n_b),\]</p><p>where <span>$n_a$</span> and <span>$n_b$</span> are the surface normals of the interacting particles.</p><h4 id="Wall-adhesion-force"><a class="docs-heading-anchor" href="#Wall-adhesion-force">Wall adhesion force</a><a id="Wall-adhesion-force-1"></a><a class="docs-heading-anchor-permalink" href="#Wall-adhesion-force" title="Permalink"></a></h4><p>This force models the interaction between fluid and solid boundaries, simulating adhesion effects at walls. It uses a custom kernel with a peak at 0.75 times the support radius:</p><p class="math-container">\[F_{\text{adhesion}} = -\beta m_b A(r) \frac{r}{\Vert r \Vert},\]</p><p>where <span>$A(r)$</span> is the adhesion kernel:</p><p class="math-container">\[A(r) = \frac{0.007}{h_c^{3.25}}
\begin{cases}
\sqrt[4]{-\frac{4r^2}{h_c} + 6r - 2h_c}, &amp; \text{if } 2r &gt; h_c \text{ and } r \leq h_c, \\
0, &amp; \text{otherwise.}
\end{cases}\]</p><hr/><h3 id="morris_csf"><a class="docs-heading-anchor" href="#morris_csf">Morris surface tension model</a><a id="morris_csf-1"></a><a class="docs-heading-anchor-permalink" href="#morris_csf" title="Permalink"></a></h3><p>The method described by <a href="../../references/#Morris2000">Morris</a> estimates curvature by combining particle color gradients (see <a href="#surface_normal"><code>surface_normal</code></a>) and smoothing functions to derive surface normals. The computed curvature is then used to determine forces acting perpendicular to the interface. While this method provides accurate surface tension forces, it does not explicitly conserve momentum.</p><p>In the Morris model, surface tension is computed based on local interface curvature <span>$\kappa$</span> and the unit surface normal <span>$\hat{n}.$</span> By estimating <span>$\hat{n}$</span> and <span>$\kappa$</span> at each particle near the interface, the surface tension force for particle a can be written as:</p><p class="math-container">\[F_{\text{surface tension}} = - \sigma \frac{\kappa_a}{\rho_a}\hat{n}_a\]</p><p>This formulation focuses directly on geometric properties of the interface, making it relatively straightforward to implement when a reliable interface detection (e.g., a color function) is available. However, accurately estimating <span>$\kappa$</span> and <span>$n$</span> may require fine resolutions.</p><hr/><h3 id="moriss_css"><a class="docs-heading-anchor" href="#moriss_css">Morris-based momentum-conserving surface tension model</a><a id="moriss_css-1"></a><a class="docs-heading-anchor-permalink" href="#moriss_css" title="Permalink"></a></h3><p>In addition to the simpler curvature-based formulation, <a href="../../references/#Morris2000">Morris</a> introduced a momentum-conserving approach. This method treats surface tension forces as arising from the divergence of a stress tensor, ensuring exact conservation of linear momentum and offering more robust behavior for high-resolution or long-duration simulations where accumulated numerical error can be significant.</p><h4 id="Stress-tensor-formulation"><a class="docs-heading-anchor" href="#Stress-tensor-formulation">Stress tensor formulation</a><a id="Stress-tensor-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Stress-tensor-formulation" title="Permalink"></a></h4><p>The surface tension force can be seen as a divergence of a stress tensor <span>$S$</span></p><p class="math-container">\[F_{\text{surface tension}} = \nabla \cdot S,\]</p><p>with <span>$S$</span> defined as</p><p class="math-container">\[S = \sigma \delta_s (I - \hat{n} \otimes \hat{n}),\]</p><p>with:</p><ul><li><span>$\delta_s$</span>: Surface delta function,</li><li><span>$\hat{n}$</span>: Unit normal vector,</li><li><span>$I$</span>: Identity matrix.</li></ul><p>This divergence can be computed numerically in the SPH framework as</p><p class="math-container">\[\sum_b \frac{m_b}{\rho_a \rho_b} (S_a + S_b) \nabla W_{ab}\]</p><h4 id="Advantages-and-limitations"><a class="docs-heading-anchor" href="#Advantages-and-limitations">Advantages and limitations</a><a id="Advantages-and-limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Advantages-and-limitations" title="Permalink"></a></h4><p>While momentum conservation makes this model attractive, it requires additional computational effort and stabilization techniques to address instabilities in high-density regions.</p><h3 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.CohesionForceAkinci" href="#TrixiParticles.CohesionForceAkinci"><code>TrixiParticles.CohesionForceAkinci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CohesionForceAkinci(surface_tension_coefficient=1.0)</code></pre><p>This model only implements the cohesion force of the Akinci [<a href="../../references/#Akinci2013">19</a>] surface tension model.</p><p>See <a href="#surface_tension"><code>surface_tension</code></a> for more details.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: Modifies the intensity of the surface tension-induced force,  enabling the tuning of the fluid&#39;s surface tension properties within the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/surface_tension.jl#L4-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SurfaceTensionAkinci" href="#TrixiParticles.SurfaceTensionAkinci"><code>TrixiParticles.SurfaceTensionAkinci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceTensionAkinci(surface_tension_coefficient=1.0)</code></pre><p>Implements a model for surface tension and adhesion effects drawing upon the principles outlined by Akinci [<a href="../../references/#Akinci2013">19</a>]. This model is instrumental in capturing the nuanced behaviors of fluid surfaces, such as droplet formation and the dynamics of merging or separation, by utilizing intra-particle forces.</p><p>See <a href="#surface_tension"><code>surface_tension</code></a> for more details.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: A parameter to adjust the magnitude of  surface tension forces, facilitating the fine-tuning of how surface tension phenomena  are represented in the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/surface_tension.jl#L23-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SurfaceTensionMomentumMorris" href="#TrixiParticles.SurfaceTensionMomentumMorris"><code>TrixiParticles.SurfaceTensionMomentumMorris</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceTensionMomentumMorris(surface_tension_coefficient=1.0)</code></pre><p>This model implements the momentum-conserving surface tension approach outlined by Morris [<a href="../../references/#Morris2000">27</a>]. It calculates surface tension forces using the divergence of a stress tensor, ensuring exact conservation of linear momentum. This method is particularly useful for simulations where momentum conservation is critical, though it may require numerical adjustments at higher resolutions.</p><p>See <a href="#surface_tension"><code>surface_tension</code></a> for more details.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: A parameter to adjust the strength of surface tension  forces, allowing fine-tuning to replicate physical behavior.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/surface_tension.jl#L78-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SurfaceTensionMorris" href="#TrixiParticles.SurfaceTensionMorris"><code>TrixiParticles.SurfaceTensionMorris</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceTensionMorris(surface_tension_coefficient=1.0)</code></pre><p>This model implements the surface tension approach described by Morris [<a href="../../references/#Morris2000">27</a>]. It calculates surface tension forces based on the curvature of the fluid interface using particle normals and their divergence, making it suitable for simulating phenomena like droplet formation and capillary wave dynamics.</p><p>See <a href="#surface_tension"><code>surface_tension</code></a> for more details.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: Adjusts the magnitude of the surface tension  forces, enabling tuning of fluid surface behaviors in simulations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/ee159f37c8211c1ac2ffb4fcfbbcbc9e8b119406/src/schemes/fluid/surface_tension.jl#L46-L60">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../general/util/">« Util</a><a class="docs-footer-nextpage" href="../weakly_compressible_sph/">Weakly Compressible SPH (Fluid) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 26 August 2025 08:04">Tuesday 26 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
