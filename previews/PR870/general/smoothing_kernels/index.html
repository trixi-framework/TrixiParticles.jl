<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Smoothing Kernels · TrixiParticles.jl</title><meta name="title" content="Smoothing Kernels · TrixiParticles.jl"/><meta property="og:title" content="Smoothing Kernels · TrixiParticles.jl"/><meta property="twitter:title" content="Smoothing Kernels · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.js"></script><link href="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li><a class="tocitem" href="../../preprocessing/preprocessing/">Sampling of Geometries</a></li></ul></li><li><a class="tocitem" href="../../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox" checked/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../interpolation/">Interpolation</a></li><li><a class="tocitem" href="../density_calculators/">Density Calculators</a></li><li class="is-active"><a class="tocitem" href>Smoothing Kernels</a></li><li><a class="tocitem" href="../neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-11-3-1" type="checkbox"/><label class="tocitem" for="menuitem-11-3-1"><span class="docs-label">Fluid Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../systems/fluid/">Overview</a></li><li><a class="tocitem" href="../../systems/weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../../systems/entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li></ul></li><li><a class="tocitem" href="../../systems/dem/">Discrete Element Method (Solid)</a></li><li><a class="tocitem" href="../../systems/total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../../systems/boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li><li><a class="tocitem" href="../../reference-pointneighbors/">PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li><a class="is-disabled">General</a></li><li class="is-active"><a href>Smoothing Kernels</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Smoothing Kernels</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/general/smoothing_kernels.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="smoothing_kernel"><a class="docs-heading-anchor" href="#smoothing_kernel">Smoothing Kernels</a><a id="smoothing_kernel-1"></a><a class="docs-heading-anchor-permalink" href="#smoothing_kernel" title="Permalink"></a></h1><p>The following smoothing kernels are currently available:</p><table><tr><th style="text-align: left">Smoothing Kernel</th><th style="text-align: left">Compact Support</th><th style="text-align: left">Typ. Smoothing Length</th><th style="text-align: left">Recommended Application</th><th style="text-align: left">Stability</th></tr><tr><td style="text-align: left"><a href="#TrixiParticles.SchoenbergCubicSplineKernel"><code>SchoenbergCubicSplineKernel</code></a></td><td style="text-align: left"><span>$[0, 2h]$</span></td><td style="text-align: left"><span>$1.1$</span> to <span>$1.3$</span></td><td style="text-align: left">General + sharp waves</td><td style="text-align: left">++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.SchoenbergQuarticSplineKernel"><code>SchoenbergQuarticSplineKernel</code></a></td><td style="text-align: left"><span>$[0, 2.5h]$</span></td><td style="text-align: left"><span>$1.1$</span> to <span>$1.5$</span></td><td style="text-align: left">General</td><td style="text-align: left">+++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.SchoenbergQuinticSplineKernel"><code>SchoenbergQuinticSplineKernel</code></a></td><td style="text-align: left"><span>$[0, 3h]$</span></td><td style="text-align: left"><span>$1.1$</span> to <span>$1.5$</span></td><td style="text-align: left">General</td><td style="text-align: left">++++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.GaussianKernel"><code>GaussianKernel</code></a></td><td style="text-align: left"><span>$[0, 3h]$</span></td><td style="text-align: left"><span>$1.0$</span> to <span>$1.5$</span></td><td style="text-align: left">Literature</td><td style="text-align: left">+++++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.WendlandC2Kernel"><code>WendlandC2Kernel</code></a></td><td style="text-align: left"><span>$[0, 2h]$</span></td><td style="text-align: left"><span>$1.2$</span> to <span>$2.0$</span></td><td style="text-align: left">General (recommended)</td><td style="text-align: left">++++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.WendlandC4Kernel"><code>WendlandC4Kernel</code></a></td><td style="text-align: left"><span>$[0, 2h]$</span></td><td style="text-align: left"><span>$1.5$</span> to <span>$2.3$</span></td><td style="text-align: left">General</td><td style="text-align: left">+++++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.WendlandC6Kernel"><code>WendlandC6Kernel</code></a></td><td style="text-align: left"><span>$[0, 2h]$</span></td><td style="text-align: left"><span>$1.7$</span> to <span>$2.5$</span></td><td style="text-align: left">General</td><td style="text-align: left">+++++</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.Poly6Kernel"><code>Poly6Kernel</code></a></td><td style="text-align: left"><span>$[0, 1h]$</span></td><td style="text-align: left"><span>$1.5$</span> to <span>$2.5$</span></td><td style="text-align: left">Literature</td><td style="text-align: left">+</td></tr><tr><td style="text-align: left"><a href="#TrixiParticles.SpikyKernel"><code>SpikyKernel</code></a></td><td style="text-align: left"><span>$[0, 1h]$</span></td><td style="text-align: left"><span>$1.5$</span> to <span>$3.0$</span></td><td style="text-align: left">Sharp corners + waves</td><td style="text-align: left">+</td></tr></table><p>We recommend to use the <a href="#TrixiParticles.WendlandC2Kernel"><code>WendlandC2Kernel</code></a> for most applications. If less smoothing is needed, try <a href="#TrixiParticles.SchoenbergCubicSplineKernel"><code>SchoenbergCubicSplineKernel</code></a>, for more smoothing try <a href="#TrixiParticles.WendlandC6Kernel"><code>WendlandC6Kernel</code></a>.</p><div class="admonition is-info" id="Usage-d48115b3bd724171"><header class="admonition-header">Usage<a class="admonition-anchor" href="#Usage-d48115b3bd724171" title="Permalink"></a></header><div class="admonition-body"><p>The kernel can be called as</p><pre><code class="nohighlight hljs">TrixiParticles.kernel(smoothing_kernel, r, h)</code></pre><p>The length of the compact support can be obtained as</p><pre><code class="nohighlight hljs">TrixiParticles.compact_support(smoothing_kernel, h)</code></pre><p>Note that <span>$r$</span> has to be a scalar, so in the context of SPH, the kernel should be used as</p><p class="math-container">\[W(\Vert r_a - r_b \Vert, h).\]</p><p>The gradient required in SPH,</p><p class="math-container">\[    \nabla_{r_a} W(\Vert r_a - r_b \Vert, h)\]</p><p>can be called as</p><pre><code class="nohighlight hljs">TrixiParticles.kernel_grad(smoothing_kernel, pos_diff, distance, h)</code></pre><p>where <code>pos_diff</code> is <span>$r_a - r_b$</span> and <code>distance</code> is <span>$\Vert r_a - r_b \Vert$</span>.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.GaussianKernel" href="#TrixiParticles.GaussianKernel"><code>TrixiParticles.GaussianKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GaussianKernel{NDIMS}()</code></pre><p>Gaussian kernel given by</p><p class="math-container">\[W(r, h) = \frac{\sigma_d}{h^d} e^{-r^2/h^2}\]</p><p>where <span>$d$</span> is the number of dimensions and</p><ul><li><span>$\sigma_2 = \frac{1}{\pi}$</span> for 2D,</li><li><span>$\sigma_3 = \frac{1}{\pi^{3/2}}$</span> for 3D.</li></ul><p>This kernel function has an infinite support, but in practice, it&#39;s often truncated at a certain multiple of <span>$h$</span>, such as <span>$3h$</span>.</p><p>In this implementation, the kernel is truncated at <span>$3h$</span>, so this kernel function has a compact support of <span>$[0, 3h]$</span>.</p><p>The smoothing length is typically in the range <span>$[1.0\delta, 1.5\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p><p>Note: This truncation makes this Kernel not conservative, which is beneficial in regards to stability but makes it less accurate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L48-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.Poly6Kernel" href="#TrixiParticles.Poly6Kernel"><code>TrixiParticles.Poly6Kernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Poly6Kernel{NDIMS}()</code></pre><p>Poly6 kernel, a commonly used kernel in SPH literature [<a href="../../references/#Mueller2003">4</a>], especially in computer graphics contexts. It is defined as</p><p class="math-container">\[W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    (1 - q^2)^3    &amp; \text{if } 0 \leq q &lt; 1, \\
    0              &amp; \text{if } q \geq 1,
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization factor that depends on the dimension. The normalization factor <span>$\sigma$</span> is <span>$4 / \pi$</span> in two dimensions or <span>$315 / 64\pi$</span> in three dimensions.</p><p>This kernel function has a compact support of <span>$[0, h]$</span>.</p><p>Poly6 is well-known for its computational simplicity, though it&#39;s worth noting that there are other kernels that might offer better accuracy for hydrodynamic simulations. Furthermore, its derivatives are not that smooth, which can lead to stability problems. It is also susceptible to clumping.</p><p>The smoothing length is typically in the range <span>$[1.5\delta, 2.5\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L544-L579">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SchoenbergCubicSplineKernel" href="#TrixiParticles.SchoenbergCubicSplineKernel"><code>TrixiParticles.SchoenbergCubicSplineKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SchoenbergCubicSplineKernel{NDIMS}()</code></pre><p>Cubic spline kernel by <a href="../../references/#Schoenberg1946">Schoenberg (1946)</a>, given by</p><p class="math-container">\[    W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    \frac{1}{4} (2 - q)^3 - (1 - q)^3   &amp; \text{if } 0 \leq q &lt; 1, \\
    \frac{1}{4} (2 - q)^3               &amp; \text{if } 1 \leq q &lt; 2, \\
    0                                   &amp; \text{if } q \geq 2, \\
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization constant given by <span>$\sigma =[\frac{2}{3}, \frac{10}{7 \pi}, \frac{1}{\pi}]$</span> in <span>$[1, 2, 3]$</span> dimensions.</p><p>This kernel function has a compact support of <span>$[0, 2h]$</span>.</p><p>For an overview of Schoenberg cubic, quartic and quintic spline kernels including normalization factors, see <a href="../../references/#Price2012">Price (2012)</a>. For an analytic formula for higher order Schoenberg kernels, see <a href="../../references/#Monaghan1985">Monaghan (1985)</a>. The largest disadvantage of Schoenberg Spline Kernel is the rather non-smooth first derivative, which can lead to increased noise compared to other kernel variants.</p><p>The smoothing length is typically in the range <span>$[1.1\delta, 1.3\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L105-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SchoenbergQuarticSplineKernel" href="#TrixiParticles.SchoenbergQuarticSplineKernel"><code>TrixiParticles.SchoenbergQuarticSplineKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SchoenbergQuarticSplineKernel{NDIMS}()</code></pre><p>Quartic spline kernel by <a href="../../references/#Schoenberg1946">Schoenberg (1946)</a>, given by</p><p class="math-container">\[    W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    \left(5/2 - q \right)^4 - 5\left(3/2 - q \right)^4
    + 10\left(1/2 - q \right)^4 &amp; \text{if } 0 \leq q &lt; \frac{1}{2}, \\
    \left(5/2 - q \right)^4 - 5\left(3/2 - q \right)^4
    &amp; \text{if } \frac{1}{2} \leq q &lt; \frac{3}{2}, \\
    \left(5/2 - q \right)^4 &amp; \text{if } \frac{3}{2} \leq q &lt; \frac{5}{2}, \\
    0 &amp; \text{if } q \geq \frac{5}{2},
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization constant given by <span>$\sigma =[\frac{1}{24}, \frac{96}{1199 \pi}, \frac{1}{20\pi}]$</span> in <span>$[1, 2, 3]$</span> dimensions.</p><p>This kernel function has a compact support of <span>$[0, 2.5h]$</span>.</p><p>For an overview of Schoenberg cubic, quartic and quintic spline kernels including normalization factors, see <a href="../../references/#Price2012">Price (2012)</a>. For an analytic formula for higher order Schoenberg kernels, see <a href="../../references/#Monaghan1985">Monaghan (1985)</a>.</p><p>The largest disadvantage of Schoenberg Spline Kernel are the rather non-smooth first derivative, which can lead to increased noise compared to other kernel variants.</p><p>The smoothing length is typically in the range <span>$[1.1\delta, 1.5\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L175-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SchoenbergQuinticSplineKernel" href="#TrixiParticles.SchoenbergQuinticSplineKernel"><code>TrixiParticles.SchoenbergQuinticSplineKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SchoenbergQuinticSplineKernel{NDIMS}()</code></pre><p>Quintic spline kernel by <a href="../../references/#Schoenberg1946">Schoenberg (1946)</a>, given by</p><p class="math-container">\[    W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    (3 - q)^5 - 6(2 - q)^5 + 15(1 - q)^5    &amp; \text{if } 0 \leq q &lt; 1, \\
    (3 - q)^5 - 6(2 - q)^5                  &amp; \text{if } 1 \leq q &lt; 2, \\
    (3 - q)^5                               &amp; \text{if } 2 \leq q &lt; 3, \\
    0                                       &amp; \text{if } q \geq 3,
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization constant given by <span>$\sigma =[\frac{1}{120}, \frac{7}{478 \pi}, \frac{1}{120\pi}]$</span> in <span>$[1, 2, 3]$</span> dimensions.</p><p>This kernel function has a compact support of <span>$[0, 3h]$</span>.</p><p>For an overview of Schoenberg cubic, quartic and quintic spline kernels including normalization factors, see <a href="../../references/#Price2012">Price (2012)</a>. For an analytic formula for higher order Schoenberg kernels, see <a href="../../references/#Monaghan1985">Monaghan (1985)</a>.</p><p>The largest disadvantage of Schoenberg Spline Kernel are the rather non-smooth first derivative, which can lead to increased noise compared to other kernel variants.</p><p>The smoothing length is typically in the range <span>$[1.1\delta, 1.5\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L267-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SpikyKernel" href="#TrixiParticles.SpikyKernel"><code>TrixiParticles.SpikyKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpikyKernel{NDIMS}()</code></pre><p>The Spiky kernel is another frequently used kernel in SPH, especially due to its desirable properties in preserving features near boundaries in fluid simulations [<a href="../../references/#Mueller2003">4</a>]. It is defined as:</p><p class="math-container">\[ W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with:</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    (1 - q)^3    &amp; \text{if } 0 \leq q &lt; 1, \\
    0            &amp; \text{if } q \geq 1,
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and the normalization factor <span>$\sigma$</span> is <span>$10 / \pi$</span> in two dimensions or <span>$15 / \pi$</span> in three dimensions.</p><p>This kernel function has a compact support of <span>$[0, h]$</span>.</p><p>The Spiky kernel is particularly known for its sharp gradients, which can help to preserve sharp features in fluid simulations, especially near solid boundaries. These sharp gradients at the boundary are also the largest disadvantage as they can lead to instability.</p><p>The smoothing length is typically in the range <span>$[1.5\delta, 3.0\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L611-L644">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.WendlandC2Kernel" href="#TrixiParticles.WendlandC2Kernel"><code>TrixiParticles.WendlandC2Kernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WendlandC2Kernel{NDIMS}()</code></pre><p>Wendland C2 kernel [<a href="../../references/#Wendland1995">8</a>], a piecewise polynomial function designed to have compact support and to be twice continuously differentiable everywhere. Given by</p><p class="math-container">\[ W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    (1 - q/2)^4 (2q + 1)  &amp; \text{if } 0 \leq q &lt; 2, \\
    0                     &amp; \text{if } q \geq 2,
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization factor dependent on the dimension. The normalization factor <span>$\sigma$</span> is <span>$40/7\pi$</span> in two dimensions or <span>$21/2\pi$</span> in three dimensions.</p><p>This kernel function has a compact support of <span>$[0, 2h]$</span>.</p><p>For a detailed discussion on Wendland functions and their applications in SPH, see <a href="../../references/#Dehnen2012">Dehnen (2012)</a>. The smoothness of these functions is also the largest disadvantage as they lose details at sharp corners.</p><p>The smoothing length is typically in the range <span>$[1.2\delta, 2\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L351-L382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.WendlandC4Kernel" href="#TrixiParticles.WendlandC4Kernel"><code>TrixiParticles.WendlandC4Kernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WendlandC4Kernel{NDIMS}()</code></pre><p>Wendland C4 kernel [<a href="../../references/#Wendland1995">8</a>], a piecewise polynomial function designed to have compact support and to be four times continuously differentiable everywhere. Given by</p><p class="math-container">\[ W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    (1 - q/2)^6 (35q^2 / 12 + 3q + 1)   &amp; \text{if } 0 \leq q &lt; 2, \\
    0                                   &amp; \text{if } q \geq 2,
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization factor dependent on the dimension. The normalization factor <span>$\sigma$</span> is <span>$9 / \pi$</span> in two dimensions or <span>$495 / 32\pi$</span> in three dimensions.</p><p>This kernel function has a compact support of <span>$[0, 2h]$</span>.</p><p>For a detailed discussion on Wendland functions and their applications in SPH, see <a href="../../references/#Dehnen2012">Dehnen (2012)</a>. The smoothness of these functions is also the largest disadvantage as they lose details at sharp corners.</p><p>The smoothing length is typically in the range <span>$[1.5\delta, 2.3\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L418-L449">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.WendlandC6Kernel" href="#TrixiParticles.WendlandC6Kernel"><code>TrixiParticles.WendlandC6Kernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WendlandC6Kernel{NDIMS}()</code></pre><p>Wendland C6 kernel [<a href="../../references/#Wendland1995">8</a>], a piecewise polynomial function designed to have compact support and to be six times continuously differentiable everywhere. Given by:</p><p class="math-container">\[W(r, h) = \frac{1}{h^d} w(r/h)\]</p><p>with:</p><p class="math-container">\[w(q) = \sigma \begin{cases}
    (1 - q / 2)^8 (4q^3 + 25q^2 / 4 + 4q + 1)   &amp; \text{if } 0 \leq q &lt; 2, \\
    0                                           &amp; \text{if } q \geq 2,
\end{cases}\]</p><p>where <span>$d$</span> is the number of dimensions and <span>$\sigma$</span> is a normalization factor dependent on the dimension. The normalization factor <span>$\sigma$</span> is <span>$78 / 7 \pi$</span> in two dimensions or <span>$1365 / 64\pi$</span> in three dimensions.</p><p>This kernel function has a compact support of <span>$[0, 2h]$</span>.</p><p>For a detailed discussion on Wendland functions and their applications in SPH, <a href="../../references/#Dehnen2012">Dehnen (2012)</a>. The smoothness of these functions is also the largest disadvantage as they lose details at sharp corners.</p><p>The smoothing length is typically in the range <span>$[1.7\delta, 2.5\delta]$</span>, where <span>$\delta$</span> is the typical particle spacing.</p><p>For general information and usage see <a href="#smoothing_kernel">Smoothing Kernels</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/6e250d7a80804f6a206b0d4614c7bd612dba75e1/src/general/smoothing_kernels.jl#L482-L513">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../density_calculators/">« Density Calculators</a><a class="docs-footer-nextpage" href="../neighborhood_search/">Neighborhood Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 30 July 2025 12:26">Wednesday 30 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
