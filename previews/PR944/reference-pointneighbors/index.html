<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PointNeighbors.jl API Reference · TrixiParticles.jl</title><meta name="title" content="PointNeighbors.jl API Reference · TrixiParticles.jl"/><meta property="og:title" content="PointNeighbors.jl API Reference · TrixiParticles.jl"/><meta property="twitter:title" content="PointNeighbors.jl API Reference · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.js"></script><link href="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../news/">News</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li><a class="tocitem" href="../preprocessing/preprocessing/">Sampling of Geometries</a></li></ul></li><li><a class="tocitem" href="../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../general/semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../general/initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../general/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../general/density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../general/smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../general/neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../general/util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-11-3-1" type="checkbox"/><label class="tocitem" for="menuitem-11-3-1"><span class="docs-label">Fluid Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../systems/fluid/">Overview</a></li><li><a class="tocitem" href="../systems/weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../systems/entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li><li><a class="tocitem" href="../systems/implicit_incompressible_sph/">Implicit Incompressible SPH (Fluid)</a></li></ul></li><li><a class="tocitem" href="../systems/dem/">Discrete Element Method (Solid)</a></li><li><a class="tocitem" href="../systems/total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../systems/boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../reference-trixibase/">TrixiBase.jl API Reference</a></li><li class="is-active"><a class="tocitem" href>PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>PointNeighbors.jl API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PointNeighbors.jl API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/reference-pointneighbors.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="pointneighbors"><a class="docs-heading-anchor" href="#pointneighbors">PointNeighbors.jl API</a><a id="pointneighbors-1"></a><a class="docs-heading-anchor-permalink" href="#pointneighbors" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.DictionaryCellList" href="#PointNeighbors.DictionaryCellList"><code>PointNeighbors.DictionaryCellList</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DictionaryCellList{NDIMS}()</code></pre><p>A simple cell list implementation where a cell index <code>(i, j)</code> or <code>(i, j, k)</code> is mapped to a <code>Vector{Int}</code> by a <code>Dict</code>. By using a dictionary, which only stores non-empty cells, the domain is potentially infinite.</p><p>This implementation is very simple, but it neither uses an optimized hash function for integer tuples, nor does it use a contiguous memory layout. Consequently, this cell list is not GPU-compatible.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/cell_lists/dictionary.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.FullGridCellList" href="#PointNeighbors.FullGridCellList"><code>PointNeighbors.FullGridCellList</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FullGridCellList(; min_corner, max_corner, search_radius = 0.0,
                 periodicity = false, backend = DynamicVectorOfVectors{Int32},
                 max_points_per_cell = 100)</code></pre><p>A simple cell list implementation where each (empty or non-empty) cell of a rectangular (axis-aligned) domain is assigned a list of points. This cell list only works when all points are inside the specified domain at all times.</p><p>Only set <code>min_corner</code> and <code>max_corner</code> and use the default values for the other arguments to create an empty &quot;template&quot; cell list that can be used to create an empty &quot;template&quot; neighborhood search. See <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a> for more details.</p><p><strong>Keywords</strong></p><ul><li><code>min_corner</code>: Coordinates of the domain corner in negative coordinate directions.</li><li><code>max_corner</code>: Coordinates of the domain corner in positive coordinate directions.</li><li><code>search_radius = 0.0</code>: Search radius of the neighborhood search, which will determine the                        cell size. Use the default of <code>0.0</code> to create a template (see above).</li><li><code>periodicity = false</code>: Set to <code>true</code> when using a <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a> with the                        neighborhood search. When using <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>,                        this option can be ignored an will be set automatically depending                        on the periodicity of the neighborhood search.</li><li><code>backend = DynamicVectorOfVectors{Int32}</code>: Type of the data structure to store the actual   cell lists. Can be<ul><li><code>Vector{Vector{Int32}}</code>: Scattered memory, but very memory-efficient.</li><li><code>DynamicVectorOfVectors{Int32}</code>: Contiguous memory, optimizing cache-hits.</li></ul></li><li><code>max_points_per_cell = 100</code>: Maximum number of points per cell. This will be used to                              allocate the <code>DynamicVectorOfVectors</code>. It is not used with                              the <code>Vector{Vector{Int32}}</code> backend.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/cell_lists/full_grid.jl#L1-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.GridNeighborhoodSearch" href="#PointNeighbors.GridNeighborhoodSearch"><code>PointNeighbors.GridNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GridNeighborhoodSearch{NDIMS}(; search_radius = 0.0, n_points = 0,
                              periodic_box = nothing,
                              cell_list = DictionaryCellList{NDIMS}(),
                              update_strategy = nothing)</code></pre><p>Simple grid-based neighborhood search with uniform search radius. The domain is divided into a regular grid. For each (non-empty) grid cell, a list of points in this cell is stored. Instead of representing a finite domain by an array of cells, a potentially infinite domain is represented by storing cell lists in a hash table (using Julia&#39;s <code>Dict</code> data structure), indexed by the cell index tuple</p><p class="math-container">\[\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor \right) \quad \text{or} \quad
\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor, \left\lfloor \frac{z}{d} \right\rfloor \right),\]</p><p>where <span>$x, y, z$</span> are the space coordinates and <span>$d$</span> is the search radius.</p><p>To find points within the search radius around a position, only points in the neighboring cells are considered.</p><p>See also (Chalela et al., 2021), (Ihmsen et al. 2011, Section 4.4).</p><p>As opposed to (Ihmsen et al. 2011), we do not sort the points in any way, since not sorting makes our implementation a lot faster (although less parallelizable).</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>search_radius = 0.0</code>:    The fixed search radius. The default of <code>0.0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>n_points = 0</code>:           Total number of points. The default of <code>0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>periodic_box = nothing</code>: In order to use a (rectangular) periodic domain, pass a                           <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a>.</li><li><code>cell_list</code>:              The cell list that maps a cell index to a list of points inside                           the cell. By default, a <a href="#PointNeighbors.DictionaryCellList"><code>DictionaryCellList</code></a> is used.</li><li><code>update_strategy = nothing</code>: Strategy to parallelize <code>update!</code>. Available options are:<ul><li><code>nothing</code>: Automatically choose the best available option.</li><li><a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate()</code></a>: This is not available for all cell list implementations.</li><li><a href="#PointNeighbors.SemiParallelUpdate"><code>SemiParallelUpdate()</code></a>: This is available for all cell list implementations   and is the default when available.</li><li><a href="#PointNeighbors.SerialIncrementalUpdate"><code>SerialIncrementalUpdate()</code></a></li><li><a href="#PointNeighbors.SerialUpdate"><code>SerialUpdate()</code></a></li></ul></li></ul><p><strong>References</strong></p><ul><li>M. Chalela, E. Sillero, L. Pereyra, M.A. Garcia, J.B. Cabral, M. Lares, M. Merchán. &quot;GriSPy: A Python package for fixed-radius nearest neighbors search&quot;. In: Astronomy and Computing 34 (2021). <a href="https://doi.org/10.1016/j.ascom.2020.100443">doi: 10.1016/j.ascom.2020.100443</a></li><li>Markus Ihmsen, Nadir Akinci, Markus Becker, Matthias Teschner. &quot;A Parallel SPH Implementation on Multi-Core CPUs&quot;. In: Computer Graphics Forum 30.1 (2011), pages 99–112. <a href="https://doi.org/10.1111/J.1467-8659.2010.01832.X">doi: 10.1111/J.1467-8659.2010.01832.X</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_grid.jl#L1-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.ParallelIncrementalUpdate" href="#PointNeighbors.ParallelIncrementalUpdate"><code>PointNeighbors.ParallelIncrementalUpdate</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParallelIncrementalUpdate()</code></pre><p>Like <a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate</code></a>, but only updates the cells that have changed. This is generally slower than a full reinitialization with <a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate</code></a>, but is included for benchmarking purposes. This is not available for all cell list implementations, but is the default when available.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_grid.jl#L121-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.ParallelUpdate" href="#PointNeighbors.ParallelUpdate"><code>PointNeighbors.ParallelUpdate</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParallelUpdate()</code></pre><p>Fully parallel initialization and update by using atomic operations to avoid race conditions when adding points into the same cell. This is not available for all cell list implementations.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_grid.jl#L110-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.PeriodicBox" href="#PointNeighbors.PeriodicBox"><code>PointNeighbors.PeriodicBox</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PeriodicBox(; min_corner, max_corner)</code></pre><p>Define a rectangular (axis-aligned) periodic domain.</p><p><strong>Keywords</strong></p><ul><li><code>min_corner</code>: Coordinates of the domain corner in negative coordinate directions.</li><li><code>max_corner</code>: Coordinates of the domain corner in positive coordinate directions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/neighborhood_search.jl#L111-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.PolyesterBackend" href="#PointNeighbors.PolyesterBackend"><code>PointNeighbors.PolyesterBackend</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PolyesterBackend()</code></pre><p>Pass as first argument to the <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> macro to make the loop multithreaded with <code>Polyester.@batch</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/util.jl#L45-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.PrecomputedNeighborhoodSearch" href="#PointNeighbors.PrecomputedNeighborhoodSearch"><code>PointNeighbors.PrecomputedNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrecomputedNeighborhoodSearch{NDIMS}(; search_radius = 0.0, n_points = 0,
                                     periodic_box = nothing, update_strategy = nothing)</code></pre><p>Neighborhood search with precomputed neighbor lists. A list of all neighbors is computed for each point during initialization and update. This neighborhood search maximizes the performance of neighbor loops at the cost of a much slower <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p><p>A <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> is used internally to compute the neighbor lists during initialization and update.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>search_radius = 0.0</code>:    The fixed search radius. The default of <code>0.0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>n_points = 0</code>:           Total number of points. The default of <code>0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>periodic_box = nothing</code>: In order to use a (rectangular) periodic domain, pass a                           <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a>.</li><li><code>update_strategy</code>:        Strategy to parallelize <code>update!</code> of the internally used                           <code>GridNeighborhoodSearch</code>. See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a>                           for available options.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_precomputed.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.SemiParallelUpdate" href="#PointNeighbors.SemiParallelUpdate"><code>PointNeighbors.SemiParallelUpdate</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SemiParallelUpdate()</code></pre><p>Loop over all cells in parallel to mark cells with points that now belong to a different cell. Then, move points of affected cells serially to avoid race conditions. This is available for all cell list implementations and is the default when <a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate</code></a> is not available.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_grid.jl#L133-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.SerialBackend" href="#PointNeighbors.SerialBackend"><code>PointNeighbors.SerialBackend</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SerialBackend()</code></pre><p>Pass as first argument to the <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> macro to run the loop serially.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/util.jl#L38-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.SerialIncrementalUpdate" href="#PointNeighbors.SerialIncrementalUpdate"><code>PointNeighbors.SerialIncrementalUpdate</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SerialIncrementalUpdate()</code></pre><p>Deactivate parallelization in the neighborhood search update. Parallel neighborhood search update can be one of the largest sources of error variations between simulations with different thread numbers due to neighbor ordering changes. This strategy incrementally updates the cell lists in every update.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_grid.jl#L145-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.SerialUpdate" href="#PointNeighbors.SerialUpdate"><code>PointNeighbors.SerialUpdate</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SerialUpdate()</code></pre><p>Deactivate parallelization in the neighborhood search update. Parallel neighborhood search update can be one of the largest sources of error variations between simulations with different thread numbers due to neighbor ordering changes. This strategy reinitializes the cell lists in every update.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_grid.jl#L157-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.ThreadsDynamicBackend" href="#PointNeighbors.ThreadsDynamicBackend"><code>PointNeighbors.ThreadsDynamicBackend</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ThreadsDynamicBackend()</code></pre><p>Pass as first argument to the <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> macro to make the loop multithreaded with <code>Threads.@threads :dynamic</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/util.jl#L53-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.ThreadsStaticBackend" href="#PointNeighbors.ThreadsStaticBackend"><code>PointNeighbors.ThreadsStaticBackend</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ThreadsStaticBackend()</code></pre><p>Pass as first argument to the <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> macro to make the loop multithreaded with <code>Threads.@threads :static</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/util.jl#L61-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.TrivialNeighborhoodSearch" href="#PointNeighbors.TrivialNeighborhoodSearch"><code>PointNeighbors.TrivialNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TrivialNeighborhoodSearch{NDIMS}(; search_radius = 0.0, eachpoint = 1:0,
                                 periodic_box = nothing)</code></pre><p>Trivial neighborhood search that simply loops over all points.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>search_radius = 0.0</code>:    The fixed search radius. The default of <code>0.0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>eachpoint = 1:0</code>:        Iterator for all point indices. Usually just <code>1:n_points</code>.                           The default of <code>1:0</code> is useful together with                           <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>periodic_box = nothing</code>: In order to use a (rectangular) periodic domain, pass a                           <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/nhs_trivial.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.copy_neighborhood_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy_neighborhood_search(search::AbstractNeighborhoodSearch, search_radius, n_points;
                         eachpoint = 1:n_points)</code></pre><p>Create a new <strong>uninitialized</strong> neighborhood search of the same type and with the same configuration options as <code>search</code>, but with a different search radius and number of points.</p><p>The <a href="#PointNeighbors.TrivialNeighborhoodSearch"><code>TrivialNeighborhoodSearch</code></a> also requires an iterator <code>eachpoint</code>, which most of the time will be <code>1:n_points</code>. If the <code>TrivialNeighborhoodSearch</code> is never going to be used, the keyword argument <code>eachpoint</code> can be ignored.</p><p>This is useful when a simulation code requires multiple neighborhood searches of the same kind. One can then just pass an empty neighborhood search as a template and use this function inside the simulation code to generate similar neighborhood searches with different search radii and different numbers of points.</p><pre><code class="language-julia hljs"># Template
nhs = GridNeighborhoodSearch{2}()

# Inside the simulation code, generate similar neighborhood searches
nhs1 = copy_neighborhood_search(nhs, 1.0, 100)

# output
GridNeighborhoodSearch{2, Float64, ...}(...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/neighborhood_search.jl#L80-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.default_backend-Tuple{AbstractArray}" href="#PointNeighbors.default_backend-Tuple{AbstractArray}"><code>PointNeighbors.default_backend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_backend(x)</code></pre><p>Select the recommended backend for an array <code>x</code>. This allows to write generic code that works for both CPU and GPU arrays.</p><p>The default backend for CPU arrays is currently <code>PolyesterBackend()</code>. For GPU arrays, the respective <code>KernelAbstractions.Backend</code> is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/util.jl#L72-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.foreach_point_neighbor-Union{Tuple{T}, Tuple{T, Any, Any, Any}} where T" href="#PointNeighbors.foreach_point_neighbor-Union{Tuple{T}, Tuple{T, Any, Any, Any}} where T"><code>PointNeighbors.foreach_point_neighbor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">foreach_point_neighbor(f, system_coords, neighbor_coords, neighborhood_search;
                       parallelization_backend = default_backend(system_coords),
                       points = axes(system_coords, 2))</code></pre><p>Loop for each point in <code>system_coords</code> over all points in <code>neighbor_coords</code> whose distances to that point are smaller than the search radius and execute the function <code>f(i, j, pos_diff, d)</code>, where</p><ul><li><code>i</code> is the column index of the point in <code>system_coords</code>,</li><li><code>j</code> the column index of the neighbor in <code>neighbor_coords</code>,</li><li><code>pos_diff</code> the vector <span>$x - y$</span> where <span>$x$</span> denotes the coordinates of the point (<code>system_coords[:, i]</code>) and <span>$y$</span> the coordinates of the neighbor (<code>neighbor_coords[:, j]</code>),</li><li><code>d</code> the distance between <code>x</code> and <code>y</code>.</li></ul><p>Note that <code>system_coords</code> and <code>neighbor_coords</code> can be identical.</p><div class="admonition is-warning" id="Warning-2ffb19ad1d20428f"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-2ffb19ad1d20428f" title="Permalink"></a></header><div class="admonition-body"><p>The <code>neighborhood_search</code> must have been initialized or updated with <code>system_coords</code> as first coordinate array and <code>neighbor_coords</code> as second coordinate array. This can be skipped for certain implementations. See <a href="#PointNeighbors.requires_update-Tuple{PointNeighbors.AbstractNeighborhoodSearch}"><code>requires_update</code></a>.</p></div></div><p><strong>Arguments</strong></p><ul><li><code>f</code>: The function explained above.</li><li><code>system_coords</code>: A matrix where the <code>i</code>-th column contains the coordinates of point <code>i</code>.</li><li><code>neighbor_coords</code>: A matrix where the <code>j</code>-th column contains the coordinates of point <code>j</code>.</li><li><code>neighborhood_search</code>: A neighborhood search initialized or updated with <code>system_coords</code>                        as first coordinate array and <code>neighbor_coords</code> as second                        coordinate array.</li></ul><p><strong>Keywords</strong></p><ul><li><code>points</code>: Loop over these point indices. By default all columns of <code>system_coords</code>.</li><li><code>parallelization_backend</code>: Run the outer loop over <code>points</code> in parallel with the                            specified backend. By default, the backend is selected                            automatically based on the type of <code>system_coords</code>.                            See <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> for a list of available backends.</li></ul><p>See also <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>, <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/neighborhood_search.jl#L134-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(search::AbstractNeighborhoodSearch, x, y;
            parallelization_backend = default_backend(x),
            eachindex_y = axes(y, 2))</code></pre><p>Initialize a neighborhood search with the two coordinate arrays <code>x</code> and <code>y</code>.</p><p>In general, the purpose of a neighborhood search is to find for one point in <code>x</code> all points in <code>y</code> whose distances to that point are smaller than the search radius. <code>x</code> and <code>y</code> are expected to be matrices, where the <code>i</code>-th column contains the coordinates of point <code>i</code>. Note that <code>x</code> and <code>y</code> can be identical.</p><p>If the neighborhood search type supports parallelization, the keyword argument <code>parallelization_backend</code> can be used to specify a parallelization backend. See <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> for a list of available backends.</p><p>Optionally, when points in <code>y</code> are to be ignored, the keyword argument <code>eachindex_y</code> can be passed to specify the indices of the points in <code>y</code> that are to be used.</p><p>See also <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/neighborhood_search.jl#L15-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.requires_update-Tuple{PointNeighbors.AbstractNeighborhoodSearch}" href="#PointNeighbors.requires_update-Tuple{PointNeighbors.AbstractNeighborhoodSearch}"><code>PointNeighbors.requires_update</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">requires_update(search::AbstractNeighborhoodSearch)</code></pre><p>Returns a tuple <code>(x_changed, y_changed)</code> indicating if this type of neighborhood search requires an update when the coordinates of the points in <code>x</code> or <code>y</code> change.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/neighborhood_search.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(search::AbstractNeighborhoodSearch, x, y; points_moving = (true, true),
        parallelization_backend = default_backend(x),
        eachindex_y = axes(y, 2))</code></pre><p>Update an already initialized neighborhood search with the two coordinate arrays <code>x</code> and <code>y</code>.</p><p>Like <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>, but potentially reusing the existing data structures of the already initialized neighborhood search. When the points only moved a small distance since the last <code>update!</code> or <code>initialize!</code>, this can be significantly faster than <code>initialize!</code>.</p><p>Not all implementations support incremental updates. If incremental updates are not possible for an implementation, <code>update!</code> will fall back to a regular <code>initialize!</code>.</p><p>Some neighborhood searches might not need to update when only <code>x</code> changed since the last <code>update!</code> or <code>initialize!</code> and <code>y</code> did not change. Pass <code>points_moving = (true, false)</code> in this case to avoid unnecessary updates. The first flag in <code>points_moving</code> indicates if points in <code>x</code> are moving. The second flag indicates if points in <code>y</code> are moving.</p><p>If the neighborhood search type supports parallelization, the keyword argument <code>parallelization_backend</code> can be used to specify a parallelization backend. See <a href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>@threaded</code></a> for a list of available backends.</p><p>Optionally, when points in <code>y</code> are to be ignored, the keyword argument <code>eachindex_y</code> can be passed to specify the indices of the points in <code>y</code> that are to be used.</p><p>See also <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/neighborhood_search.jl#L42-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.@threaded-Tuple{Any, Any}" href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>PointNeighbors.@threaded</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@threaded backend for ... end</code></pre><p>Run either a threaded CPU loop or launch a kernel on the GPU, depending on the <code>backend</code>. Semantically the same as <code>Threads.@threads</code> when iterating over a <code>AbstractUnitRange</code> but without guarantee that the underlying implementation uses <code>Threads.@threads</code> or works for more general <code>for</code> loops.</p><p>Possible parallelization backends are:</p><ul><li><a href="#PointNeighbors.SerialBackend"><code>SerialBackend</code></a> to disable multithreading</li><li><a href="#PointNeighbors.PolyesterBackend"><code>PolyesterBackend</code></a> to use <code>Polyester.@batch</code></li><li><a href="#PointNeighbors.ThreadsDynamicBackend"><code>ThreadsDynamicBackend</code></a> to use <code>Threads.@threads :dynamic</code></li><li><a href="#PointNeighbors.ThreadsStaticBackend"><code>ThreadsStaticBackend</code></a> to use <code>Threads.@threads :static</code></li><li>Any <code>KernelAbstractions.Backend</code> to execute the loop as a GPU kernel</li></ul><p>Use <code>default_backend(x)</code> to select the recommended backend for an array <code>x</code>. This allows to write generic code that works for both CPU and GPU arrays.</p><div class="admonition is-warning" id="Warning-3eb4046db742d293"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-3eb4046db742d293" title="Permalink"></a></header><div class="admonition-body"><p>This macro does not necessarily work for general <code>for</code> loops. For example, it does not necessarily support general iterables such as <code>eachline(filename)</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/v0.6.3/src/util.jl#L85-L106">source</a></section></article><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reference-trixibase/">« TrixiBase.jl API Reference</a><a class="docs-footer-nextpage" href="../authors/">Authors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 9 October 2025 00:37">Thursday 9 October 2025</span>. Using Julia version 1.12.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
