<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · TrixiParticles.jl</title><meta name="title" content="Overview · TrixiParticles.jl"/><meta property="og:title" content="Overview · TrixiParticles.jl"/><meta property="twitter:title" content="Overview · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.js"></script><link href="https://cdn.jsdelivr.net/npm/asciinema-player@3.6.3/dist/bundle/asciinema-player.min.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Preprocessing</span><ul><li><a class="tocitem" href="../../preprocessing/preprocessing/">Sampling of Geometries</a></li></ul></li><li><a class="tocitem" href="../../gpu/">GPU Support</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../general/semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../../general/initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../../general/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../general/density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../../general/smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../../general/neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../../general/util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox" checked/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-11-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-11-3-1"><span class="docs-label">Fluid Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#viscosity_wcsph"><span>Viscosity</span></a></li><li><a class="tocitem" href="#corrections"><span>Corrections</span></a></li><li><a class="tocitem" href="#surface_normal"><span>Surface Normals</span></a></li><li><a class="tocitem" href="#surface_tension"><span>Surface Tension</span></a></li></ul></li><li><a class="tocitem" href="../weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li></ul></li><li><a class="tocitem" href="../dem/">Discrete Element Method (Solid)</a></li><li><a class="tocitem" href="../total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li><li><a class="tocitem" href="../../reference-pointneighbors/">PointNeighbors.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li><a class="is-disabled">Systems</a></li><li><a class="is-disabled">Fluid Models</a></li><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/systems/fluid.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="fluid_models"><a class="docs-heading-anchor" href="#fluid_models">Fluid Models</a><a id="fluid_models-1"></a><a class="docs-heading-anchor-permalink" href="#fluid_models" title="Permalink"></a></h1><p>Currently available fluid methods are the <a href="../weakly_compressible_sph/#wcsph">weakly compressible SPH method</a> and the <a href="../entropically_damped_sph/#edac">entropically damped artificial compressibility for SPH</a>.   This page lists models and techniques that apply to both of these methods.  </p><h2 id="viscosity_wcsph"><a class="docs-heading-anchor" href="#viscosity_wcsph">Viscosity</a><a id="viscosity_wcsph-1"></a><a class="docs-heading-anchor-permalink" href="#viscosity_wcsph" title="Permalink"></a></h2><p>TODO: Explain viscosity.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ArtificialViscosityMonaghan" href="#TrixiParticles.ArtificialViscosityMonaghan"><code>TrixiParticles.ArtificialViscosityMonaghan</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ArtificialViscosityMonaghan(; alpha, beta=0.0, epsilon=0.01)</code></pre><p>Artificial viscosity by Monaghan ([<a href="../../references/#Monaghan1992">9</a>], [<a href="../../references/#Monaghan1989">10</a>]), given by</p><p class="math-container">\[\Pi_{ab} =
\begin{cases}
    -(\alpha c \mu_{ab} + \beta \mu_{ab}^2) / \bar{\rho}_{ab} &amp; \text{if } v_{ab} \cdot r_{ab} &lt; 0, \\
    0 &amp; \text{otherwise}
\end{cases}\]</p><p>with</p><p class="math-container">\[\mu_{ab} = \frac{h v_{ab} \cdot r_{ab}}{\Vert r_{ab} \Vert^2 + \epsilon h^2},\]</p><p>where <span>$\alpha, \beta, \epsilon$</span> are parameters, <span>$c$</span> is the speed of sound, <span>$h$</span> is the smoothing length, <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>, <span>$v_{ab} = v_a - v_b$</span> is the difference of their velocities, and <span>$\bar{\rho}_{ab}$</span> is the arithmetic mean of their densities.</p><p>Note that <span>$\alpha$</span> needs to adjusted for different resolutions to maintain a specific Reynolds Number. To do so, <a href="../../references/#Monaghan2005">Monaghan (2005)</a> defined an equivalent effective physical kinematic viscosity <span>$\nu$</span> by</p><p class="math-container">\[    \nu = \frac{\alpha h c }{2d + 4},\]</p><p>where <span>$d$</span> is the dimension.</p><p><strong>Keywords</strong></p><ul><li><code>alpha</code>: A value of <code>0.02</code> is usually used for most simulations. For a relation with the          kinematic viscosity, see description above.</li><li><code>beta=0.0</code>: A value of <code>0.0</code> works well for most fluid simulations and simulations             with shocks of moderate strength. In simulations where the Mach number can be             very high, eg. astrophysical calculation, good results can be obtained by             choosing a value of <code>beta=2.0</code> and <code>alpha=1.0</code>.</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/schemes/fluid/viscosity.jl#L32-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityAdami" href="#TrixiParticles.ViscosityAdami"><code>TrixiParticles.ViscosityAdami</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityAdami(; nu, epsilon=0.01)</code></pre><p>Viscosity by <a href="../../references/#Adami2012">Adami (2012)</a>. The viscous interaction is calculated with the shear force for incompressible flows given by</p><p class="math-container">\[f_{ab} = \sum_w \bar{\eta}_{ab} \left( V_a^2 + V_b^2 \right) \frac{v_{ab}}{||r_{ab}||^2+\epsilon h_{ab}^2}  \nabla W_{ab} \cdot r_{ab},\]</p><p>where <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>, <span>$v_{ab} = v_a - v_b$</span> is the difference of their velocities, <span>$h$</span> is the smoothing length and <span>$V$</span> is the particle volume. The parameter <span>$\epsilon$</span> prevents singularities (see <a href="../../references/#Ramachandran2019">Ramachandran (2019)</a>). The inter-particle-averaged shear stress  is</p><p class="math-container">\[    \bar{\eta}_{ab} =\frac{2 \eta_a \eta_b}{\eta_a + \eta_b},\]</p><p>where <span>$\eta_a = \rho_a \nu_a$</span> with <span>$\nu$</span> as the kinematic viscosity.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>: Kinematic viscosity</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/schemes/fluid/viscosity.jl#L181-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ViscosityMorris" href="#TrixiParticles.ViscosityMorris"><code>TrixiParticles.ViscosityMorris</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViscosityMorris(; nu, epsilon=0.01)</code></pre><p>Viscosity by <a href="../../references/#Morris1997">Morris (1997)</a> also used by <a href="../../references/#Fourtakas2019">Fourtakas (2019)</a>.</p><p>To the force <span>$f_{ab}$</span> between two particles <span>$a$</span> and <span>$b$</span> due to pressure gradients, an additional force term <span>$\tilde{f}_{ab}$</span> is added with</p><p class="math-container">\[\tilde{f}_{ab} = m_a m_b \frac{(\mu_a + \mu_b) r_{ab} \cdot \nabla W_{ab}}{\rho_a \rho_b (\Vert r_{ab} \Vert^2 + \epsilon h^2)} v_{ab},\]</p><p>where <span>$\mu_a = \rho_a \nu$</span> and <span>$\mu_b = \rho_b \nu$</span> denote the dynamic viscosity of particle <span>$a$</span> and <span>$b$</span> respectively, and <span>$\nu$</span> is the kinematic viscosity.</p><p><strong>Keywords</strong></p><ul><li><code>nu</code>: Kinematic viscosity</li><li><code>epsilon=0.01</code>: Parameter to prevent singularities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/schemes/fluid/viscosity.jl#L78-L94">source</a></section></article><h2 id="corrections"><a class="docs-heading-anchor" href="#corrections">Corrections</a><a id="corrections-1"></a><a class="docs-heading-anchor-permalink" href="#corrections" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.AkinciFreeSurfaceCorrection" href="#TrixiParticles.AkinciFreeSurfaceCorrection"><code>TrixiParticles.AkinciFreeSurfaceCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AkinciFreeSurfaceCorrection(rho0)</code></pre><p>Free surface correction according to <a href="../../references/#Akinci2013">Akinci et al. (2013)</a>. At a free surface, the mean density is typically lower than the reference density, resulting in reduced surface tension and viscosity forces. The free surface correction adjusts the viscosity, pressure, and surface tension forces near free surfaces to counter this effect. It&#39;s important to note that this correlation is unphysical and serves as an approximation. The computation time added by this method is about 2–3%.</p><p>Mathematically the idea is quite simple. If we have an SPH particle in the middle of a volume at rest, its density will be identical to the rest density <span>$\rho_0$</span>. If we now consider an SPH particle at a free surface at rest, it will have neighbors missing in the direction normal to the surface, which will result in a lower density. If we calculate the correction factor</p><p class="math-container">\[k = \rho_0/\rho_\text{mean},\]</p><p>this value will be about ~1.5 for particles at the free surface and can then be used to increase the pressure and viscosity accordingly.</p><p><strong>Arguments</strong></p><ul><li><code>rho0</code>: Rest density.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/general/corrections.jl#L2-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BlendedGradientCorrection" href="#TrixiParticles.BlendedGradientCorrection"><code>TrixiParticles.BlendedGradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BlendedGradientCorrection()</code></pre><p>Calculate a blended gradient to reduce the stability issues of the <a href="#TrixiParticles.GradientCorrection"><code>GradientCorrection</code></a> as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>.</p><p>This calculates the following,</p><p class="math-container">\[\tilde\nabla A_i = (1-\lambda) \nabla A_i + \lambda L_i \nabla A_i\]</p><p>with <span>$0 \leq \lambda \leq 1$</span> being the blending factor.</p><p><strong>Arguments</strong></p><ul><li><code>blending_factor</code>: Blending factor between corrected and regular SPH gradient.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/general/corrections.jl#L278-L292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.GradientCorrection" href="#TrixiParticles.GradientCorrection"><code>TrixiParticles.GradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GradientCorrection()</code></pre><p>Compute the corrected gradient of particle interactions based on their relative positions (see <a href="../../references/#Bonet1999">Bonet, 1999</a>).</p><p><strong>Mathematical Details</strong></p><p>Given the standard SPH representation, the gradient of a field <span>$A$</span> at particle <span>$a$</span> is given by</p><p class="math-container">\[\nabla A_a = \sum_b m_b \frac{A_b - A_a}{\rho_b} \nabla_{r_a} W(\Vert r_a - r_b \Vert, h),\]</p><p>where <span>$m_b$</span> is the mass of particle <span>$b$</span> and <span>$\rho_b$</span> is the density of particle <span>$b$</span>.</p><p>The gradient correction, as commonly proposed, involves multiplying this gradient with a correction matrix <span>$L$</span>:</p><p class="math-container">\[\tilde{\nabla} A_a = \bm{L}_a \nabla A_a\]</p><p>The correction matrix  <span>$\bm{L}_a$</span> is computed based on the provided particle configuration, aiming to make the corrected gradient more accurate, especially near domain boundaries.</p><p>To satisfy</p><p class="math-container">\[\sum_b V_b r_{ba} \otimes \tilde{\nabla}W_b(r_a) = \left( \sum_b V_b r_{ba} \otimes \nabla W_b(r_a) \right) \bm{L}_a^T = \bm{I}\]</p><p>the correction matrix <span>$\bm{L}_a$</span> is evaluated explicitly as</p><p class="math-container">\[\bm{L}_a = \left( \sum_b V_b \nabla W_b(r_{a}) \otimes r_{ba} \right)^{-1}.\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>Stability issues arise, especially when particles separate into small clusters.</li><li>Doubles the computational effort.</li><li>Better stability with smoother smoothing Kernels with larger support, e.g. <a href="../../general/smoothing_kernels/#TrixiParticles.SchoenbergQuinticSplineKernel"><code>SchoenbergQuinticSplineKernel</code></a> or <a href="../../general/smoothing_kernels/#TrixiParticles.WendlandC6Kernel"><code>WendlandC6Kernel</code></a>.</li><li>Set <code>dt_max =&lt; 1e-3</code> for stability.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/general/corrections.jl#L236-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.KernelCorrection" href="#TrixiParticles.KernelCorrection"><code>TrixiParticles.KernelCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KernelCorrection()</code></pre><p>Kernel correction, as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>, uses Shepard interpolation to obtain a 0-th order accurate result, which was first proposed by Li et al. This can be further extended to obtain a kernel corrected gradient as shown by <a href="../../references/#Basa2008">Basa et al. (2008)</a>.</p><p>The kernel correction coefficient is determined by</p><p class="math-container">\[c(x) = \sum_{b=1} V_b W_b(x)\]</p><p>The gradient of corrected kernel is determined by</p><p class="math-container">\[\nabla \tilde{W}_{b}(r) =\frac{\nabla W_{b}(r) - W_b(r) \gamma(r)}{\sum_{b=1} V_b W_b(r)} , \quad  \text{where} \quad
\gamma(r) = \frac{\sum_{b=1} V_b \nabla W_b(r)}{\sum_{b=1} V_b W_b(r)}.\]</p><p>This correction can be applied with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> and <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a>, which leads to an improvement, especially at free surfaces.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>This only works when the boundary model uses <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> (yet).</li><li>It is also referred to as &quot;0th order correction&quot;.</li><li>In 2D, we can expect an increase of about 10–15% in computation time.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/general/corrections.jl#L71-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.MixedKernelGradientCorrection" href="#TrixiParticles.MixedKernelGradientCorrection"><code>TrixiParticles.MixedKernelGradientCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MixedKernelGradientCorrection()</code></pre><p>Combines <a href="#TrixiParticles.GradientCorrection"><code>GradientCorrection</code></a> and <a href="#TrixiParticles.KernelCorrection"><code>KernelCorrection</code></a>, which results in a 1st-order-accurate SPH method (see <a href="../../references/#Bonet1999">Bonet, 1999</a>).</p><p><strong>Notes:</strong></p><ul><li>Stability issues, especially when particles separate into small clusters.</li><li>Doubles the computational effort.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/general/corrections.jl#L98-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ShepardKernelCorrection" href="#TrixiParticles.ShepardKernelCorrection"><code>TrixiParticles.ShepardKernelCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShepardKernelCorrection()</code></pre><p>Kernel correction, as explained by <a href="../../references/#Bonet1999">Bonet (1999)</a>, uses Shepard interpolation to obtain a 0-th order accurate result, which was first proposed by <a href="../../references/#Li1996">Li et al. (1996)</a>.</p><p>The kernel correction coefficient is determined by</p><p class="math-container">\[c(x) = \sum_{b=1} V_b W_b(x),\]</p><p>where <span>$V_b = m_b / \rho_b$</span> is the volume of particle <span>$b$</span>.</p><p>This correction is applied with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> to correct the density and leads to an improvement, especially at free surfaces.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>It is also referred to as &quot;0th order correction&quot;.</li><li>In 2D, we can expect an increase of about 5–6% in computation time.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/general/corrections.jl#L50-L68">source</a></section></article><h2 id="surface_normal"><a class="docs-heading-anchor" href="#surface_normal">Surface Normals</a><a id="surface_normal-1"></a><a class="docs-heading-anchor-permalink" href="#surface_normal" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.ColorfieldSurfaceNormal" href="#TrixiParticles.ColorfieldSurfaceNormal"><code>TrixiParticles.ColorfieldSurfaceNormal</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ColorfieldSurfaceNormal()</code></pre><p>Color field based computation of the interface normals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/schemes/fluid/surface_normal_sph.jl#L1-L5">source</a></section></article><h2 id="surface_tension"><a class="docs-heading-anchor" href="#surface_tension">Surface Tension</a><a id="surface_tension-1"></a><a class="docs-heading-anchor-permalink" href="#surface_tension" title="Permalink"></a></h2><h3 id="Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model"><a class="docs-heading-anchor" href="#Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model">Akinci-based intra-particle force surface tension and wall adhesion model</a><a id="Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model-1"></a><a class="docs-heading-anchor-permalink" href="#Akinci-based-intra-particle-force-surface-tension-and-wall-adhesion-model" title="Permalink"></a></h3><p>The work by Akinci proposes three forces:</p><ul><li>a cohesion force</li><li>a surface area minimization force</li><li>a wall adhesion force</li></ul><p>The classical model is composed of the curvature minimization and cohesion force.</p><h4 id="Cohesion-force"><a class="docs-heading-anchor" href="#Cohesion-force">Cohesion force</a><a id="Cohesion-force-1"></a><a class="docs-heading-anchor-permalink" href="#Cohesion-force" title="Permalink"></a></h4><p>The model calculates the cohesion force based on the support radius <span>$h_c$</span> and the distance between particles. This force is determined using two distinct regimes within the support radius:</p><ul><li>For particles closer than half the support radius, a repulsive force is calculated to prevent particles from clustering too tightly, enhancing the simulation&#39;s stability and realism.</li><li>Beyond half the support radius and within the full support radius, an attractive force is computed, simulating the effects of surface tension that draw particles together.</li></ul><p>The cohesion force, <span>$F_{\text{cohesion}}$</span>, for a pair of particles is given by:</p><p class="math-container">\[F_{\text{cohesion}} = -\sigma m_b C(r) \frac{r}{\Vert r \Vert},\]</p><p>where:</p><ul><li><span>$\sigma$</span> represents the surface tension coefficient, adjusting the overall strength of the cohesion effect.</li><li><span>$C$</span> is a scalar function of the distance between particles.</li></ul><p>The cohesion kernel <span>$C$</span> is defined as</p><p class="math-container">\[C(r)=\frac{32}{\pi h_c^9}
\begin{cases}
(h_c-r)^3 r^3, &amp; \text{if } 2r &gt; h_c \\
2(h_c-r)^3 r^3 - \frac{h^6}{64}, &amp; \text{if } r &gt; 0 \text{ and } 2r \leq h_c \\
0, &amp; \text{otherwise}
\end{cases}\]</p><h4 id="Surface-area-minimization-force"><a class="docs-heading-anchor" href="#Surface-area-minimization-force">Surface area minimization force</a><a id="Surface-area-minimization-force-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-area-minimization-force" title="Permalink"></a></h4><p>To model the minimization of the surface area and curvature of the fluid, a curvature force is used, which is calculated as</p><p class="math-container">\[F_{\text{curvature}} = -\sigma (n_a - n_b)\]</p><h4 id="Wall-adhesion-force"><a class="docs-heading-anchor" href="#Wall-adhesion-force">Wall adhesion force</a><a id="Wall-adhesion-force-1"></a><a class="docs-heading-anchor-permalink" href="#Wall-adhesion-force" title="Permalink"></a></h4><p>The wall adhesion model proposed by Akinci et al. is based on a kernel function which is 0 from 0.0 to 0.5 support radiia with a maximum at 0.75. With the force calculated with an adhesion coefficient <span>$\beta$</span> as</p><p class="math-container">\[F_{\text{adhesion}} = -\beta m_b A(r) \frac{r}{\Vert r \Vert},\]</p><p>with <span>$A$</span> being the adhesion kernel defined as</p><p class="math-container">\[A(r)= \frac{0.007}{h_c^{3.25}}
\begin{cases}
\sqrt[4]{- \frac{4r^2}{h_c} + 6r - 2h_c}, &amp; \text{if } 2r &gt; h_c \text{ and } r \leq h_c \\
0, &amp; \text{otherwise.}
\end{cases}\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.CohesionForceAkinci" href="#TrixiParticles.CohesionForceAkinci"><code>TrixiParticles.CohesionForceAkinci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CohesionForceAkinci(surface_tension_coefficient=1.0)</code></pre><p>This model only implements the cohesion force of the [<a href="../../references/#Akinci2013">16</a>] surface tension model.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: Modifies the intensity of the surface tension-induced force,  enabling the tuning of the fluid&#39;s surface tension properties within the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/schemes/fluid/surface_tension.jl#L4-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.SurfaceTensionAkinci" href="#TrixiParticles.SurfaceTensionAkinci"><code>TrixiParticles.SurfaceTensionAkinci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceTensionAkinci(surface_tension_coefficient=1.0)</code></pre><p>Implements a model for surface tension and adhesion effects drawing upon the principles outlined by [<a href="../../references/#Akinci2013">16</a>]. This model is instrumental in capturing the nuanced behaviors of fluid surfaces, such as droplet formation and the dynamics of merging or separation, by utilizing intra-particle forces.</p><p><strong>Keywords</strong></p><ul><li><code>surface_tension_coefficient=1.0</code>: A parameter to adjust the magnitude of  surface tension forces, facilitating the fine-tuning of how surface tension phenomena  are represented in the simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/3872c1b9beaf68cc730bfba548d6d884da89709e/src/schemes/fluid/surface_tension.jl#L21-L33">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../general/util/">« Util</a><a class="docs-footer-nextpage" href="../weakly_compressible_sph/">Weakly Compressible SPH (Fluid) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 5 March 2025 11:22">Wednesday 5 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
