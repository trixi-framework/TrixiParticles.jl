# 2D
@testset verbose=true "Extrude Geometry 2D" begin
    point1 = [0.0, 0.0]
    point2 = [0.5, 1.0]
    directions = [
        [-1.0, 2.0],
        -[-1.0, 2.0],
        [-2.0, 1.0],
        -[-2.0, 1.0],
        [1.0, 0.0],
        [0.0, 1.0]
    ]

    @testset verbose=true "Extrude Line-Points" begin
        expected_coords = [
            [0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 -0.06708203932499368 0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999748 0.3354101966249684 0.40249223594996214 -0.13416407864998736 -0.06708203932499368 0.0 0.06708203932499368 0.13416407864998736 0.2012461179749811 0.2683281572999747 0.33541019662496846 -0.20124611797498104 -0.13416407864998736 -0.06708203932499368 0.0 0.06708203932499368 0.13416407864998742 0.20124611797498104 0.2683281572999748 -0.2683281572999747 -0.20124611797498104 -0.13416407864998736 -0.06708203932499368 0.0 0.06708203932499374 0.13416407864998736 0.2012461179749811;
             0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499368 0.8049844718999243 0.9391485505499115 1.073312629199899 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499368 0.8049844718999242 0.9391485505499116 1.073312629199899 1.2074767078498865 0.4024922359499621 0.5366563145999494 0.6708203932499368 0.8049844718999242 0.9391485505499115 1.073312629199899 1.2074767078498863 1.3416407864998736 0.5366563145999494 0.6708203932499368 0.8049844718999242 0.9391485505499115 1.073312629199899 1.2074767078498865 1.3416407864998736 1.4758048651498612],
            [0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.3354101966249684 0.40249223594996214 0.46957427527495577 0.5366563145999494 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.3354101966249684 0.4024922359499621 0.4695742752749558 0.5366563145999494 0.6037383539249432 0.20124611797498104 0.2683281572999747 0.3354101966249684 0.4024922359499621 0.46957427527495577 0.5366563145999494 0.6037383539249431 0.6708203932499368 0.2683281572999747 0.3354101966249684 0.4024922359499621 0.46957427527495577 0.5366563145999494 0.6037383539249432 0.6708203932499368 0.7379024325749306;
             0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 -0.13416407864998736 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999496 0.6708203932499368 0.8049844718999243 -0.2683281572999747 -0.13416407864998736 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499622 0.5366563145999494 0.6708203932499369 -0.4024922359499621 -0.2683281572999747 -0.13416407864998736 0.0 0.13416407864998736 0.26832815729997483 0.4024922359499621 0.5366563145999496 -0.5366563145999494 -0.4024922359499621 -0.2683281572999747 -0.13416407864998736 0.0 0.13416407864998747 0.2683281572999747 0.4024922359499622],
            [0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 -0.13416407864998736 -0.06708203932499368 0.0 0.06708203932499368 0.13416407864998736 0.2012461179749811 0.2683281572999747 0.33541019662496846 -0.2683281572999747 -0.20124611797498104 -0.13416407864998736 -0.06708203932499368 0.0 0.06708203932499374 0.13416407864998736 0.2012461179749811 -0.4024922359499621 -0.3354101966249684 -0.2683281572999747 -0.20124611797498104 -0.13416407864998736 -0.06708203932499363 0.0 0.06708203932499374 -0.5366563145999494 -0.46957427527495577 -0.4024922359499621 -0.3354101966249684 -0.2683281572999747 -0.201246117974981 -0.13416407864998736 -0.06708203932499363;
             0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.06708203932499368 0.20124611797498104 0.3354101966249684 0.46957427527495577 0.6037383539249431 0.7379024325749306 0.8720665112249179 1.0062305898749053 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499368 0.8049844718999243 0.9391485505499115 1.073312629199899 0.20124611797498104 0.3354101966249684 0.46957427527495577 0.6037383539249431 0.7379024325749305 0.872066511224918 1.0062305898749053 1.1403946685248927 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499368 0.8049844718999242 0.9391485505499116 1.073312629199899 1.2074767078498865],
            [0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.3354101966249684 0.4024922359499621 0.4695742752749558 0.5366563145999494 0.6037383539249432 0.2683281572999747 0.3354101966249684 0.4024922359499621 0.46957427527495577 0.5366563145999494 0.6037383539249432 0.6708203932499368 0.7379024325749306 0.4024922359499621 0.46957427527495577 0.5366563145999494 0.6037383539249431 0.6708203932499368 0.7379024325749306 0.8049844718999242 0.872066511224918 0.5366563145999494 0.6037383539249431 0.6708203932499368 0.7379024325749305 0.8049844718999242 0.872066511224918 0.9391485505499115 1.0062305898749053;
             0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 -0.06708203932499368 0.06708203932499368 0.20124611797498104 0.3354101966249684 0.46957427527495577 0.6037383539249432 0.7379024325749305 0.872066511224918 -0.13416407864998736 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999496 0.6708203932499368 0.8049844718999243 -0.20124611797498104 -0.06708203932499368 0.06708203932499368 0.20124611797498104 0.3354101966249684 0.4695742752749559 0.6037383539249431 0.7379024325749306 -0.2683281572999747 -0.13416407864998736 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499622 0.5366563145999494 0.6708203932499369],
            [0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.15 0.21708203932499368 0.2841640786499874 0.35124611797498106 0.41832815729997475 0.4854101966249684 0.5524922359499621 0.6195742752749558 0.3 0.36708203932499367 0.43416407864998735 0.501246117974981 0.5683281572999748 0.6354101966249684 0.7024922359499621 0.7695742752749558 0.44999999999999996 0.5170820393249936 0.5841640786499873 0.651246117974981 0.7183281572999747 0.7854101966249685 0.852492235949962 0.9195742752749558 0.6 0.6670820393249937 0.7341640786499873 0.801246117974981 0.8683281572999747 0.9354101966249684 1.002492235949962 1.0695742752749557;
             0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116],
            [0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558 0.0 0.06708203932499368 0.13416407864998736 0.20124611797498104 0.2683281572999747 0.33541019662496846 0.4024922359499621 0.4695742752749558;
             0.0 0.13416407864998736 0.2683281572999747 0.4024922359499621 0.5366563145999494 0.6708203932499369 0.8049844718999242 0.9391485505499116 0.15 0.2841640786499874 0.41832815729997475 0.5524922359499621 0.6866563145999495 0.8208203932499369 0.9549844718999242 1.0891485505499117 0.3 0.43416407864998735 0.5683281572999748 0.7024922359499621 0.8366563145999495 0.9708203932499369 1.1049844718999242 1.2391485505499116 0.44999999999999996 0.5841640786499873 0.7183281572999747 0.852492235949962 0.9866563145999494 1.1208203932499368 1.2549844718999241 1.3891485505499115 0.6 0.7341640786499873 0.8683281572999747 1.002492235949962 1.1366563145999495 1.270820393249937 1.4049844718999243 1.5391485505499116]
        ]

        @testset "Direction $i" for i in eachindex(directions)
            shape = extrude_geometry((point1, point2); direction=directions[i],
                                     place_on_shell=true,
                                     particle_spacing=0.15, n_extrude=5, density=1.0)

            @test shape.coordinates ≈ expected_coords[i]
        end
    end

    @testset verbose=true "Shifted Particles" begin
        point1 = [0.0, 0.0]
        point2 = [0.0, 1.0]

        expected_coords = [-0.05 -0.05 -0.05 -0.05 -0.05 -0.05 -0.05 -0.05 -0.05 -0.05 -0.15 -0.15 -0.15 -0.15 -0.15 -0.15 -0.15 -0.15 -0.15 -0.15 -0.25 -0.25 -0.25 -0.25 -0.25 -0.25 -0.25 -0.25 -0.25 -0.25 -0.35 -0.35 -0.35 -0.35 -0.35 -0.35 -0.35 -0.35 -0.35 -0.35 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996 -0.44999999999999996;
                           0.05 0.15 0.24999999999999997 0.35 0.44999999999999996 0.55 0.65 0.7499999999999999 0.8499999999999999 0.95 0.05 0.15 0.24999999999999997 0.35 0.44999999999999996 0.55 0.65 0.7499999999999999 0.8499999999999999 0.95 0.05 0.15 0.24999999999999997 0.35 0.44999999999999996 0.55 0.65 0.7499999999999999 0.8499999999999999 0.95 0.05 0.15 0.24999999999999997 0.35 0.44999999999999996 0.55 0.65 0.7499999999999999 0.8499999999999999 0.95 0.05 0.15 0.24999999999999997 0.35 0.44999999999999996 0.55 0.65 0.7499999999999999 0.8499999999999999 0.95]
        shape = extrude_geometry((point1, point2); direction=[-1.0, 0.0],
                                 particle_spacing=0.1, n_extrude=5, density=1.0)

        @test shape.coordinates ≈ expected_coords
    end
end

# 3D
@testset verbose=true "Extrude Geometry 3D" begin
    @testset verbose=true "Extrude 2D Shape" begin
        geometry = SphereShape(0.1, 0.5, (0.2, 0.4), 1000.0, n_layers=3,
                               sphere_type=RoundSphere(end_angle=pi))
        particle_spacing = geometry.particle_spacing

        directions = [[0.0, 0.0, 1.0], [0.0, -1.0, 1.0]]

        expected_coords = [
            [0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994;
             0.4 0.4956708580912724 0.5767766952966369 0.6309698831278217 0.6499999999999999 0.6309698831278217 0.5767766952966369 0.4956708580912725 0.4000000000000001 0.4 0.4986063948945004 0.5892242861094592 0.6645123510239904 0.7183711983740815 0.7464375046583265 0.7464375046583265 0.7183711983740815 0.6645123510239904 0.5892242861094591 0.49860639489450054 0.4000000000000001 0.4 0.5001344202803415 0.5952476826029012 0.6805704108364301 0.7518241671106134 0.8054359905560886 0.8387175604818207 0.85 0.8387175604818207 0.8054359905560886 0.7518241671106134 0.6805704108364301 0.5952476826029012 0.5001344202803415 0.4000000000000001 0.4 0.4956708580912724 0.5767766952966369 0.6309698831278217 0.6499999999999999 0.6309698831278217 0.5767766952966369 0.4956708580912725 0.4000000000000001 0.4 0.4986063948945004 0.5892242861094592 0.6645123510239904 0.7183711983740815 0.7464375046583265 0.7464375046583265 0.7183711983740815 0.6645123510239904 0.5892242861094591 0.49860639489450054 0.4000000000000001 0.4 0.5001344202803415 0.5952476826029012 0.6805704108364301 0.7518241671106134 0.8054359905560886 0.8387175604818207 0.85 0.8387175604818207 0.8054359905560886 0.7518241671106134 0.6805704108364301 0.5952476826029012 0.5001344202803415 0.4000000000000001 0.4 0.4956708580912724 0.5767766952966369 0.6309698831278217 0.6499999999999999 0.6309698831278217 0.5767766952966369 0.4956708580912725 0.4000000000000001 0.4 0.4986063948945004 0.5892242861094592 0.6645123510239904 0.7183711983740815 0.7464375046583265 0.7464375046583265 0.7183711983740815 0.6645123510239904 0.5892242861094591 0.49860639489450054 0.4000000000000001 0.4 0.5001344202803415 0.5952476826029012 0.6805704108364301 0.7518241671106134 0.8054359905560886 0.8387175604818207 0.85 0.8387175604818207 0.8054359905560886 0.7518241671106134 0.6805704108364301 0.5952476826029012 0.5001344202803415 0.4000000000000001 0.4 0.4956708580912724 0.5767766952966369 0.6309698831278217 0.6499999999999999 0.6309698831278217 0.5767766952966369 0.4956708580912725 0.4000000000000001 0.4 0.4986063948945004 0.5892242861094592 0.6645123510239904 0.7183711983740815 0.7464375046583265 0.7464375046583265 0.7183711983740815 0.6645123510239904 0.5892242861094591 0.49860639489450054 0.4000000000000001 0.4 0.5001344202803415 0.5952476826029012 0.6805704108364301 0.7518241671106134 0.8054359905560886 0.8387175604818207 0.85 0.8387175604818207 0.8054359905560886 0.7518241671106134 0.6805704108364301 0.5952476826029012 0.5001344202803415 0.4000000000000001 0.4 0.4956708580912724 0.5767766952966369 0.6309698831278217 0.6499999999999999 0.6309698831278217 0.5767766952966369 0.4956708580912725 0.4000000000000001 0.4 0.4986063948945004 0.5892242861094592 0.6645123510239904 0.7183711983740815 0.7464375046583265 0.7464375046583265 0.7183711983740815 0.6645123510239904 0.5892242861094591 0.49860639489450054 0.4000000000000001 0.4 0.5001344202803415 0.5952476826029012 0.6805704108364301 0.7518241671106134 0.8054359905560886 0.8387175604818207 0.85 0.8387175604818207 0.8054359905560886 0.7518241671106134 0.6805704108364301 0.5952476826029012 0.5001344202803415 0.4000000000000001;
             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4],
            [0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994 0.44999999999999996 0.43096988312782164 0.3767766952966369 0.29567085809127247 0.20000000000000004 0.10432914190872761 0.023223304703363173 -0.030969883127821618 -0.04999999999999993 0.55 0.5358225407650741 0.4944387364909134 0.42920125688084976 0.3453952545506602 0.24981019339564986 0.15018980660435027 0.0546047454493398 -0.029201256880849707 -0.09443873649091344 -0.135822540765074 -0.14999999999999997 0.6499999999999999 0.6387175604818206 0.6054359905560887 0.5518241671106134 0.4805704108364301 0.39524768260290116 0.3001344202803415 0.20000000000000004 0.09986557971965856 0.0047523173970988875 -0.08057041083643002 -0.1518241671106133 -0.20543599055608852 -0.23871756048182058 -0.24999999999999994;
             0.4 0.4956708580912724 0.5767766952966369 0.6309698831278217 0.6499999999999999 0.6309698831278217 0.5767766952966369 0.4956708580912725 0.4000000000000001 0.4 0.4986063948945004 0.5892242861094592 0.6645123510239904 0.7183711983740815 0.7464375046583265 0.7464375046583265 0.7183711983740815 0.6645123510239904 0.5892242861094591 0.49860639489450054 0.4000000000000001 0.4 0.5001344202803415 0.5952476826029012 0.6805704108364301 0.7518241671106134 0.8054359905560886 0.8387175604818207 0.85 0.8387175604818207 0.8054359905560886 0.7518241671106134 0.6805704108364301 0.5952476826029012 0.5001344202803415 0.4000000000000001 0.3292893218813453 0.4249601799726177 0.5060660171779822 0.5602592050091669 0.5792893218813452 0.5602592050091669 0.5060660171779822 0.4249601799726177 0.3292893218813453 0.3292893218813453 0.4278957167758457 0.5185136079908045 0.5938016729053357 0.6476605202554268 0.6757268265396718 0.6757268265396718 0.6476605202554268 0.5938016729053357 0.5185136079908044 0.4278957167758458 0.3292893218813453 0.3292893218813453 0.4294237421616868 0.5245370044842464 0.6098597327177754 0.6811134889919587 0.7347253124374339 0.7680068823631659 0.7792893218813453 0.7680068823631659 0.7347253124374339 0.6811134889919587 0.6098597327177754 0.5245370044842464 0.4294237421616868 0.3292893218813453 0.2585786437626905 0.3542495018539629 0.4353553390593274 0.48954852689051215 0.5085786437626905 0.48954852689051215 0.4353553390593274 0.354249501853963 0.2585786437626906 0.2585786437626905 0.3571850386571909 0.4478029298721497 0.5230909947866809 0.576949842136772 0.605016148421017 0.605016148421017 0.576949842136772 0.5230909947866809 0.4478029298721496 0.35718503865719103 0.2585786437626906 0.2585786437626905 0.358713064043032 0.45382632636559167 0.5391490545991207 0.610402810873304 0.6640146343187792 0.6972962042445112 0.7085786437626904 0.6972962042445112 0.6640146343187792 0.610402810873304 0.5391490545991207 0.45382632636559167 0.358713064043032 0.2585786437626906 0.18786796564403574 0.28353882373530814 0.3646446609406726 0.41883784877185737 0.43786796564403563 0.41883784877185737 0.3646446609406726 0.2835388237353082 0.1878679656440358 0.18786796564403574 0.28647436053853614 0.3770922517534949 0.45238031666802614 0.5062391640181172 0.5343054703023622 0.5343054703023622 0.5062391640181172 0.45238031666802614 0.3770922517534948 0.28647436053853625 0.1878679656440358 0.18786796564403574 0.2880023859243772 0.3831156482469369 0.4684383764804658 0.5396921327546491 0.5933039562001243 0.6265855261258564 0.6378679656440357 0.6265855261258564 0.5933039562001243 0.5396921327546491 0.4684383764804658 0.3831156482469369 0.2880023859243772 0.1878679656440358 0.11715728752538102 0.21282814561665342 0.2939339828220179 0.34812717065320264 0.3671572875253809 0.34812717065320264 0.2939339828220179 0.21282814561665347 0.11715728752538107 0.11715728752538102 0.21576368241988142 0.3063815736348402 0.3816696385493714 0.43552848589946247 0.46359479218370747 0.46359479218370747 0.43552848589946247 0.3816696385493714 0.3063815736348401 0.21576368241988153 0.11715728752538107 0.11715728752538102 0.2172917078057225 0.31240497012828217 0.3977276983618111 0.4689814546359944 0.5225932780814696 0.5558748480072017 0.567157287525381 0.5558748480072017 0.5225932780814696 0.4689814546359944 0.3977276983618111 0.31240497012828217 0.2172917078057225 0.11715728752538107;
             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.07071067811865475 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.1414213562373095 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.21213203435596428 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619 0.282842712474619]
        ]

        @testset "Direction $i" for i in eachindex(directions)
            shape = extrude_geometry(geometry; direction=directions[i], particle_spacing,
                                     n_extrude=5, place_on_shell=true, density=1.0)

            @test shape.coordinates ≈ expected_coords[i]
        end
    end

    @testset verbose=true "Extrude 3D Plane" begin
        p1 = [0.0, 0.0, 0.0]
        p2 = [0.5, 1.0, 1.0]
        p3 = [1.0, 0.2, 0.0]

        direction = [0.0, 0.0, 1.0]

        expected_coords = [0.0 0.09805806756909202 0.19611613513818404 0.29417420270727607 0.3922322702763681 0.49029033784546006 0.5883484054145521 0.6864064729836441 0.7844645405527362 0.8825226081218281 0.9805806756909201 0.03333333333333333 0.13139140090242535 0.22944946847151737 0.3275075360406094 0.4255656036097014 0.5236236711787934 0.6216817387478855 0.7197398063169774 0.8177978738860695 0.9158559414551615 1.0139140090242535 0.06666666666666667 0.16472473423575867 0.2627828018048507 0.3608408693739427 0.45889893694303474 0.5569570045121267 0.6550150720812188 0.7530731396503108 0.8511312072194028 0.9491892747884948 1.0472473423575868 0.1 0.19805806756909203 0.296116135138184 0.3941742027072761 0.49223227027636807 0.59029033784546 0.6883484054145521 0.7864064729836441 0.8844645405527362 0.9825226081218281 1.0805806756909202 0.13333333333333333 0.23139140090242535 0.32944946847151735 0.4275075360406094 0.5255656036097014 0.6236236711787934 0.7216817387478854 0.8197398063169774 0.9177978738860695 1.0158559414551616 1.1139140090242534 0.16666666666666666 0.2647247342357587 0.3627828018048507 0.46084086937394275 0.5588989369430347 0.6569570045121267 0.7550150720812188 0.8530731396503107 0.9511312072194028 1.0491892747884948 1.1472473423575869 0.2 0.29805806756909203 0.39611613513818406 0.4941742027072761 0.592232270276368 0.6902903378454601 0.7883484054145522 0.8864064729836441 0.9844645405527361 1.0825226081218282 1.18058067569092 0.23333333333333334 0.33139140090242536 0.4294494684715174 0.5275075360406094 0.6255656036097015 0.7236236711787933 0.8216817387478854 0.9197398063169775 1.0177978738860696 1.1158559414551614 1.2139140090242535 0.26666666666666666 0.3647247342357587 0.4627828018048507 0.5608408693739427 0.6588989369430347 0.7569570045121268 0.8550150720812189 0.9530731396503107 1.0511312072194028 1.1491892747884949 1.2472473423575867 0.3 0.398058067569092 0.49611613513818403 0.5941742027072761 0.6922322702763681 0.79029033784546 0.8883484054145521 0.9864064729836441 1.0844645405527362 1.182522608121828 1.2805806756909202 0.3333333333333333 0.43139140090242534 0.5294494684715174 0.6275075360406094 0.7255656036097013 0.8236236711787934 0.9216817387478855 1.0197398063169774 1.1177978738860694 1.2158559414551615 1.3139140090242534 0.3666666666666667 0.4647247342357587 0.5627828018048507 0.6608408693739427 0.7588989369430348 0.8569570045121268 0.9550150720812188 1.0530731396503108 1.1511312072194029 1.249189274788495 1.3472473423575868 0.4 0.49805806756909204 0.5961161351381841 0.6941742027072761 0.7922322702763681 0.8902903378454601 0.9883484054145522 1.086406472983644 1.184464540552736 1.2825226081218282 1.3805806756909202 0.43333333333333335 0.5313914009024254 0.6294494684715174 0.7275075360406094 0.8255656036097014 0.9236236711787934 1.0216817387478856 1.1197398063169774 1.2177978738860695 1.3158559414551614 1.4139140090242535 0.4666666666666667 0.5647247342357586 0.6627828018048507 0.7608408693739428 0.8588989369430348 0.9569570045121267 1.0550150720812188 1.1530731396503109 1.251131207219403 1.3491892747884948 1.4472473423575867 0.5 0.5980580675690921 0.696116135138184 0.794174202707276 0.8922322702763681 0.9902903378454601 1.088348405414552 1.186406472983644 1.2844645405527362 1.3825226081218283 1.4805806756909201 0.0 0.09805806756909202 0.19611613513818404 0.29417420270727607 0.3922322702763681 0.49029033784546006 0.5883484054145521 0.6864064729836441 0.7844645405527362 0.8825226081218281 0.9805806756909201 0.03333333333333333 0.13139140090242535 0.22944946847151737 0.3275075360406094 0.4255656036097014 0.5236236711787934 0.6216817387478855 0.7197398063169774 0.8177978738860695 0.9158559414551615 1.0139140090242535 0.06666666666666667 0.16472473423575867 0.2627828018048507 0.3608408693739427 0.45889893694303474 0.5569570045121267 0.6550150720812188 0.7530731396503108 0.8511312072194028 0.9491892747884948 1.0472473423575868 0.1 0.19805806756909203 0.296116135138184 0.3941742027072761 0.49223227027636807 0.59029033784546 0.6883484054145521 0.7864064729836441 0.8844645405527362 0.9825226081218281 1.0805806756909202 0.13333333333333333 0.23139140090242535 0.32944946847151735 0.4275075360406094 0.5255656036097014 0.6236236711787934 0.7216817387478854 0.8197398063169774 0.9177978738860695 1.0158559414551616 1.1139140090242534 0.16666666666666666 0.2647247342357587 0.3627828018048507 0.46084086937394275 0.5588989369430347 0.6569570045121267 0.7550150720812188 0.8530731396503107 0.9511312072194028 1.0491892747884948 1.1472473423575869 0.2 0.29805806756909203 0.39611613513818406 0.4941742027072761 0.592232270276368 0.6902903378454601 0.7883484054145522 0.8864064729836441 0.9844645405527361 1.0825226081218282 1.18058067569092 0.23333333333333334 0.33139140090242536 0.4294494684715174 0.5275075360406094 0.6255656036097015 0.7236236711787933 0.8216817387478854 0.9197398063169775 1.0177978738860696 1.1158559414551614 1.2139140090242535 0.26666666666666666 0.3647247342357587 0.4627828018048507 0.5608408693739427 0.6588989369430347 0.7569570045121268 0.8550150720812189 0.9530731396503107 1.0511312072194028 1.1491892747884949 1.2472473423575867 0.3 0.398058067569092 0.49611613513818403 0.5941742027072761 0.6922322702763681 0.79029033784546 0.8883484054145521 0.9864064729836441 1.0844645405527362 1.182522608121828 1.2805806756909202 0.3333333333333333 0.43139140090242534 0.5294494684715174 0.6275075360406094 0.7255656036097013 0.8236236711787934 0.9216817387478855 1.0197398063169774 1.1177978738860694 1.2158559414551615 1.3139140090242534 0.3666666666666667 0.4647247342357587 0.5627828018048507 0.6608408693739427 0.7588989369430348 0.8569570045121268 0.9550150720812188 1.0530731396503108 1.1511312072194029 1.249189274788495 1.3472473423575868 0.4 0.49805806756909204 0.5961161351381841 0.6941742027072761 0.7922322702763681 0.8902903378454601 0.9883484054145522 1.086406472983644 1.184464540552736 1.2825226081218282 1.3805806756909202 0.43333333333333335 0.5313914009024254 0.6294494684715174 0.7275075360406094 0.8255656036097014 0.9236236711787934 1.0216817387478856 1.1197398063169774 1.2177978738860695 1.3158559414551614 1.4139140090242535 0.4666666666666667 0.5647247342357586 0.6627828018048507 0.7608408693739428 0.8588989369430348 0.9569570045121267 1.0550150720812188 1.1530731396503109 1.251131207219403 1.3491892747884948 1.4472473423575867 0.5 0.5980580675690921 0.696116135138184 0.794174202707276 0.8922322702763681 0.9902903378454601 1.088348405414552 1.186406472983644 1.2844645405527362 1.3825226081218283 1.4805806756909201 0.0 0.09805806756909202 0.19611613513818404 0.29417420270727607 0.3922322702763681 0.49029033784546006 0.5883484054145521 0.6864064729836441 0.7844645405527362 0.8825226081218281 0.9805806756909201 0.03333333333333333 0.13139140090242535 0.22944946847151737 0.3275075360406094 0.4255656036097014 0.5236236711787934 0.6216817387478855 0.7197398063169774 0.8177978738860695 0.9158559414551615 1.0139140090242535 0.06666666666666667 0.16472473423575867 0.2627828018048507 0.3608408693739427 0.45889893694303474 0.5569570045121267 0.6550150720812188 0.7530731396503108 0.8511312072194028 0.9491892747884948 1.0472473423575868 0.1 0.19805806756909203 0.296116135138184 0.3941742027072761 0.49223227027636807 0.59029033784546 0.6883484054145521 0.7864064729836441 0.8844645405527362 0.9825226081218281 1.0805806756909202 0.13333333333333333 0.23139140090242535 0.32944946847151735 0.4275075360406094 0.5255656036097014 0.6236236711787934 0.7216817387478854 0.8197398063169774 0.9177978738860695 1.0158559414551616 1.1139140090242534 0.16666666666666666 0.2647247342357587 0.3627828018048507 0.46084086937394275 0.5588989369430347 0.6569570045121267 0.7550150720812188 0.8530731396503107 0.9511312072194028 1.0491892747884948 1.1472473423575869 0.2 0.29805806756909203 0.39611613513818406 0.4941742027072761 0.592232270276368 0.6902903378454601 0.7883484054145522 0.8864064729836441 0.9844645405527361 1.0825226081218282 1.18058067569092 0.23333333333333334 0.33139140090242536 0.4294494684715174 0.5275075360406094 0.6255656036097015 0.7236236711787933 0.8216817387478854 0.9197398063169775 1.0177978738860696 1.1158559414551614 1.2139140090242535 0.26666666666666666 0.3647247342357587 0.4627828018048507 0.5608408693739427 0.6588989369430347 0.7569570045121268 0.8550150720812189 0.9530731396503107 1.0511312072194028 1.1491892747884949 1.2472473423575867 0.3 0.398058067569092 0.49611613513818403 0.5941742027072761 0.6922322702763681 0.79029033784546 0.8883484054145521 0.9864064729836441 1.0844645405527362 1.182522608121828 1.2805806756909202 0.3333333333333333 0.43139140090242534 0.5294494684715174 0.6275075360406094 0.7255656036097013 0.8236236711787934 0.9216817387478855 1.0197398063169774 1.1177978738860694 1.2158559414551615 1.3139140090242534 0.3666666666666667 0.4647247342357587 0.5627828018048507 0.6608408693739427 0.7588989369430348 0.8569570045121268 0.9550150720812188 1.0530731396503108 1.1511312072194029 1.249189274788495 1.3472473423575868 0.4 0.49805806756909204 0.5961161351381841 0.6941742027072761 0.7922322702763681 0.8902903378454601 0.9883484054145522 1.086406472983644 1.184464540552736 1.2825226081218282 1.3805806756909202 0.43333333333333335 0.5313914009024254 0.6294494684715174 0.7275075360406094 0.8255656036097014 0.9236236711787934 1.0216817387478856 1.1197398063169774 1.2177978738860695 1.3158559414551614 1.4139140090242535 0.4666666666666667 0.5647247342357586 0.6627828018048507 0.7608408693739428 0.8588989369430348 0.9569570045121267 1.0550150720812188 1.1530731396503109 1.251131207219403 1.3491892747884948 1.4472473423575867 0.5 0.5980580675690921 0.696116135138184 0.794174202707276 0.8922322702763681 0.9902903378454601 1.088348405414552 1.186406472983644 1.2844645405527362 1.3825226081218283 1.4805806756909201 0.0 0.09805806756909202 0.19611613513818404 0.29417420270727607 0.3922322702763681 0.49029033784546006 0.5883484054145521 0.6864064729836441 0.7844645405527362 0.8825226081218281 0.9805806756909201 0.03333333333333333 0.13139140090242535 0.22944946847151737 0.3275075360406094 0.4255656036097014 0.5236236711787934 0.6216817387478855 0.7197398063169774 0.8177978738860695 0.9158559414551615 1.0139140090242535 0.06666666666666667 0.16472473423575867 0.2627828018048507 0.3608408693739427 0.45889893694303474 0.5569570045121267 0.6550150720812188 0.7530731396503108 0.8511312072194028 0.9491892747884948 1.0472473423575868 0.1 0.19805806756909203 0.296116135138184 0.3941742027072761 0.49223227027636807 0.59029033784546 0.6883484054145521 0.7864064729836441 0.8844645405527362 0.9825226081218281 1.0805806756909202 0.13333333333333333 0.23139140090242535 0.32944946847151735 0.4275075360406094 0.5255656036097014 0.6236236711787934 0.7216817387478854 0.8197398063169774 0.9177978738860695 1.0158559414551616 1.1139140090242534 0.16666666666666666 0.2647247342357587 0.3627828018048507 0.46084086937394275 0.5588989369430347 0.6569570045121267 0.7550150720812188 0.8530731396503107 0.9511312072194028 1.0491892747884948 1.1472473423575869 0.2 0.29805806756909203 0.39611613513818406 0.4941742027072761 0.592232270276368 0.6902903378454601 0.7883484054145522 0.8864064729836441 0.9844645405527361 1.0825226081218282 1.18058067569092 0.23333333333333334 0.33139140090242536 0.4294494684715174 0.5275075360406094 0.6255656036097015 0.7236236711787933 0.8216817387478854 0.9197398063169775 1.0177978738860696 1.1158559414551614 1.2139140090242535 0.26666666666666666 0.3647247342357587 0.4627828018048507 0.5608408693739427 0.6588989369430347 0.7569570045121268 0.8550150720812189 0.9530731396503107 1.0511312072194028 1.1491892747884949 1.2472473423575867 0.3 0.398058067569092 0.49611613513818403 0.5941742027072761 0.6922322702763681 0.79029033784546 0.8883484054145521 0.9864064729836441 1.0844645405527362 1.182522608121828 1.2805806756909202 0.3333333333333333 0.43139140090242534 0.5294494684715174 0.6275075360406094 0.7255656036097013 0.8236236711787934 0.9216817387478855 1.0197398063169774 1.1177978738860694 1.2158559414551615 1.3139140090242534 0.3666666666666667 0.4647247342357587 0.5627828018048507 0.6608408693739427 0.7588989369430348 0.8569570045121268 0.9550150720812188 1.0530731396503108 1.1511312072194029 1.249189274788495 1.3472473423575868 0.4 0.49805806756909204 0.5961161351381841 0.6941742027072761 0.7922322702763681 0.8902903378454601 0.9883484054145522 1.086406472983644 1.184464540552736 1.2825226081218282 1.3805806756909202 0.43333333333333335 0.5313914009024254 0.6294494684715174 0.7275075360406094 0.8255656036097014 0.9236236711787934 1.0216817387478856 1.1197398063169774 1.2177978738860695 1.3158559414551614 1.4139140090242535 0.4666666666666667 0.5647247342357586 0.6627828018048507 0.7608408693739428 0.8588989369430348 0.9569570045121267 1.0550150720812188 1.1530731396503109 1.251131207219403 1.3491892747884948 1.4472473423575867 0.5 0.5980580675690921 0.696116135138184 0.794174202707276 0.8922322702763681 0.9902903378454601 1.088348405414552 1.186406472983644 1.2844645405527362 1.3825226081218283 1.4805806756909201;
                           0.0 0.019611613513818404 0.03922322702763681 0.05883484054145522 0.07844645405527362 0.09805806756909202 0.11766968108291044 0.13728129459672883 0.15689290811054724 0.17650452162436564 0.19611613513818404 0.06666666666666667 0.08627828018048507 0.10588989369430347 0.1255015072081219 0.14511312072194027 0.16472473423575867 0.1843363477495771 0.20394796126339548 0.2235595747772139 0.2431711882910323 0.2627828018048507 0.13333333333333333 0.15294494684715174 0.17255656036097014 0.19216817387478854 0.21177978738860695 0.23139140090242535 0.2510030144162438 0.2706146279300622 0.29022624144388054 0.309837854957699 0.32944946847151735 0.2 0.21961161351381842 0.23922322702763682 0.2588348405414552 0.27844645405527363 0.29805806756909203 0.31766968108291044 0.33728129459672884 0.35689290811054725 0.37650452162436565 0.39611613513818406 0.26666666666666666 0.28627828018048507 0.30588989369430347 0.3255015072081219 0.3451131207219403 0.3647247342357587 0.3843363477495771 0.4039479612633955 0.4235595747772139 0.4431711882910323 0.4627828018048507 0.3333333333333333 0.3529449468471517 0.3725565603609701 0.39216817387478853 0.41177978738860693 0.43139140090242534 0.45100301441624374 0.47061462793006215 0.49022624144388055 0.509837854957699 0.5294494684715174 0.4 0.4196116135138184 0.43922322702763683 0.45883484054145524 0.47844645405527364 0.49805806756909204 0.5176696810829104 0.5372812945967289 0.5568929081105473 0.5765045216243656 0.5961161351381841 0.4666666666666667 0.4862782801804851 0.5058898936943035 0.5255015072081219 0.5451131207219403 0.5647247342357586 0.5843363477495771 0.6039479612633956 0.6235595747772139 0.6431711882910323 0.6627828018048507 0.5333333333333333 0.5529449468471517 0.5725565603609701 0.5921681738747886 0.6117797873886069 0.6313914009024253 0.6510030144162438 0.6706146279300622 0.6902262414438806 0.7098378549576989 0.7294494684715174 0.6 0.6196116135138183 0.6392232270276368 0.6588348405414552 0.6784464540552736 0.698058067569092 0.7176696810829104 0.7372812945967289 0.7568929081105472 0.7765045216243656 0.796116135138184 0.6666666666666666 0.686278280180485 0.7058898936943034 0.7255015072081219 0.7451131207219402 0.7647247342357586 0.7843363477495771 0.8039479612633955 0.8235595747772139 0.8431711882910322 0.8627828018048507 0.7333333333333334 0.7529449468471519 0.7725565603609702 0.7921681738747887 0.811779787388607 0.8313914009024255 0.8510030144162438 0.8706146279300622 0.8902262414438806 0.9098378549576991 0.9294494684715174 0.8 0.8196116135138185 0.8392232270276369 0.8588348405414553 0.8784464540552737 0.8980580675690921 0.9176696810829105 0.9372812945967288 0.9568929081105473 0.9765045216243657 0.9961161351381841 0.8666666666666667 0.8862782801804852 0.9058898936943035 0.925501507208122 0.9451131207219403 0.9647247342357588 0.9843363477495771 1.0039479612633955 1.023559574777214 1.0431711882910324 1.0627828018048509 0.9333333333333333 0.9529449468471518 0.9725565603609702 0.9921681738747886 1.011779787388607 1.0313914009024254 1.0510030144162439 1.0706146279300621 1.0902262414438806 1.109837854957699 1.1294494684715173 1.0 1.0196116135138185 1.039223227027637 1.0588348405414552 1.0784464540552736 1.098058067569092 1.1176696810829105 1.1372812945967288 1.1568929081105472 1.1765045216243657 1.1961161351381842 0.0 0.019611613513818404 0.03922322702763681 0.05883484054145522 0.07844645405527362 0.09805806756909202 0.11766968108291044 0.13728129459672883 0.15689290811054724 0.17650452162436564 0.19611613513818404 0.06666666666666667 0.08627828018048507 0.10588989369430347 0.1255015072081219 0.14511312072194027 0.16472473423575867 0.1843363477495771 0.20394796126339548 0.2235595747772139 0.2431711882910323 0.2627828018048507 0.13333333333333333 0.15294494684715174 0.17255656036097014 0.19216817387478854 0.21177978738860695 0.23139140090242535 0.2510030144162438 0.2706146279300622 0.29022624144388054 0.309837854957699 0.32944946847151735 0.2 0.21961161351381842 0.23922322702763682 0.2588348405414552 0.27844645405527363 0.29805806756909203 0.31766968108291044 0.33728129459672884 0.35689290811054725 0.37650452162436565 0.39611613513818406 0.26666666666666666 0.28627828018048507 0.30588989369430347 0.3255015072081219 0.3451131207219403 0.3647247342357587 0.3843363477495771 0.4039479612633955 0.4235595747772139 0.4431711882910323 0.4627828018048507 0.3333333333333333 0.3529449468471517 0.3725565603609701 0.39216817387478853 0.41177978738860693 0.43139140090242534 0.45100301441624374 0.47061462793006215 0.49022624144388055 0.509837854957699 0.5294494684715174 0.4 0.4196116135138184 0.43922322702763683 0.45883484054145524 0.47844645405527364 0.49805806756909204 0.5176696810829104 0.5372812945967289 0.5568929081105473 0.5765045216243656 0.5961161351381841 0.4666666666666667 0.4862782801804851 0.5058898936943035 0.5255015072081219 0.5451131207219403 0.5647247342357586 0.5843363477495771 0.6039479612633956 0.6235595747772139 0.6431711882910323 0.6627828018048507 0.5333333333333333 0.5529449468471517 0.5725565603609701 0.5921681738747886 0.6117797873886069 0.6313914009024253 0.6510030144162438 0.6706146279300622 0.6902262414438806 0.7098378549576989 0.7294494684715174 0.6 0.6196116135138183 0.6392232270276368 0.6588348405414552 0.6784464540552736 0.698058067569092 0.7176696810829104 0.7372812945967289 0.7568929081105472 0.7765045216243656 0.796116135138184 0.6666666666666666 0.686278280180485 0.7058898936943034 0.7255015072081219 0.7451131207219402 0.7647247342357586 0.7843363477495771 0.8039479612633955 0.8235595747772139 0.8431711882910322 0.8627828018048507 0.7333333333333334 0.7529449468471519 0.7725565603609702 0.7921681738747887 0.811779787388607 0.8313914009024255 0.8510030144162438 0.8706146279300622 0.8902262414438806 0.9098378549576991 0.9294494684715174 0.8 0.8196116135138185 0.8392232270276369 0.8588348405414553 0.8784464540552737 0.8980580675690921 0.9176696810829105 0.9372812945967288 0.9568929081105473 0.9765045216243657 0.9961161351381841 0.8666666666666667 0.8862782801804852 0.9058898936943035 0.925501507208122 0.9451131207219403 0.9647247342357588 0.9843363477495771 1.0039479612633955 1.023559574777214 1.0431711882910324 1.0627828018048509 0.9333333333333333 0.9529449468471518 0.9725565603609702 0.9921681738747886 1.011779787388607 1.0313914009024254 1.0510030144162439 1.0706146279300621 1.0902262414438806 1.109837854957699 1.1294494684715173 1.0 1.0196116135138185 1.039223227027637 1.0588348405414552 1.0784464540552736 1.098058067569092 1.1176696810829105 1.1372812945967288 1.1568929081105472 1.1765045216243657 1.1961161351381842 0.0 0.019611613513818404 0.03922322702763681 0.05883484054145522 0.07844645405527362 0.09805806756909202 0.11766968108291044 0.13728129459672883 0.15689290811054724 0.17650452162436564 0.19611613513818404 0.06666666666666667 0.08627828018048507 0.10588989369430347 0.1255015072081219 0.14511312072194027 0.16472473423575867 0.1843363477495771 0.20394796126339548 0.2235595747772139 0.2431711882910323 0.2627828018048507 0.13333333333333333 0.15294494684715174 0.17255656036097014 0.19216817387478854 0.21177978738860695 0.23139140090242535 0.2510030144162438 0.2706146279300622 0.29022624144388054 0.309837854957699 0.32944946847151735 0.2 0.21961161351381842 0.23922322702763682 0.2588348405414552 0.27844645405527363 0.29805806756909203 0.31766968108291044 0.33728129459672884 0.35689290811054725 0.37650452162436565 0.39611613513818406 0.26666666666666666 0.28627828018048507 0.30588989369430347 0.3255015072081219 0.3451131207219403 0.3647247342357587 0.3843363477495771 0.4039479612633955 0.4235595747772139 0.4431711882910323 0.4627828018048507 0.3333333333333333 0.3529449468471517 0.3725565603609701 0.39216817387478853 0.41177978738860693 0.43139140090242534 0.45100301441624374 0.47061462793006215 0.49022624144388055 0.509837854957699 0.5294494684715174 0.4 0.4196116135138184 0.43922322702763683 0.45883484054145524 0.47844645405527364 0.49805806756909204 0.5176696810829104 0.5372812945967289 0.5568929081105473 0.5765045216243656 0.5961161351381841 0.4666666666666667 0.4862782801804851 0.5058898936943035 0.5255015072081219 0.5451131207219403 0.5647247342357586 0.5843363477495771 0.6039479612633956 0.6235595747772139 0.6431711882910323 0.6627828018048507 0.5333333333333333 0.5529449468471517 0.5725565603609701 0.5921681738747886 0.6117797873886069 0.6313914009024253 0.6510030144162438 0.6706146279300622 0.6902262414438806 0.7098378549576989 0.7294494684715174 0.6 0.6196116135138183 0.6392232270276368 0.6588348405414552 0.6784464540552736 0.698058067569092 0.7176696810829104 0.7372812945967289 0.7568929081105472 0.7765045216243656 0.796116135138184 0.6666666666666666 0.686278280180485 0.7058898936943034 0.7255015072081219 0.7451131207219402 0.7647247342357586 0.7843363477495771 0.8039479612633955 0.8235595747772139 0.8431711882910322 0.8627828018048507 0.7333333333333334 0.7529449468471519 0.7725565603609702 0.7921681738747887 0.811779787388607 0.8313914009024255 0.8510030144162438 0.8706146279300622 0.8902262414438806 0.9098378549576991 0.9294494684715174 0.8 0.8196116135138185 0.8392232270276369 0.8588348405414553 0.8784464540552737 0.8980580675690921 0.9176696810829105 0.9372812945967288 0.9568929081105473 0.9765045216243657 0.9961161351381841 0.8666666666666667 0.8862782801804852 0.9058898936943035 0.925501507208122 0.9451131207219403 0.9647247342357588 0.9843363477495771 1.0039479612633955 1.023559574777214 1.0431711882910324 1.0627828018048509 0.9333333333333333 0.9529449468471518 0.9725565603609702 0.9921681738747886 1.011779787388607 1.0313914009024254 1.0510030144162439 1.0706146279300621 1.0902262414438806 1.109837854957699 1.1294494684715173 1.0 1.0196116135138185 1.039223227027637 1.0588348405414552 1.0784464540552736 1.098058067569092 1.1176696810829105 1.1372812945967288 1.1568929081105472 1.1765045216243657 1.1961161351381842 0.0 0.019611613513818404 0.03922322702763681 0.05883484054145522 0.07844645405527362 0.09805806756909202 0.11766968108291044 0.13728129459672883 0.15689290811054724 0.17650452162436564 0.19611613513818404 0.06666666666666667 0.08627828018048507 0.10588989369430347 0.1255015072081219 0.14511312072194027 0.16472473423575867 0.1843363477495771 0.20394796126339548 0.2235595747772139 0.2431711882910323 0.2627828018048507 0.13333333333333333 0.15294494684715174 0.17255656036097014 0.19216817387478854 0.21177978738860695 0.23139140090242535 0.2510030144162438 0.2706146279300622 0.29022624144388054 0.309837854957699 0.32944946847151735 0.2 0.21961161351381842 0.23922322702763682 0.2588348405414552 0.27844645405527363 0.29805806756909203 0.31766968108291044 0.33728129459672884 0.35689290811054725 0.37650452162436565 0.39611613513818406 0.26666666666666666 0.28627828018048507 0.30588989369430347 0.3255015072081219 0.3451131207219403 0.3647247342357587 0.3843363477495771 0.4039479612633955 0.4235595747772139 0.4431711882910323 0.4627828018048507 0.3333333333333333 0.3529449468471517 0.3725565603609701 0.39216817387478853 0.41177978738860693 0.43139140090242534 0.45100301441624374 0.47061462793006215 0.49022624144388055 0.509837854957699 0.5294494684715174 0.4 0.4196116135138184 0.43922322702763683 0.45883484054145524 0.47844645405527364 0.49805806756909204 0.5176696810829104 0.5372812945967289 0.5568929081105473 0.5765045216243656 0.5961161351381841 0.4666666666666667 0.4862782801804851 0.5058898936943035 0.5255015072081219 0.5451131207219403 0.5647247342357586 0.5843363477495771 0.6039479612633956 0.6235595747772139 0.6431711882910323 0.6627828018048507 0.5333333333333333 0.5529449468471517 0.5725565603609701 0.5921681738747886 0.6117797873886069 0.6313914009024253 0.6510030144162438 0.6706146279300622 0.6902262414438806 0.7098378549576989 0.7294494684715174 0.6 0.6196116135138183 0.6392232270276368 0.6588348405414552 0.6784464540552736 0.698058067569092 0.7176696810829104 0.7372812945967289 0.7568929081105472 0.7765045216243656 0.796116135138184 0.6666666666666666 0.686278280180485 0.7058898936943034 0.7255015072081219 0.7451131207219402 0.7647247342357586 0.7843363477495771 0.8039479612633955 0.8235595747772139 0.8431711882910322 0.8627828018048507 0.7333333333333334 0.7529449468471519 0.7725565603609702 0.7921681738747887 0.811779787388607 0.8313914009024255 0.8510030144162438 0.8706146279300622 0.8902262414438806 0.9098378549576991 0.9294494684715174 0.8 0.8196116135138185 0.8392232270276369 0.8588348405414553 0.8784464540552737 0.8980580675690921 0.9176696810829105 0.9372812945967288 0.9568929081105473 0.9765045216243657 0.9961161351381841 0.8666666666666667 0.8862782801804852 0.9058898936943035 0.925501507208122 0.9451131207219403 0.9647247342357588 0.9843363477495771 1.0039479612633955 1.023559574777214 1.0431711882910324 1.0627828018048509 0.9333333333333333 0.9529449468471518 0.9725565603609702 0.9921681738747886 1.011779787388607 1.0313914009024254 1.0510030144162439 1.0706146279300621 1.0902262414438806 1.109837854957699 1.1294494684715173 1.0 1.0196116135138185 1.039223227027637 1.0588348405414552 1.0784464540552736 1.098058067569092 1.1176696810829105 1.1372812945967288 1.1568929081105472 1.1765045216243657 1.1961161351381842;
                           0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.06666666666666667 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.13333333333333333 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.3333333333333333 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.6666666666666666 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.16666666666666669 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.23333333333333334 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.7666666666666666 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.26666666666666666 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.33333333333333337 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.4666666666666667 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.5333333333333333 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6000000000000001 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.6666666666666667 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.7333333333333334 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.8666666666666667 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 0.9333333333333333 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.0666666666666667 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.1333333333333333 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.30000000000000004 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.3666666666666667 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.43333333333333335 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.5666666666666667 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.6333333333333333 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7000000000000001 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.7666666666666667 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.8333333333333334 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 0.9666666666666667 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.0333333333333334 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.1666666666666667 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.2333333333333334 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3]

        shape = extrude_geometry((p1, p2, p3); direction, particle_spacing=0.1, n_extrude=4,
                                 density=1000.0, place_on_shell=true)

        @test shape.coordinates ≈ expected_coords
    end

    @testset verbose=true "Shifted Particles" begin
        p1 = [0.0, 0.0, 0.0]
        p2 = [0.5, 1.0, 0.0]
        p3 = [1.0, 0.2, 0.0]

        direction = [0.0, 0.0, 1.0]

        expected_coords = [0.0713897135595439 0.16944778112863593 0.267505848697728 0.36556391626682005 0.463621983835912 0.561680051405004 0.6597381189740962 0.7577961865431881 0.8558542541122801 0.9539123216813722 0.11611107310953969 0.21416914067863171 0.31222720824772376 0.41028527581681584 0.5083433433859078 0.6064014109549998 0.704459478524092 0.8025175460931839 0.9005756136622759 0.998633681231368 0.1608324326595355 0.25889050022862753 0.35694856779771955 0.45500663536681163 0.5530647029359036 0.6511227705049956 0.7491808380740878 0.8472389056431797 0.9452969732122717 1.0433550407813637 0.2055537922095313 0.3036118597786233 0.40166992734771534 0.4997279949168074 0.5977860624858994 0.6958441300549913 0.7939021976240835 0.8919602651931755 0.9900183327622675 1.0880764003313597 0.2502751517595271 0.3483332193286191 0.4463912868977111 0.5444493544668032 0.6425074220358952 0.7405654896049871 0.8386235571740793 0.9366816247431713 1.0347396923122631 1.1327977598813552 0.29499651130952287 0.3930545788786149 0.4911126464477069 0.589170714016799 0.687228781585891 0.7852868491549829 0.8833449167240751 0.9814029842931671 1.0794610518622592 1.1775191194313512 0.33971787085951866 0.4377759384286107 0.5358340059977027 0.6338920735667948 0.7319501411358867 0.8300082087049787 0.9280662762740709 1.0261243438431629 1.1241824114122547 1.2222404789813468 0.38443923040951444 0.48249729797860647 0.5805553655476985 0.6786134331167906 0.7766715006858825 0.8747295682549745 0.9727876358240667 1.0708457033931587 1.1689037709622507 1.2669618385313428 0.42916058995951023 0.5272186575286022 0.6252767250976943 0.7233347926667864 0.8213928602358783 0.9194509278049703 1.0175089953740626 1.1155670629431544 1.2136251305122463 1.3116831980813384 0.473881949509506 0.571940017078598 0.6699980846476901 0.7680561522167821 0.8661142197858741 0.9641722873549661 1.0622303549240582 1.1602884224931502 1.2583464900622423 1.3564045576313344 0.5186033090595018 0.6166613766285938 0.7147194441976858 0.8127775117667779 0.9108355793358699 1.0088936469049619 1.1069517144740542 1.205009782043146 1.3030678496122379 1.40112591718133 0.0713897135595439 0.16944778112863593 0.267505848697728 0.36556391626682005 0.463621983835912 0.561680051405004 0.6597381189740962 0.7577961865431881 0.8558542541122801 0.9539123216813722 0.11611107310953969 0.21416914067863171 0.31222720824772376 0.41028527581681584 0.5083433433859078 0.6064014109549998 0.704459478524092 0.8025175460931839 0.9005756136622759 0.998633681231368 0.1608324326595355 0.25889050022862753 0.35694856779771955 0.45500663536681163 0.5530647029359036 0.6511227705049956 0.7491808380740878 0.8472389056431797 0.9452969732122717 1.0433550407813637 0.2055537922095313 0.3036118597786233 0.40166992734771534 0.4997279949168074 0.5977860624858994 0.6958441300549913 0.7939021976240835 0.8919602651931755 0.9900183327622675 1.0880764003313597 0.2502751517595271 0.3483332193286191 0.4463912868977111 0.5444493544668032 0.6425074220358952 0.7405654896049871 0.8386235571740793 0.9366816247431713 1.0347396923122631 1.1327977598813552 0.29499651130952287 0.3930545788786149 0.4911126464477069 0.589170714016799 0.687228781585891 0.7852868491549829 0.8833449167240751 0.9814029842931671 1.0794610518622592 1.1775191194313512 0.33971787085951866 0.4377759384286107 0.5358340059977027 0.6338920735667948 0.7319501411358867 0.8300082087049787 0.9280662762740709 1.0261243438431629 1.1241824114122547 1.2222404789813468 0.38443923040951444 0.48249729797860647 0.5805553655476985 0.6786134331167906 0.7766715006858825 0.8747295682549745 0.9727876358240667 1.0708457033931587 1.1689037709622507 1.2669618385313428 0.42916058995951023 0.5272186575286022 0.6252767250976943 0.7233347926667864 0.8213928602358783 0.9194509278049703 1.0175089953740626 1.1155670629431544 1.2136251305122463 1.3116831980813384 0.473881949509506 0.571940017078598 0.6699980846476901 0.7680561522167821 0.8661142197858741 0.9641722873549661 1.0622303549240582 1.1602884224931502 1.2583464900622423 1.3564045576313344 0.5186033090595018 0.6166613766285938 0.7147194441976858 0.8127775117667779 0.9108355793358699 1.0088936469049619 1.1069517144740542 1.205009782043146 1.3030678496122379 1.40112591718133 0.0713897135595439 0.16944778112863593 0.267505848697728 0.36556391626682005 0.463621983835912 0.561680051405004 0.6597381189740962 0.7577961865431881 0.8558542541122801 0.9539123216813722 0.11611107310953969 0.21416914067863171 0.31222720824772376 0.41028527581681584 0.5083433433859078 0.6064014109549998 0.704459478524092 0.8025175460931839 0.9005756136622759 0.998633681231368 0.1608324326595355 0.25889050022862753 0.35694856779771955 0.45500663536681163 0.5530647029359036 0.6511227705049956 0.7491808380740878 0.8472389056431797 0.9452969732122717 1.0433550407813637 0.2055537922095313 0.3036118597786233 0.40166992734771534 0.4997279949168074 0.5977860624858994 0.6958441300549913 0.7939021976240835 0.8919602651931755 0.9900183327622675 1.0880764003313597 0.2502751517595271 0.3483332193286191 0.4463912868977111 0.5444493544668032 0.6425074220358952 0.7405654896049871 0.8386235571740793 0.9366816247431713 1.0347396923122631 1.1327977598813552 0.29499651130952287 0.3930545788786149 0.4911126464477069 0.589170714016799 0.687228781585891 0.7852868491549829 0.8833449167240751 0.9814029842931671 1.0794610518622592 1.1775191194313512 0.33971787085951866 0.4377759384286107 0.5358340059977027 0.6338920735667948 0.7319501411358867 0.8300082087049787 0.9280662762740709 1.0261243438431629 1.1241824114122547 1.2222404789813468 0.38443923040951444 0.48249729797860647 0.5805553655476985 0.6786134331167906 0.7766715006858825 0.8747295682549745 0.9727876358240667 1.0708457033931587 1.1689037709622507 1.2669618385313428 0.42916058995951023 0.5272186575286022 0.6252767250976943 0.7233347926667864 0.8213928602358783 0.9194509278049703 1.0175089953740626 1.1155670629431544 1.2136251305122463 1.3116831980813384 0.473881949509506 0.571940017078598 0.6699980846476901 0.7680561522167821 0.8661142197858741 0.9641722873549661 1.0622303549240582 1.1602884224931502 1.2583464900622423 1.3564045576313344 0.5186033090595018 0.6166613766285938 0.7147194441976858 0.8127775117667779 0.9108355793358699 1.0088936469049619 1.1069517144740542 1.205009782043146 1.3030678496122379 1.40112591718133 0.0713897135595439 0.16944778112863593 0.267505848697728 0.36556391626682005 0.463621983835912 0.561680051405004 0.6597381189740962 0.7577961865431881 0.8558542541122801 0.9539123216813722 0.11611107310953969 0.21416914067863171 0.31222720824772376 0.41028527581681584 0.5083433433859078 0.6064014109549998 0.704459478524092 0.8025175460931839 0.9005756136622759 0.998633681231368 0.1608324326595355 0.25889050022862753 0.35694856779771955 0.45500663536681163 0.5530647029359036 0.6511227705049956 0.7491808380740878 0.8472389056431797 0.9452969732122717 1.0433550407813637 0.2055537922095313 0.3036118597786233 0.40166992734771534 0.4997279949168074 0.5977860624858994 0.6958441300549913 0.7939021976240835 0.8919602651931755 0.9900183327622675 1.0880764003313597 0.2502751517595271 0.3483332193286191 0.4463912868977111 0.5444493544668032 0.6425074220358952 0.7405654896049871 0.8386235571740793 0.9366816247431713 1.0347396923122631 1.1327977598813552 0.29499651130952287 0.3930545788786149 0.4911126464477069 0.589170714016799 0.687228781585891 0.7852868491549829 0.8833449167240751 0.9814029842931671 1.0794610518622592 1.1775191194313512 0.33971787085951866 0.4377759384286107 0.5358340059977027 0.6338920735667948 0.7319501411358867 0.8300082087049787 0.9280662762740709 1.0261243438431629 1.1241824114122547 1.2222404789813468 0.38443923040951444 0.48249729797860647 0.5805553655476985 0.6786134331167906 0.7766715006858825 0.8747295682549745 0.9727876358240667 1.0708457033931587 1.1689037709622507 1.2669618385313428 0.42916058995951023 0.5272186575286022 0.6252767250976943 0.7233347926667864 0.8213928602358783 0.9194509278049703 1.0175089953740626 1.1155670629431544 1.2136251305122463 1.3116831980813384 0.473881949509506 0.571940017078598 0.6699980846476901 0.7680561522167821 0.8661142197858741 0.9641722873549661 1.0622303549240582 1.1602884224931502 1.2583464900622423 1.3564045576313344 0.5186033090595018 0.6166613766285938 0.7147194441976858 0.8127775117667779 0.9108355793358699 1.0088936469049619 1.1069517144740542 1.205009782043146 1.3030678496122379 1.40112591718133;
                           0.054527166306904996 0.07413877982072341 0.09375039333454181 0.11336200684836023 0.13297362036217864 0.15258523387599704 0.17219684738981544 0.19180846090363385 0.21142007441745225 0.23103168793127066 0.1439698854068966 0.163581498920715 0.1831931124345334 0.2028047259483518 0.2224163394621702 0.24202795297598861 0.261639566489807 0.2812511800036255 0.3008627935174438 0.3204744070312623 0.23341260450688817 0.25302421802070657 0.272635831534525 0.2922474450483434 0.3118590585621618 0.3314706720759802 0.3510822855897986 0.37069389910361705 0.3903055126174354 0.40991712613125386 0.3228553236068798 0.3424669371206982 0.3620785506345166 0.381690164148335 0.4013017776621534 0.4209133911759718 0.4405250046897903 0.4601366182036086 0.4797482317174271 0.49935984523124544 0.41229804270687137 0.4319096562206898 0.4515212697345082 0.4711328832483266 0.490744496762145 0.5103561102759634 0.5299677237897819 0.5495793373036002 0.5691909508174187 0.588802564331237 0.5017407618068629 0.5213523753206813 0.5409639888344997 0.5605756023483182 0.5801872158621365 0.599798829375955 0.6194104428897733 0.6390220564035918 0.6586336699174101 0.6782452834312286 0.5911834809068546 0.610795094420673 0.6304067079344914 0.6500183214483098 0.6696299349621282 0.6892415484759467 0.708853161989765 0.7284647755035835 0.7480763890174018 0.7676880025312203 0.6806262000068461 0.7002378135206646 0.719849427034483 0.7394610405483014 0.7590726540621198 0.7786842675759382 0.7982958810897566 0.817907494603575 0.8375191081173934 0.8571307216312118 0.7700689191068377 0.7896805326206562 0.8092921461344745 0.828903759648293 0.8485153731621113 0.8681269866759298 0.8877386001897482 0.9073502137035666 0.926961827217385 0.9465734407312034 0.8595116382068293 0.8791232517206478 0.8987348652344661 0.9183464787482846 0.9379580922621029 0.9575697057759214 0.9771813192897397 0.9967929328035582 1.0164045463173765 1.036016159831195 0.9489543573068209 0.9685659708206393 0.9881775843344577 1.007789197848276 1.0274008113620945 1.047012424875913 1.0666240383897314 1.0862356519035496 1.105847265417368 1.1254588789311866 0.054527166306904996 0.07413877982072341 0.09375039333454181 0.11336200684836023 0.13297362036217864 0.15258523387599704 0.17219684738981544 0.19180846090363385 0.21142007441745225 0.23103168793127066 0.1439698854068966 0.163581498920715 0.1831931124345334 0.2028047259483518 0.2224163394621702 0.24202795297598861 0.261639566489807 0.2812511800036255 0.3008627935174438 0.3204744070312623 0.23341260450688817 0.25302421802070657 0.272635831534525 0.2922474450483434 0.3118590585621618 0.3314706720759802 0.3510822855897986 0.37069389910361705 0.3903055126174354 0.40991712613125386 0.3228553236068798 0.3424669371206982 0.3620785506345166 0.381690164148335 0.4013017776621534 0.4209133911759718 0.4405250046897903 0.4601366182036086 0.4797482317174271 0.49935984523124544 0.41229804270687137 0.4319096562206898 0.4515212697345082 0.4711328832483266 0.490744496762145 0.5103561102759634 0.5299677237897819 0.5495793373036002 0.5691909508174187 0.588802564331237 0.5017407618068629 0.5213523753206813 0.5409639888344997 0.5605756023483182 0.5801872158621365 0.599798829375955 0.6194104428897733 0.6390220564035918 0.6586336699174101 0.6782452834312286 0.5911834809068546 0.610795094420673 0.6304067079344914 0.6500183214483098 0.6696299349621282 0.6892415484759467 0.708853161989765 0.7284647755035835 0.7480763890174018 0.7676880025312203 0.6806262000068461 0.7002378135206646 0.719849427034483 0.7394610405483014 0.7590726540621198 0.7786842675759382 0.7982958810897566 0.817907494603575 0.8375191081173934 0.8571307216312118 0.7700689191068377 0.7896805326206562 0.8092921461344745 0.828903759648293 0.8485153731621113 0.8681269866759298 0.8877386001897482 0.9073502137035666 0.926961827217385 0.9465734407312034 0.8595116382068293 0.8791232517206478 0.8987348652344661 0.9183464787482846 0.9379580922621029 0.9575697057759214 0.9771813192897397 0.9967929328035582 1.0164045463173765 1.036016159831195 0.9489543573068209 0.9685659708206393 0.9881775843344577 1.007789197848276 1.0274008113620945 1.047012424875913 1.0666240383897314 1.0862356519035496 1.105847265417368 1.1254588789311866 0.054527166306904996 0.07413877982072341 0.09375039333454181 0.11336200684836023 0.13297362036217864 0.15258523387599704 0.17219684738981544 0.19180846090363385 0.21142007441745225 0.23103168793127066 0.1439698854068966 0.163581498920715 0.1831931124345334 0.2028047259483518 0.2224163394621702 0.24202795297598861 0.261639566489807 0.2812511800036255 0.3008627935174438 0.3204744070312623 0.23341260450688817 0.25302421802070657 0.272635831534525 0.2922474450483434 0.3118590585621618 0.3314706720759802 0.3510822855897986 0.37069389910361705 0.3903055126174354 0.40991712613125386 0.3228553236068798 0.3424669371206982 0.3620785506345166 0.381690164148335 0.4013017776621534 0.4209133911759718 0.4405250046897903 0.4601366182036086 0.4797482317174271 0.49935984523124544 0.41229804270687137 0.4319096562206898 0.4515212697345082 0.4711328832483266 0.490744496762145 0.5103561102759634 0.5299677237897819 0.5495793373036002 0.5691909508174187 0.588802564331237 0.5017407618068629 0.5213523753206813 0.5409639888344997 0.5605756023483182 0.5801872158621365 0.599798829375955 0.6194104428897733 0.6390220564035918 0.6586336699174101 0.6782452834312286 0.5911834809068546 0.610795094420673 0.6304067079344914 0.6500183214483098 0.6696299349621282 0.6892415484759467 0.708853161989765 0.7284647755035835 0.7480763890174018 0.7676880025312203 0.6806262000068461 0.7002378135206646 0.719849427034483 0.7394610405483014 0.7590726540621198 0.7786842675759382 0.7982958810897566 0.817907494603575 0.8375191081173934 0.8571307216312118 0.7700689191068377 0.7896805326206562 0.8092921461344745 0.828903759648293 0.8485153731621113 0.8681269866759298 0.8877386001897482 0.9073502137035666 0.926961827217385 0.9465734407312034 0.8595116382068293 0.8791232517206478 0.8987348652344661 0.9183464787482846 0.9379580922621029 0.9575697057759214 0.9771813192897397 0.9967929328035582 1.0164045463173765 1.036016159831195 0.9489543573068209 0.9685659708206393 0.9881775843344577 1.007789197848276 1.0274008113620945 1.047012424875913 1.0666240383897314 1.0862356519035496 1.105847265417368 1.1254588789311866 0.054527166306904996 0.07413877982072341 0.09375039333454181 0.11336200684836023 0.13297362036217864 0.15258523387599704 0.17219684738981544 0.19180846090363385 0.21142007441745225 0.23103168793127066 0.1439698854068966 0.163581498920715 0.1831931124345334 0.2028047259483518 0.2224163394621702 0.24202795297598861 0.261639566489807 0.2812511800036255 0.3008627935174438 0.3204744070312623 0.23341260450688817 0.25302421802070657 0.272635831534525 0.2922474450483434 0.3118590585621618 0.3314706720759802 0.3510822855897986 0.37069389910361705 0.3903055126174354 0.40991712613125386 0.3228553236068798 0.3424669371206982 0.3620785506345166 0.381690164148335 0.4013017776621534 0.4209133911759718 0.4405250046897903 0.4601366182036086 0.4797482317174271 0.49935984523124544 0.41229804270687137 0.4319096562206898 0.4515212697345082 0.4711328832483266 0.490744496762145 0.5103561102759634 0.5299677237897819 0.5495793373036002 0.5691909508174187 0.588802564331237 0.5017407618068629 0.5213523753206813 0.5409639888344997 0.5605756023483182 0.5801872158621365 0.599798829375955 0.6194104428897733 0.6390220564035918 0.6586336699174101 0.6782452834312286 0.5911834809068546 0.610795094420673 0.6304067079344914 0.6500183214483098 0.6696299349621282 0.6892415484759467 0.708853161989765 0.7284647755035835 0.7480763890174018 0.7676880025312203 0.6806262000068461 0.7002378135206646 0.719849427034483 0.7394610405483014 0.7590726540621198 0.7786842675759382 0.7982958810897566 0.817907494603575 0.8375191081173934 0.8571307216312118 0.7700689191068377 0.7896805326206562 0.8092921461344745 0.828903759648293 0.8485153731621113 0.8681269866759298 0.8877386001897482 0.9073502137035666 0.926961827217385 0.9465734407312034 0.8595116382068293 0.8791232517206478 0.8987348652344661 0.9183464787482846 0.9379580922621029 0.9575697057759214 0.9771813192897397 0.9967929328035582 1.0164045463173765 1.036016159831195 0.9489543573068209 0.9685659708206393 0.9881775843344577 1.007789197848276 1.0274008113620945 1.047012424875913 1.0666240383897314 1.0862356519035496 1.105847265417368 1.1254588789311866;
                           0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.15000000000000002 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003 0.35000000000000003]

        shape = extrude_geometry((p1, p2, p3); direction, particle_spacing=0.1, n_extrude=4,
                                 density=1000.0)

        @test shape.coordinates ≈ expected_coords
    end
end
