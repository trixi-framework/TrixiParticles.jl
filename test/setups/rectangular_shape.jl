# 2D
@testset "Rectangular Shape 2D" begin

    # Rectangular shape
    particle_spacing = 0.01
    n_particles_per_dimension = (4, 3)

    positions = [(0.0, 0.0), (3.0, 4.0), (-3.0, -4.0), (-3.0, 4.0), (3.0, -4.0)]

    expected_coords = [
        [0.005 0.005 0.005 0.015 0.015 0.015 0.025 0.025 0.025 0.035 0.035 0.035;
         0.005 0.015 0.025 0.005 0.015 0.025 0.005 0.015 0.025 0.005 0.015 0.025],
        [3.005 3.005 3.005 3.015 3.015 3.015 3.025 3.025 3.025 3.035 3.035 3.035;
         4.005 4.015 4.025 4.005 4.015 4.025 4.005 4.015 4.025 4.005 4.015 4.025],
        [-2.995 -2.995 -2.995 -2.985 -2.985 -2.985 -2.975 -2.975 -2.975 -2.965 -2.965 -2.965;
         -3.995 -3.985 -3.975 -3.995 -3.985 -3.975 -3.995 -3.985 -3.975 -3.995 -3.985 -3.975],
        [-2.995 -2.995 -2.995 -2.985 -2.985 -2.985 -2.975 -2.975 -2.975 -2.965 -2.965 -2.965;
         4.005 4.015 4.025 4.005 4.015 4.025 4.005 4.015 4.025 4.005 4.015 4.025],
        [3.005 3.005 3.005 3.015 3.015 3.015 3.025 3.025 3.025 3.035 3.035 3.035;
         -3.995 -3.985 -3.975 -3.995 -3.985 -3.975 -3.995 -3.985 -3.975 -3.995 -3.985 -3.975],
    ]

    @testset "Position $i" for i in eachindex(positions)
        shape = RectangularShape(particle_spacing,
                                 n_particles_per_dimension, positions[i], 1.0)

        @test shape.coordinates == expected_coords[i]
    end
end

# 3D
@testset "Rectangular Shape 3D" begin

    # Rectangular shape
    particle_spacing = 0.01
    n_particles_per_dimension = (4, 3, 5)

    positions = [(0.0, 0.0, 0.0), (3.0, 4.0, 2.0), (-3.0, -4.0, -2.0)]

    expected_coords = [
        [0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.025 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035 0.035;
         0.005 0.005 0.005 0.005 0.005 0.015 0.015 0.015 0.015 0.015 0.025 0.025 0.025 0.025 0.025 0.005 0.005 0.005 0.005 0.005 0.015 0.015 0.015 0.015 0.015 0.025 0.025 0.025 0.025 0.025 0.005 0.005 0.005 0.005 0.005 0.015 0.015 0.015 0.015 0.015 0.025 0.025 0.025 0.025 0.025 0.005 0.005 0.005 0.005 0.005 0.015 0.015 0.015 0.015 0.015 0.025 0.025 0.025 0.025 0.025;
         0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045 0.005 0.015 0.025 0.035 0.045],
        [3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.005 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.015 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.025 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035 3.035;
         4.005 4.005 4.005 4.005 4.005 4.015 4.015 4.015 4.015 4.015 4.025 4.025 4.025 4.025 4.025 4.005 4.005 4.005 4.005 4.005 4.015 4.015 4.015 4.015 4.015 4.025 4.025 4.025 4.025 4.025 4.005 4.005 4.005 4.005 4.005 4.015 4.015 4.015 4.015 4.015 4.025 4.025 4.025 4.025 4.025 4.005 4.005 4.005 4.005 4.005 4.015 4.015 4.015 4.015 4.015 4.025 4.025 4.025 4.025 4.025;
         2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045 2.005 2.015 2.025 2.035 2.045],
        [-2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.995 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.985 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.975 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965 -2.965;
         -3.995 -3.995 -3.995 -3.995 -3.995 -3.985 -3.985 -3.985 -3.985 -3.985 -3.975 -3.975 -3.975 -3.975 -3.975 -3.995 -3.995 -3.995 -3.995 -3.995 -3.985 -3.985 -3.985 -3.985 -3.985 -3.975 -3.975 -3.975 -3.975 -3.975 -3.995 -3.995 -3.995 -3.995 -3.995 -3.985 -3.985 -3.985 -3.985 -3.985 -3.975 -3.975 -3.975 -3.975 -3.975 -3.995 -3.995 -3.995 -3.995 -3.995 -3.985 -3.985 -3.985 -3.985 -3.985 -3.975 -3.975 -3.975 -3.975 -3.975;
         -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955 -1.995 -1.985 -1.975 -1.965 -1.955],
    ]

    @testset "Position $i" for i in eachindex(positions)
        shape = RectangularShape(particle_spacing,
                                 n_particles_per_dimension, positions[i], 1.0)

        @test shape.coordinates == expected_coords[i]
    end
end
