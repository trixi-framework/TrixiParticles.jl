@testset verbose=true "SphereShape" begin
    positions = [(0.0, 0.0), (3.0, 4.0), (-3.0, -4.0), (3.0, -4), (-3.0, 4.0)]

    radius = 2.0
    particle_spacing = 0.8

    shape_names = [
        "Filled VortexSphere 2D",
        "Filled VortexSphere 2D with Cutout",
        "Hollow RoundSphere with One Layer",
        "Hollow RoundSphere with Multiple Layers",
        "Hollow RoundSphere Outwards",
    ]

    shapes = [
        SphereShape(particle_spacing, radius, (0.0, 0.0), 1000.0),
        SphereShape(particle_spacing, radius, (3.0, 4.0), 1000.0,
                    cutout_min=(3.0, 4.0), cutout_max=(5.0, 4.0 + 0.5particle_spacing)),
        SphereShape(particle_spacing, radius, (-3.0, -4.0), 1000.0,
                    shape_type=RoundSphere(), n_layers=1),
        SphereShape(particle_spacing, radius, (3.0, -4), 1000.0, shape_type=RoundSphere(),
                    n_layers=3),
        SphereShape(particle_spacing, radius, (-3.0, 4.0), 1000.0, shape_type=RoundSphere(),
                    n_layers=2, layer_inwards=false),
    ]

    # Expected coordinates for the shape types above for the position [0, 0].
    expected_coords = [
        [-0.8 0.0 0.8 -1.6 -0.8 0.0 0.8 1.6 -1.6 -0.8 0.0 0.8 1.6 -1.6 -0.8 0.0 0.8 1.6 -0.8 0.0 0.8
         -1.6 -1.6 -1.6 -0.8 -0.8 -0.8 -0.8 -0.8 0.0 0.0 0.0 0.0 0.0 0.8 0.8 0.8 0.8 0.8 1.6 1.6 1.6],
        [-0.8 0.0 0.8 -1.6 -0.8 0.0 0.8 1.6 -1.6 -0.8 -1.6 -0.8 0.0 0.8 1.6 -0.8 0.0 0.8
         -1.6 -1.6 -1.6 -0.8 -0.8 -0.8 -0.8 -0.8 0.0 0.0 0.8 0.8 0.8 0.8 0.8 1.6 1.6 1.6],
        [2.0 1.84776 1.41421 0.765367 5.66554e-16 -0.765367 -1.41421 -1.84776 -2.0 -1.84776 -1.41421 -0.765367 -3.67394e-16 0.765367 1.41421 1.84776
         0.0 0.765367 1.41421 1.84776 2.0 1.84776 1.41421 0.765367 1.13311e-15 -0.765367 -1.41421 -1.84776 -2.0 -1.84776 -1.41421 -0.765367],
        [2.0 1.847759065022574 1.4142135623730958 0.7653668647301797 4.440892098500626e-16 -0.7653668647301792 -1.414213562373095 -1.8477590650225735 -2.0 -1.847759065022574 -1.4142135623730958 -0.7653668647301806 -4.440892098500626e-16 0.7653668647301783 1.414213562373095 1.847759065022573 1.2000000000000002 0.9192533317427736 0.20837781320031645 -0.5999999999999996 -1.12763114494309 -1.12763114494309 -0.6000000000000005 0.208377813200316 0.9192533317427731 0.3999999999999999 -0.19999999999999973 -0.20000000000000018;
         0.0 0.7653668647301792 1.414213562373095 1.8477590650225735 2.0 1.847759065022574 1.414213562373095 0.7653668647301797 1.3322676295501878e-15 -0.7653668647301783 -1.414213562373094 -1.847759065022573 -2.0 -1.847759065022574 -1.4142135623730958 -0.765366864730181 0.0 0.7713451316238471 1.1817693036146495 1.0392304845413265 0.41042417199080283 -0.41042417199080283 -1.039230484541326 -1.18176930361465 -0.7713451316238471 0.0 0.34641016151377535 -0.34641016151377535],
        [2.0 1.8477590650225735 1.4142135623730954 0.7653668647301797 5.66553889764798e-16 -0.765366864730179 -1.414213562373095 -1.8477590650225735 -2.0 -1.847759065022574 -1.4142135623730958 -0.7653668647301807 -3.6739403974420594e-16 0.7653668647301783 1.4142135623730947 1.847759065022573 2.8 2.6865803261205925 2.355509891927307 1.8336100550467982 1.163162036405282 0.3984815471651989 -0.398481547165198 -1.1631620364052817 -1.8336100550467977 -2.3555098919273068 -2.686580326120592 -2.8 -2.686580326120593 -2.355509891927307 -1.8336100550467984 -1.1631620364052817 -0.3984815471651986 0.3984815471651976 1.1631620364052808 1.8336100550467989 2.355509891927306 2.6865803261205925;
         0.0 0.7653668647301795 1.414213562373095 1.8477590650225735 2.0 1.8477590650225737 1.4142135623730951 0.7653668647301798 1.133107779529596e-15 -0.7653668647301785 -1.4142135623730943 -1.847759065022573 -2.0 -1.847759065022574 -1.4142135623730954 -0.7653668647301808 0.0 0.788851159156003 1.513794288875673 2.116098808191923 2.546969586992651 2.771500037266611 2.7715000372666116 2.5469695869926516 2.116098808191923 1.5137942888756737 0.7888511591560041 -9.005486838189165e-16 -0.7888511591560022 -1.513794288875673 -2.1160988081919228 -2.5469695869926516 -2.771500037266611 -2.7715000372666116 -2.5469695869926516 -2.1160988081919228 -1.513794288875675 -0.7888511591560033],
    ]

    @testset "$(shape_names[i])" for i in eachindex(shape_names)
        @test isapprox(shapes[i].coordinates, expected_coords[i] .+ positions[i]; atol=1e-4)
    end
end
