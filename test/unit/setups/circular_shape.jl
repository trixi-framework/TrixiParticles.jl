@testset verbose=true "Circular Shape" begin
    positions = [(0.0, 0.0), (3.0, 4.0), (-3.0, -4.0), (-3.0, 4.0), (3.0, -4)]

    # Circular shape
    radius = 2.0
    particle_spacing = 0.8

    shape_names = [
        "FillCircle",
        "FillCircle with Recess",
        "DrawCircle with One Layer",
        "DrawCircle with Multiple Layers",
        "DrawCircle Inwards",
    ]

    function shape_type(position)
        [
            FillCircle(),
            FillCircle(x_recess=(position[1],
                                 position[1] + radius),
                       y_recess=(position[2],
                                 position[2] +
                                 particle_spacing / 2)),
            DrawCircle(),
            DrawCircle(n_layers=2),
            DrawCircle(n_layers=3, layer_inwards=true),
        ]
    end

    # Expected coordinates for the shape types above for the position [0, 0].
    expected_coords = [
        [-0.8 0.0 0.8 -1.6 -0.8 0.0 0.8 1.6 -1.6 -0.8 0.0 0.8 1.6 -1.6 -0.8 0.0 0.8 1.6 -0.8 0.0 0.8
         -1.6 -1.6 -1.6 -0.8 -0.8 -0.8 -0.8 -0.8 0.0 0.0 0.0 0.0 0.0 0.8 0.8 0.8 0.8 0.8 1.6 1.6 1.6],
        [-0.8 0.0 0.8 -1.6 -0.8 0.0 0.8 1.6 -1.6 -0.8 -1.6 -0.8 0.0 0.8 1.6 -0.8 0.0 0.8
         -1.6 -1.6 -1.6 -0.8 -0.8 -0.8 -0.8 -0.8 0.0 0.0 0.8 0.8 0.8 0.8 0.8 1.6 1.6 1.6],
        [2.0 1.84776 1.41421 0.765367 5.66554e-16 -0.765367 -1.41421 -1.84776 -2.0 -1.84776 -1.41421 -0.765367 -3.67394e-16 0.765367 1.41421 1.84776
         0.0 0.765367 1.41421 1.84776 2.0 1.84776 1.41421 0.765367 1.13311e-15 -0.765367 -1.41421 -1.84776 -2.0 -1.84776 -1.41421 -0.765367],
        [2.0 1.8477590650225735 1.4142135623730954 0.7653668647301797 5.66553889764798e-16 -0.765366864730179 -1.414213562373095 -1.8477590650225735 -2.0 -1.847759065022574 -1.4142135623730958 -0.7653668647301807 -3.6739403974420594e-16 0.7653668647301783 1.4142135623730947 1.847759065022573 2.8 2.6865803261205925 2.355509891927307 1.8336100550467982 1.163162036405282 0.3984815471651989 -0.398481547165198 -1.1631620364052817 -1.8336100550467977 -2.3555098919273068 -2.686580326120592 -2.8 -2.686580326120593 -2.355509891927307 -1.8336100550467984 -1.1631620364052817 -0.3984815471651986 0.3984815471651976 1.1631620364052808 1.8336100550467989 2.355509891927306 2.6865803261205925;
         0.0 0.7653668647301795 1.414213562373095 1.8477590650225735 2.0 1.8477590650225737 1.4142135623730951 0.7653668647301798 1.133107779529596e-15 -0.7653668647301785 -1.4142135623730943 -1.847759065022573 -2.0 -1.847759065022574 -1.4142135623730954 -0.7653668647301808 0.0 0.788851159156003 1.513794288875673 2.116098808191923 2.546969586992651 2.771500037266611 2.7715000372666116 2.5469695869926516 2.116098808191923 1.5137942888756737 0.7888511591560041 -9.005486838189165e-16 -0.7888511591560022 -1.513794288875673 -2.1160988081919228 -2.5469695869926516 -2.771500037266611 -2.7715000372666116 -2.5469695869926516 -2.1160988081919228 -1.513794288875675 -0.7888511591560033],
        [0.4 -0.2 -0.2 1.2 0.919253 0.208378 -0.6 -1.12763 -1.12763 -0.6 0.208378 0.919253 2.0 1.84776 1.41421 0.765367 5.66554e-16 -0.765367 -1.41421 -1.84776 -2.0 -1.84776 -1.41421 -0.765367 -3.67394e-16 0.765367 1.41421 1.84776
         0.0 0.34641 -0.34641 0.0 0.771345 1.18177 1.03923 0.410424 -0.410424 -1.03923 -1.18177 -0.771345 0.0 0.765367 1.41421 1.84776 2.0 1.84776 1.41421 0.765367 1.13311e-15 -0.765367 -1.41421 -1.84776 -2.0 -1.84776 -1.41421 -0.765367],
    ]

    @testset "$(shape_names[i])" for i in eachindex(shape_names)
        @testset "Position $position" for position in positions
            shape = CircularShape(particle_spacing, radius, position, 0.0,
                                  shape_type=shape_type(position)[i])
            @test isapprox(shape.coordinates, expected_coords[i] .+ position; atol=1e-4)
        end
    end
end
